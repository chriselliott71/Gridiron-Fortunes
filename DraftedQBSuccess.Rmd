---
title: "Quarter_Success_Prediction"
author: "Chris Elliott"
date: "9/28/2023"
output: pdf_document
---

```{r setup, include=FALSE}
options(repos = c(CRAN = "https://cran.rstudio.com"))
knitr::opts_chunk$set(warning = FALSE, message = FALSE) 


# Install the required packages, including 'httr'
install.packages('tidyverse')
install.packages("xml2")
install.packages("magrittr")
install.packages("httr",type='binary')  
install.packages("rvest")
install.packages("pscl")
install.packages("corrplot")
install.packages('MASS')
install.packages('caret')
install.packages('boot')
install.packages('margins')

# Load the packages
library(tidyverse)
library(margins)
library(rvest)
library(pscl)
library(corrplot)
library(MASS)
library(caret)
library(boot)

```

**Data Collection**

```{r}
#Draft Position and Most NFL Stats for QBs in 1997
url <- "https://www.pro-football-reference.com/years/1997/passing.htm"
page <- read_html(url)
table_selector <- "#div_passing"
table_node <- page %>%
  html_nodes(css = table_selector)
table_data <- table_node %>%
  html_table()
PFR1997 <- as.data.frame(table_data[[1]])

#Draft Position and Most NFL Stats for QBs in 1998
url <- "https://www.pro-football-reference.com/years/1998/passing.htm"
page <- read_html(url)
table_selector <- "#div_passing"
table_node <- page %>%
  html_nodes(css = table_selector)
table_data <- table_node %>%
  html_table()
PFR1998 <- as.data.frame(table_data[[1]])

#Draft Position and Most NFL Stats for QBs in 1999
url <- "https://www.pro-football-reference.com/years/1999/passing.htm"
page <- read_html(url)
table_selector <- "#div_passing"
table_node <- page %>%
  html_nodes(css = table_selector)
table_data <- table_node %>%
  html_table()
PFR1999 <- as.data.frame(table_data[[1]])

#Draft Position and Most NFL Stats for QBs in 2000
url <- "https://www.pro-football-reference.com/years/2000/passing.htm"
page <- read_html(url)
table_selector <- "#div_passing"
table_node <- page %>%
  html_nodes(css = table_selector)
table_data <- table_node %>%
  html_table()
PFR2000 <- as.data.frame(table_data[[1]])

#Draft Position and Most NFL Stats for QBs in 2001
url <- "https://www.pro-football-reference.com/years/2001/passing.htm"
page <- read_html(url)
table_selector <- "#div_passing"
table_node <- page %>%
  html_nodes(css = table_selector)
table_data <- table_node %>%
  html_table()
PFR2001 <- as.data.frame(table_data[[1]])

#Draft Position and Most NFL Stats for QBs in 2002
url <- "https://www.pro-football-reference.com/years/2002/passing.htm"
page <- read_html(url)
table_selector <- "#div_passing"
table_node <- page %>%
  html_nodes(css = table_selector)
table_data <- table_node %>%
  html_table()
PFR2002 <- as.data.frame(table_data[[1]])

#Draft Position and Most NFL Stats for QBs in 2003
url <- "https://www.pro-football-reference.com/years/2003/passing.htm"
page <- read_html(url)
table_selector <- "#div_passing"
table_node <- page %>%
  html_nodes(css = table_selector)
table_data <- table_node %>%
  html_table()
PFR2003 <- as.data.frame(table_data[[1]])

#Draft Position and Most NFL Stats for QBs in 2004
url <- "https://www.pro-football-reference.com/years/2004/passing.htm"
page <- read_html(url)
table_selector <- "#div_passing"
table_node <- page %>%
  html_nodes(css = table_selector)
table_data <- table_node %>%
  html_table()
PFR2004 <- as.data.frame(table_data[[1]])

#Draft Position and Most NFL Stats for QBs in 2005
url <- "https://www.pro-football-reference.com/years/2005/passing.htm"
page <- read_html(url)
table_selector <- "#div_passing"
table_node <- page %>%
  html_nodes(css = table_selector)
table_data <- table_node %>%
  html_table()
PFR2005 <- as.data.frame(table_data[[1]])

#Draft Position and Most NFL Stats for QBs in 2006
url <- "https://www.pro-football-reference.com/years/2006/passing.htm"
page <- read_html(url)
table_selector <- "#div_passing"
table_node <- page %>%
  html_nodes(css = table_selector)
table_data <- table_node %>%
  html_table()
PFR2006 <- as.data.frame(table_data[[1]])

#Draft Position and Most NFL Stats for QBs in 2007
url <- "https://www.pro-football-reference.com/years/2007/passing.htm"
page <- read_html(url)
table_selector <- "#div_passing"
table_node <- page %>%
  html_nodes(css = table_selector)
table_data <- table_node %>%
  html_table()
PFR2007 <- as.data.frame(table_data[[1]])

#Draft Position and Most NFL Stats for QBs in 2008
url <- "https://www.pro-football-reference.com/years/2008/passing.htm"
page <- read_html(url)
table_selector <- "#div_passing"
table_node <- page %>%
  html_nodes(css = table_selector)
table_data <- table_node %>%
  html_table()
PFR2008 <- as.data.frame(table_data[[1]])

#Draft Position and Most NFL Stats for QBs in 2009
url <- "https://www.pro-football-reference.com/years/2009/passing.htm"
page <- read_html(url)
table_selector <- "#div_passing"
table_node <- page %>%
  html_nodes(css = table_selector)
table_data <- table_node %>%
  html_table()
PFR2009 <- as.data.frame(table_data[[1]])

#Draft Position and Most NFL Stats for QBs in 2010
url <- "https://www.pro-football-reference.com/years/2010/passing.htm"
page <- read_html(url)
table_selector <- "#div_passing"
table_node <- page %>%
  html_nodes(css = table_selector)
table_data <- table_node %>%
  html_table()
PFR2010 <- as.data.frame(table_data[[1]])

#Draft Position and Most NFL Stats for QBs in 2011
url <- "https://www.pro-football-reference.com/years/2011/passing.htm"
page <- read_html(url)
table_selector <- "#div_passing"
table_node <- page %>%
  html_nodes(css = table_selector)
table_data <- table_node %>%
  html_table()
PFR2011 <- as.data.frame(table_data[[1]])

#Draft Position and Most NFL Stats for QBs in 2012
url <- "https://www.pro-football-reference.com/years/2012/passing.htm"
page <- read_html(url)
table_selector <- "#div_passing"
table_node <- page %>%
  html_nodes(css = table_selector)
table_data <- table_node %>%
  html_table()
PFR2012 <- as.data.frame(table_data[[1]])

#Draft Position and Most NFL Stats for QBs in 2013
url <- "https://www.pro-football-reference.com/years/2013/passing.htm"
page <- read_html(url)
table_selector <- "#div_passing"
table_node <- page %>%
  html_nodes(css = table_selector)
table_data <- table_node %>%
  html_table()
PFR2013 <- as.data.frame(table_data[[1]])

#Draft Position and Most NFL Stats for QBs in 2014
url <- "https://www.pro-football-reference.com/years/2014/passing.htm"
page <- read_html(url)
table_selector <- "#div_passing"
table_node <- page %>%
  html_nodes(css = table_selector)
table_data <- table_node %>%
  html_table()
PFR2014 <- as.data.frame(table_data[[1]])

#Draft Position and Most NFL Stats for QBs in 2015
url <- "https://www.pro-football-reference.com/years/2015/passing.htm"
page <- read_html(url)
table_selector <- "#div_passing"
table_node <- page %>%
  html_nodes(css = table_selector)
table_data <- table_node %>%
  html_table()
PFR2015 <- as.data.frame(table_data[[1]])

#Draft Position and Most NFL Stats for QBs in 2016
url <- "https://www.pro-football-reference.com/years/2016/passing.htm"
page <- read_html(url)
table_selector <- "#div_passing"
table_node <- page %>%
  html_nodes(css = table_selector)
table_data <- table_node %>%
  html_table()
PFR2016 <- as.data.frame(table_data[[1]])

#Draft Position and Most NFL Stats for QBs in 2017
url <- "https://www.pro-football-reference.com/years/2017/passing.htm"
page <- read_html(url)
table_selector <- "#div_passing"
table_node <- page %>%
  html_nodes(css = table_selector)
table_data <- table_node %>%
  html_table()
PFR2017 <- as.data.frame(table_data[[1]])

#Draft Position and Most NFL Stats for QBs in 2018
url <- "https://www.pro-football-reference.com/years/2018/passing.htm"
page <- read_html(url)
table_selector <- "#div_passing"
table_node <- page %>%
  html_nodes(css = table_selector)
table_data <- table_node %>%
  html_table()
PFR2018 <- as.data.frame(table_data[[1]])

#Draft Position and Most NFL Stats for QBs in 2019
url <- "https://www.pro-football-reference.com/years/2019/passing.htm"
page <- read_html(url)
table_selector <- "#div_passing"
table_node <- page %>%
  html_nodes(css = table_selector)
table_data <- table_node %>%
  html_table()
PFR2019 <- as.data.frame(table_data[[1]])

#Draft Position and Most NFL Stats for QBs in 2020
url <- "https://www.pro-football-reference.com/years/2020/passing.htm"
page <- read_html(url)
table_selector <- "#div_passing"
table_node <- page %>%
  html_nodes(css = table_selector)
table_data <- table_node %>%
  html_table()
PFR2020 <- as.data.frame(table_data[[1]])

#Draft Position and Most NFL Stats for QBs in 2021
url <- "https://www.pro-football-reference.com/years/2021/passing.htm"
page <- read_html(url)
table_selector <- "#div_passing"
table_node <- page %>%
  html_nodes(css = table_selector)
table_data <- table_node %>%
  html_table()
PFR2021 <- as.data.frame(table_data[[1]])

#Draft Position and Most NFL Stats for QBs in 2022
url <- "https://www.pro-football-reference.com/years/2022/passing.htm"
page <- read_html(url)
table_selector <- "#div_passing"
table_node <- page %>%
  html_nodes(css = table_selector)
table_data <- table_node %>%
  html_table()
PFR2022 <- as.data.frame(table_data[[1]])


#Joining the PFR Data Frames
#Before joining, PFR didn't include QBR until 2006, so we remove this variable 
#from all data frames
dataframes_list <- list(PFR2006,PFR2007,PFR2008,PFR2009,PFR2010,PFR2011,
                        PFR2012,PFR2013,PFR2014,PFR2015,PFR2016,PFR2017,
                        PFR2018,PFR2019,PFR2020,PFR2021,PFR2022)

column_to_remove <- "QBR"

remove_column <- function(df) {
  col_to_remove <- which(tolower(colnames(df)) == tolower(column_to_remove))
  if (length(col_to_remove) > 0) {
    df <- df[, -col_to_remove]
  }
  return(df)
}

# Remove the "QBR" column from all dataframes
dataframes_list <- lapply(dataframes_list, remove_column)


# Function to remove rows with "Rk" in the first column
remove_rows_with_Rk <- function(df) {
  df <- df[!(df[, 1] == "Rk"), ]
  return(df)
}

# Remove rows with "Rk" from all data frames
dataframes_list <- lapply(dataframes_list, remove_rows_with_Rk)



#Making the dataframes in the list accessible again
PFR2006<- dataframes_list[[1]]
PFR2007<- dataframes_list[[2]]
PFR2008<- dataframes_list[[3]]
PFR2009<- dataframes_list[[4]]
PFR2010<- dataframes_list[[5]]
PFR2011<- dataframes_list[[6]]
PFR2012<- dataframes_list[[7]]
PFR2013<- dataframes_list[[8]]
PFR2014<- dataframes_list[[9]]
PFR2015<- dataframes_list[[10]]
PFR2016<- dataframes_list[[11]]
PFR2017<- dataframes_list[[12]]
PFR2018<- dataframes_list[[13]]
PFR2019<- dataframes_list[[14]]
PFR2020<- dataframes_list[[15]]
PFR2021<- dataframes_list[[16]]
PFR2022<- dataframes_list[[17]]


dataframes_list <- list(PFR1997,PFR1998,PFR1999,PFR2000,PFR2001,PFR2002,
                        PFR2003,PFR2004,PFR2005,
                        PFR2006,PFR2007,PFR2008,PFR2009,PFR2010,PFR2011,
                        PFR2012,PFR2013,PFR2014,PFR2015,PFR2016,PFR2017,
                        PFR2018,PFR2019,PFR2020,PFR2021,PFR2022)



#Removing the yards lost to sacks as it's inconsistently labeled across years
dataframes_list <- lapply(dataframes_list, function(df) df[-26])



PFR1997<- dataframes_list[[1]]
PFR1998<- dataframes_list[[2]]
PFR1999<- dataframes_list[[3]]
PFR2000<- dataframes_list[[4]]
PFR2001<- dataframes_list[[5]]
PFR2002<- dataframes_list[[6]]
PFR2003<- dataframes_list[[7]]
PFR2004<- dataframes_list[[8]]
PFR2005<- dataframes_list[[9]]
PFR2006<- dataframes_list[[10]]
PFR2007<- dataframes_list[[11]]
PFR2008<- dataframes_list[[12]]
PFR2009<- dataframes_list[[13]]
PFR2010<- dataframes_list[[14]]
PFR2011<- dataframes_list[[15]]
PFR2012<- dataframes_list[[16]]
PFR2013<- dataframes_list[[17]]
PFR2014<- dataframes_list[[18]]
PFR2015<- dataframes_list[[19]]
PFR2016<- dataframes_list[[20]]
PFR2017<- dataframes_list[[21]]
PFR2018<- dataframes_list[[22]]
PFR2019<- dataframes_list[[23]]
PFR2020<- dataframes_list[[24]]
PFR2021<- dataframes_list[[25]]
PFR2022<- dataframes_list[[26]]


# Combine them into one dataframe
PFRstats <- do.call(rbind, dataframes_list)

# Remove rows where position does not equal 'QB'
PFRstats <- PFRstats %>%
  filter(Pos == 'QB')

X <- PFRstats
```
1928 qbs

```{r}
## Adding Draft Position to PFRstats from ProSportsTransactions  ##
#Gather 1997 Draft Info
url <- "https://www.prosportstransactions.com/football/DraftTrades/Years/1997.htm"
page <- read_html(url)
table_selector <- "body > div.container > table"
table_node <- page %>%
  html_nodes(css = table_selector)
table_data <- table_node %>%
  html_table()
Draft1997 <- as.data.frame(table_data[[1]])
# Convert the first row to character vector for column names
col_names <- as.character(unlist(Draft1997[1, ]))
# Remove the first row and second row
Draft1997 <- Draft1997[-c(1,2), ]
# Assign the character vector as column names
colnames(Draft1997) <- col_names
#Add a column "Year_Drafted" that contains solely the draft year
Draft1997$Year_Drafted <- 1997


#Gather 1998 Draft Info
url <- "https://www.prosportstransactions.com/football/DraftTrades/Years/1998.htm"
page <- read_html(url)
table_selector <- "body > div.container > table"
table_node <- page %>%
  html_nodes(css = table_selector)
table_data <- table_node %>%
  html_table()
Draft1998 <- as.data.frame(table_data[[1]])
# Convert the first row to character vector for column names
col_names <- as.character(unlist(Draft1998[1, ]))
# Remove the first row and second row
Draft1998 <- Draft1998[-c(1,2), ]
# Assign the character vector as column names
colnames(Draft1998) <- col_names
#Add a column "Year_Drafted" that contains solely the draft year
Draft1998$Year_Drafted <- 1998


#Gather 1999 Draft Info
url <- "https://www.prosportstransactions.com/football/DraftTrades/Years/1999.htm"
page <- read_html(url)
table_selector <- "body > div.container > table"
table_node <- page %>%
  html_nodes(css = table_selector)
table_data <- table_node %>%
  html_table()
Draft1999 <- as.data.frame(table_data[[1]])
# Convert the first row to character vector for column names
col_names <- as.character(unlist(Draft1999[1, ]))
# Remove the first row and second row
Draft1999 <- Draft1999[-c(1,2), ]
# Assign the character vector as column names
colnames(Draft1999) <- col_names
#Add a column "Year_Drafted" that contains solely the draft year
Draft1999$Year_Drafted <- 1999


#Gather 2000 Draft Info
url <- "https://www.prosportstransactions.com/football/DraftTrades/Years/2000.htm"
page <- read_html(url)
table_selector <- "body > div.container > table"
table_node <- page %>%
  html_nodes(css = table_selector)
table_data <- table_node %>%
  html_table()
Draft2000 <- as.data.frame(table_data[[1]])
# Convert the first row to character vector for column names
col_names <- as.character(unlist(Draft2000[1, ]))
# Remove the first row and second row
Draft2000 <- Draft2000[-c(1,2), ]
# Assign the character vector as column names
colnames(Draft2000) <- col_names
#Add a column "Year_Drafted" that contains solely the draft year
Draft2000$Year_Drafted <- 2000


#Gather 2001 Draft Info
url <- "https://www.prosportstransactions.com/football/DraftTrades/Years/2001.htm"
page <- read_html(url)
table_selector <- "body > div.container > table"
table_node <- page %>%
  html_nodes(css = table_selector)
table_data <- table_node %>%
  html_table()
Draft2001 <- as.data.frame(table_data[[1]])
# Convert the first row to character vector for column names
col_names <- as.character(unlist(Draft2001[1, ]))
# Remove the first row and second row
Draft2001 <- Draft2001[-c(1,2), ]
# Assign the character vector as column names
colnames(Draft2001) <- col_names
#Add a column "Year_Drafted" that contains solely the draft year
Draft2001$Year_Drafted <- 2001


#Gather 2002 Draft Info
url <- "https://www.prosportstransactions.com/football/DraftTrades/Years/2002.htm"
page <- read_html(url)
table_selector <- "body > div.container > table"
table_node <- page %>%
  html_nodes(css = table_selector)
table_data <- table_node %>%
  html_table()
Draft2002 <- as.data.frame(table_data[[1]])
# Convert the first row to character vector for column names
col_names <- as.character(unlist(Draft2002[1, ]))
# Remove the first row and second row
Draft2002 <- Draft2002[-c(1,2), ]
# Assign the character vector as column names
colnames(Draft2002) <- col_names
#Add a column "Year_Drafted" that contains solely the draft year
Draft2002$Year_Drafted <- 2002



#Gather 2003 Draft Info
url <- "https://www.prosportstransactions.com/football/DraftTrades/Years/2003.htm"
page <- read_html(url)
table_selector <- "body > div.container > table"
table_node <- page %>%
  html_nodes(css = table_selector)
table_data <- table_node %>%
  html_table()
Draft2003 <- as.data.frame(table_data[[1]])
# Convert the first row to character vector for column names
col_names <- as.character(unlist(Draft2003[1, ]))
# Remove the first row and second row
Draft2003 <- Draft2003[-c(1,2), ]
# Assign the character vector as column names
colnames(Draft2003) <- col_names
#Add a column "Year_Drafted" that contains solely the draft year
Draft2003$Year_Drafted <- 2003


#Gather 2004 Draft Info
url <- "https://www.prosportstransactions.com/football/DraftTrades/Years/2004.htm"
page <- read_html(url)
table_selector <- "body > div.container > table"
table_node <- page %>%
  html_nodes(css = table_selector)
table_data <- table_node %>%
  html_table()
Draft2004 <- as.data.frame(table_data[[1]])
# Convert the first row to character vector for column names
col_names <- as.character(unlist(Draft2004[1, ]))
# Remove the first row and second row
Draft2004 <- Draft2004[-c(1,2), ]
# Assign the character vector as column names
colnames(Draft2004) <- col_names
#Add a column "Year_Drafted" that contains solely the draft year
Draft2004$Year_Drafted <- 2004


#Gather 2005 Draft Info
url <- "https://www.prosportstransactions.com/football/DraftTrades/Years/2005.htm"
page <- read_html(url)
table_selector <- "body > div.container > table"
table_node <- page %>%
  html_nodes(css = table_selector)
table_data <- table_node %>%
  html_table()
Draft2005 <- as.data.frame(table_data[[1]])
# Convert the first row to character vector for column names
col_names <- as.character(unlist(Draft2005[1, ]))
# Remove the first row and second row
Draft2005 <- Draft2005[-c(1,2), ]
# Assign the character vector as column names
colnames(Draft2005) <- col_names
#Add a column "Year_Drafted" that contains solely the draft year
Draft2005$Year_Drafted <- 2005


#Gather 2006 Draft Info
url <- "https://www.prosportstransactions.com/football/DraftTrades/Years/2006.htm"
page <- read_html(url)
table_selector <- "body > div.container > table"
table_node <- page %>%
  html_nodes(css = table_selector)
table_data <- table_node %>%
  html_table()
Draft2006 <- as.data.frame(table_data[[1]])
# Convert the first row to character vector for column names
col_names <- as.character(unlist(Draft2006[1, ]))
# Remove the first row and second row
Draft2006 <- Draft2006[-c(1,2), ]
# Assign the character vector as column names
colnames(Draft2006) <- col_names
#Add a column "Year_Drafted" that contains solely the draft year
Draft2006$Year_Drafted <- 2006


#Gather 2007 Draft Info
url <- "https://www.prosportstransactions.com/football/DraftTrades/Years/2007.htm"
page <- read_html(url)
table_selector <- "body > div.container > table"
table_node <- page %>%
  html_nodes(css = table_selector)
table_data <- table_node %>%
  html_table()
Draft2007 <- as.data.frame(table_data[[1]])
# Convert the first row to character vector for column names
col_names <- as.character(unlist(Draft2007[1, ]))
# Remove the first row and second row
Draft2007 <- Draft2007[-c(1,2), ]
# Assign the character vector as column names
colnames(Draft2007) <- col_names
#Add a column "Year_Drafted" that contains solely the draft year
Draft2007$Year_Drafted <- 2007


#Gather 2008 Draft Info
url <- "https://www.prosportstransactions.com/football/DraftTrades/Years/2008.htm"
page <- read_html(url)
table_selector <- "body > div.container > table"
table_node <- page %>%
  html_nodes(css = table_selector)
table_data <- table_node %>%
  html_table()
Draft2008 <- as.data.frame(table_data[[1]])
# Convert the first row to character vector for column names
col_names <- as.character(unlist(Draft2008[1, ]))
# Remove the first row and second row
Draft2008 <- Draft2008[-c(1,2), ]
# Assign the character vector as column names
colnames(Draft2008) <- col_names
#Add a column "Year_Drafted" that contains solely the draft year
Draft2008$Year_Drafted <- 2008


#Gather 2009 Draft Info
url <- "https://www.prosportstransactions.com/football/DraftTrades/Years/2009.htm"
page <- read_html(url)
table_selector <- "body > div.container > table"
table_node <- page %>%
  html_nodes(css = table_selector)
table_data <- table_node %>%
  html_table()
Draft2009 <- as.data.frame(table_data[[1]])
# Convert the first row to character vector for column names
col_names <- as.character(unlist(Draft2009[1, ]))
# Remove the first row and second row
Draft2009 <- Draft2009[-c(1,2), ]
# Assign the character vector as column names
colnames(Draft2009) <- col_names
#Add a column "Year_Drafted" that contains solely the draft year
Draft2009$Year_Drafted <- 2009


#Gather 2010 Draft Info
url <- "https://www.prosportstransactions.com/football/DraftTrades/Years/2010.htm"
page <- read_html(url)
table_selector <- "body > div.container > table"
table_node <- page %>%
  html_nodes(css = table_selector)
table_data <- table_node %>%
  html_table()
Draft2010 <- as.data.frame(table_data[[1]])
# Convert the first row to character vector for column names
col_names <- as.character(unlist(Draft2010[1, ]))
# Remove the first row and second row
Draft2010 <- Draft2010[-c(1,2), ]
# Assign the character vector as column names
colnames(Draft2010) <- col_names
#Add a column "Year_Drafted" that contains solely the draft year
Draft2010$Year_Drafted <- 2010


#Gather 2011 Draft Info
url <- "https://www.prosportstransactions.com/football/DraftTrades/Years/2011.htm"
page <- read_html(url)
table_selector <- "body > div.container > table"
table_node <- page %>%
  html_nodes(css = table_selector)
table_data <- table_node %>%
  html_table()
Draft2011 <- as.data.frame(table_data[[1]])
# Convert the first row to character vector for column names
col_names <- as.character(unlist(Draft2011[1, ]))
# Remove the first row and second row
Draft2011 <- Draft2011[-c(1,2), ]
# Assign the character vector as column names
colnames(Draft2011) <- col_names
#Add a column "Year_Drafted" that contains solely the draft year
Draft2011$Year_Drafted <- 2011


#Gather 2012 Draft Info
url <- "https://www.prosportstransactions.com/football/DraftTrades/Years/2012.htm"
page <- read_html(url)
table_selector <- "body > div.container > table"
table_node <- page %>%
  html_nodes(css = table_selector)
table_data <- table_node %>%
  html_table()
Draft2012 <- as.data.frame(table_data[[1]])
# Convert the first row to character vector for column names
col_names <- as.character(unlist(Draft2012[1, ]))
# Remove the first row and second row
Draft2012 <- Draft2012[-c(1,2), ]
# Assign the character vector as column names
colnames(Draft2012) <- col_names
#Add a column "Year_Drafted" that contains solely the draft year
Draft2012$Year_Drafted <- 2012


#Gather 2013 Draft Info
url <- "https://www.prosportstransactions.com/football/DraftTrades/Years/2013.htm"
page <- read_html(url)
table_selector <- "body > div.container > table"
table_node <- page %>%
  html_nodes(css = table_selector)
table_data <- table_node %>%
  html_table()
Draft2013 <- as.data.frame(table_data[[1]])
# Convert the first row to character vector for column names
col_names <- as.character(unlist(Draft2013[1, ]))
# Remove the first row and second row
Draft2013 <- Draft2013[-c(1,2), ]
# Assign the character vector as column names
colnames(Draft2013) <- col_names
#Add a column "Year_Drafted" that contains solely the draft year
Draft2013$Year_Drafted <- 2013


#Gather 2014 Draft Info
url <- "https://www.prosportstransactions.com/football/DraftTrades/Years/2014.htm"
page <- read_html(url)
table_selector <- "body > div.container > table"
table_node <- page %>%
  html_nodes(css = table_selector)
table_data <- table_node %>%
  html_table()
Draft2014 <- as.data.frame(table_data[[1]])
# Convert the first row to character vector for column names
col_names <- as.character(unlist(Draft2014[1, ]))
# Remove the first row and second row
Draft2014 <- Draft2014[-c(1,2), ]
# Assign the character vector as column names
colnames(Draft2014) <- col_names
#Add a column "Year_Drafted" that contains solely the draft year
Draft2014$Year_Drafted <- 2014


#Gather 2015 Draft Info
url <- "https://www.prosportstransactions.com/football/DraftTrades/Years/2015.htm"
page <- read_html(url)
table_selector <- "body > div.container > table"
table_node <- page %>%
  html_nodes(css = table_selector)
table_data <- table_node %>%
  html_table()
Draft2015 <- as.data.frame(table_data[[1]])
# Convert the first row to character vector for column names
col_names <- as.character(unlist(Draft2015[1, ]))
# Remove the first row and second row
Draft2015 <- Draft2015[-c(1,2), ]
# Assign the character vector as column names
colnames(Draft2015) <- col_names
#Add a column "Year_Drafted" that contains solely the draft year
Draft2015$Year_Drafted <- 2015


#Gather 2016 Draft Info
url <- "https://www.prosportstransactions.com/football/DraftTrades/Years/2016.htm"
page <- read_html(url)
table_selector <- "body > div.container > table"
table_node <- page %>%
  html_nodes(css = table_selector)
table_data <- table_node %>%
  html_table()
Draft2016 <- as.data.frame(table_data[[1]])
# Convert the first row to character vector for column names
col_names <- as.character(unlist(Draft2016[1, ]))
# Remove the first row and second row
Draft2016 <- Draft2016[-c(1,2), ]
# Assign the character vector as column names
colnames(Draft2016) <- col_names
#Add a column "Year_Drafted" that contains solely the draft year
Draft2016$Year_Drafted <- 2016


#Gather 2017 Draft Info
url <- "https://www.prosportstransactions.com/football/DraftTrades/Years/2017.htm"
page <- read_html(url)
table_selector <- "body > div.container > table"
table_node <- page %>%
  html_nodes(css = table_selector)
table_data <- table_node %>%
  html_table()
Draft2017 <- as.data.frame(table_data[[1]])
# Convert the first row to character vector for column names
col_names <- as.character(unlist(Draft2017[1, ]))
# Remove the first row and second row
Draft2017 <- Draft2017[-c(1,2), ]
# Assign the character vector as column names
colnames(Draft2017) <- col_names
#Add a column "Year_Drafted" that contains solely the draft year
Draft2017$Year_Drafted <- 2017


#Gather 2018 Draft Info
url <- "https://www.prosportstransactions.com/football/DraftTrades/Years/2018.htm"
page <- read_html(url)
table_selector <- "body > div.container > table"
table_node <- page %>%
  html_nodes(css = table_selector)
table_data <- table_node %>%
  html_table()
Draft2018 <- as.data.frame(table_data[[1]])
# Convert the first row to character vector for column names
col_names <- as.character(unlist(Draft2018[1, ]))
# Remove the first row and second row
Draft2018 <- Draft2018[-c(1,2), ]
# Assign the character vector as column names
colnames(Draft2018) <- col_names
#Add a column "Year_Drafted" that contains solely the draft year
Draft2018$Year_Drafted <- 2018


#Gather 2019 Draft Info
url <- "https://www.prosportstransactions.com/football/DraftTrades/Years/2019.htm"
page <- read_html(url)
table_selector <- "body > div.container > table"
table_node <- page %>%
  html_nodes(css = table_selector)
table_data <- table_node %>%
  html_table()
Draft2019 <- as.data.frame(table_data[[1]])
# Convert the first row to character vector for column names
col_names <- as.character(unlist(Draft2019[1, ]))
# Remove the first row and second row
Draft2019 <- Draft2019[-c(1,2), ]
# Assign the character vector as column names
colnames(Draft2019) <- col_names
#Add a column "Year_Drafted" that contains solely the draft year
Draft2019$Year_Drafted <- 2019


#Gather 2020 Draft Info
url <- "https://www.prosportstransactions.com/football/DraftTrades/Years/2020.htm"
page <- read_html(url)
table_selector <- "body > div.container > table"
table_node <- page %>%
  html_nodes(css = table_selector)
table_data <- table_node %>%
  html_table()
Draft2020 <- as.data.frame(table_data[[1]])
# Convert the first row to character vector for column names
col_names <- as.character(unlist(Draft2020[1, ]))
# Remove the first row and second row
Draft2020 <- Draft2020[-c(1,2), ]
# Assign the character vector as column names
colnames(Draft2020) <- col_names
#Add a column "Year_Drafted" that contains solely the draft year
Draft2020$Year_Drafted <- 2020


#Gather 2021 Draft Info
url <- "https://www.prosportstransactions.com/football/DraftTrades/Years/2021.htm"
page <- read_html(url)
table_selector <- "body > div.container > table"
table_node <- page %>%
  html_nodes(css = table_selector)
table_data <- table_node %>%
  html_table()
Draft2021 <- as.data.frame(table_data[[1]])
# Convert the first row to character vector for column names
col_names <- as.character(unlist(Draft2021[1, ]))
# Remove the first row and second row
Draft2021 <- Draft2021[-c(1,2), ]
# Assign the character vector as column names
colnames(Draft2021) <- col_names
#Add a column "Year_Drafted" that contains solely the draft year
Draft2021$Year_Drafted <- 2021


#Gather 2022 Draft Info
url <- "https://www.prosportstransactions.com/football/DraftTrades/Years/2022.htm"
page <- read_html(url)
table_selector <- "body > div.container > table"
table_node <- page %>%
  html_nodes(css = table_selector)
table_data <- table_node %>%
  html_table()
Draft2022 <- as.data.frame(table_data[[1]])
# Convert the first row to character vector for column names
col_names <- as.character(unlist(Draft2022[1, ]))
# Remove the first row and second row
Draft2022 <- Draft2022[-c(1,2), ]
# Assign the character vector as column names
colnames(Draft2022) <- col_names
#Add a column "Year_Drafted" that contains solely the draft year
Draft2022$Year_Drafted <- 2022


#Rename 'Player Drafted' to 'Player' (as in PFR)
colnames(Draft1997)[ncol(Draft1997)-1] <- "Player"
colnames(Draft1998)[ncol(Draft1998)-1] <- "Player"
colnames(Draft1999)[ncol(Draft1999)-1] <- "Player"
colnames(Draft2000)[ncol(Draft2000)-1] <- "Player"
colnames(Draft2001)[ncol(Draft2001)-1] <- "Player"
colnames(Draft2002)[ncol(Draft2002)-1] <- "Player"
colnames(Draft2003)[ncol(Draft2003)-1] <- "Player"
colnames(Draft2004)[ncol(Draft2004)-1] <- "Player"
colnames(Draft2005)[ncol(Draft2005)-1] <- "Player"
colnames(Draft2006)[ncol(Draft2006)-1] <- "Player"
colnames(Draft2007)[ncol(Draft2007)-1] <- "Player"
colnames(Draft2008)[ncol(Draft2008)-1] <- "Player"
colnames(Draft2009)[ncol(Draft2009)-1] <- "Player"
colnames(Draft2010)[ncol(Draft2010)-1] <- "Player"
colnames(Draft2011)[ncol(Draft2011)-1] <- "Player"
colnames(Draft2012)[ncol(Draft2012)-1] <- "Player"
colnames(Draft2013)[ncol(Draft2013)-1] <- "Player"
colnames(Draft2014)[ncol(Draft2014)-1] <- "Player"
colnames(Draft2015)[ncol(Draft2015)-1] <- "Player"
colnames(Draft2016)[ncol(Draft2016)-1] <- "Player"
colnames(Draft2017)[ncol(Draft2017)-1] <- "Player"
colnames(Draft2018)[ncol(Draft2018)-1] <- "Player"
colnames(Draft2019)[ncol(Draft2019)-1] <- "Player"
colnames(Draft2020)[ncol(Draft2020)-1] <- "Player"
colnames(Draft2021)[ncol(Draft2021)-1] <- "Player"
colnames(Draft2022)[ncol(Draft2022)-1] <- "Player"



# List of data sets
draftSets <- list(Draft1997, Draft1998, Draft1999, Draft2000,
                  Draft2001, Draft2002, Draft2003, Draft2004,
                  Draft2005, Draft2006, Draft2007, Draft2008,
                  Draft2009, Draft2010, Draft2011, Draft2012, 
                  Draft2013, Draft2014, Draft2015, Draft2016,
                  Draft2017, Draft2018, Draft2019, Draft2020, 
                  Draft2021, Draft2022)

# Define the extract_columns function
extract_columns <- function(df) {
  # Select the first, second-to-last, and last column using column indexing
  df <- df[, c(1, (ncol(df) - 1), ncol(df))]
  return(df)
}


# Create a new list of data frames with only the first and last columns
newDraftSets <- lapply(draftSets, extract_columns)

# Assign each modified draft dataframe to separate assignments
Draft1997 <- newDraftSets[[1]]
Draft1998 <- newDraftSets[[2]]
Draft1999 <- newDraftSets[[3]]
Draft2000 <- newDraftSets[[4]]
Draft2001 <- newDraftSets[[5]]
Draft2002 <- newDraftSets[[6]]
Draft2003 <- newDraftSets[[7]]
Draft2004 <- newDraftSets[[8]]
Draft2005 <- newDraftSets[[9]]
Draft2006 <- newDraftSets[[10]]
Draft2007 <- newDraftSets[[11]]
Draft2008 <- newDraftSets[[12]]
Draft2009 <- newDraftSets[[13]]
Draft2010 <- newDraftSets[[14]]
Draft2011 <- newDraftSets[[15]]
Draft2012 <- newDraftSets[[16]]
Draft2013 <- newDraftSets[[17]]
Draft2014 <- newDraftSets[[18]]
Draft2015 <- newDraftSets[[19]]
Draft2016 <- newDraftSets[[20]]
Draft2017 <- newDraftSets[[21]]
Draft2018 <- newDraftSets[[22]]
Draft2019 <- newDraftSets[[23]]
Draft2020 <- newDraftSets[[24]]
Draft2021 <- newDraftSets[[25]]
Draft2022 <- newDraftSets[[26]]

#Include these modified draftsets in new draftset list
draftSets <- list(Draft1997, Draft1998, Draft1999, Draft2000,
                  Draft2001, Draft2002, Draft2003, Draft2004,
                  Draft2005, Draft2006, Draft2007, Draft2008,
                  Draft2009, Draft2010, Draft2011, Draft2012, 
                  Draft2013, Draft2014, Draft2015, Draft2016,
                  Draft2017, Draft2018, Draft2019, Draft2020, 
                  Draft2021, Draft2022)


# Clean the "Name" column to remove symbols following the name
PFRstats$Player <- gsub("[[:punct:]]", "", PFRstats$Player)

#1928 qbs
suffix_counter <- 1


####TEMP##########
# Function to join a draft dataframe with PFRstats
join_draft_to_PFRstats <- function(draft_df, pfr_df) {
  # Check if the "Player" column exists in the draft dataframe
  if ("Player" %in% colnames(draft_df)) {
    # Ensure "Player" column is character in both dataframes
    pfr_df$Player <- as.character(pfr_df$Player)
    
    # Filter PFRstats to only include matching player names
    merged_df <- merge(pfr_df, draft_df, by = "Player", all.x = TRUE)
    
    return(merged_df)
  } else {
    # If the "Player" column is not found in the draft dataframe, return the original pfr_df
    return(pfr_df)
  }
}

# Initialize the merged dataframe with PFRstats
merged_df <- PFRstats

# Use lapply to iteratively join each draft dataframe
for (draft_df in draftSets) {
  merged_df <- join_draft_to_PFRstats(draft_df, merged_df)
}

PFRstats <- merged_df
# The result is stored in the merged_df

 
# Generate a unique new column name
new_column_name <- make.unique("Overall_Pick", sep = "_")
new_column_name2 <- make.unique("Year_Drafted", sep = "_")


# Rename the column with the unique new name
merged_df$Overall_Pick <- merged_df$Value
merged_df$Year_Drafted <- merged_df$Year_Drafted_Value


#Remove Indicators (HOF, Pro-Bowl, Etc.)
merged_df$Player <- sub("\\*\\s*", "", merged_df$Player)
merged_df$Player <- gsub("\\+.*$", "", merged_df$Player)

#Make Columns Numeric
cols_to_num <- c('G','GS','Cmp','Att','Cmp%','Yds','TD','TD%','Int','Int%','1D',
                 'Succ%','Lng','Y/A','AY/A','Y/C','Y/G','Rate','Sk','Sk%','NY/A','ANY/A',
                 '4QC','GWD')
merged_df[cols_to_num] <- lapply(merged_df[cols_to_num], as.numeric)

merged_df <- merged_df[, !duplicated(names(merged_df))]


# Replace blank or NA "Record" values with "0-0-0"
merged_df$QBrec <- ifelse(is.na(merged_df$QBrec) | merged_df$QBrec == "", "0-0-0", merged_df$QBrec)

# Split the "Record" column into wins, losses, and ties
merged_df <- merged_df %>%
  separate(QBrec, into = c("Wins", "Losses", "Ties"), sep = "-")

# Convert the columns to numeric
merged_df$Wins <- as.numeric(merged_df$Wins)
merged_df$Losses <- as.numeric(merged_df$Losses)
merged_df$Ties <- as.numeric(merged_df$Ties)

# Calculate win percentage (excluding ties)
merged_df$WinPercentage <- merged_df$Wins / (merged_df$Wins + merged_df$Losses)


# Get the column names that start with "Year_Drafted"
year_drafted_cols <- grep("^Year_Drafted", names(merged_df), value = TRUE)

# Remove these columns from the dataframe
merged_df <- merged_df[, !names(merged_df) %in% year_drafted_cols]

# Get the column names that start with "Year_Drafted"
overall_cols <- grep("^Overall", names(merged_df), value = TRUE)

# Remove these columns from the dataframe
merged_df <- merged_df[, !names(merged_df) %in% overall_cols]

# Identify the columns to be removed
cols_to_remove <- c("4QC", "GWD", "Rk",'Tm', 'Age','Pos')

# Remove the specified columns
merged_df <- merged_df[, !(names(merged_df) %in% cols_to_remove)]


#Combine rows of the same player
merged_df <- merged_df %>%
  group_by(Player) %>%
  summarise(
    G = sum(G),
    GS = sum(GS),
    WinPct = mean(WinPercentage), 
    Cmp = sum(Cmp),
    Att = sum(Att),
    `Cmp_perc` = mean(`Cmp%`),
    Yds = sum(Yds),
    TD = sum(TD), 
    `TD_perc` = mean(`TD%`),
    Int = sum(Int),
    `Int_perc` = mean(`Int%`),
    `FirstD` = sum(`1D`),
    `Succ_perc` = mean(`Succ%`),
    Lng = max(Lng),
    `Y/A` = mean(`Y/A`),
    `AY/A` = mean(`AY/A`),
    `Y/C` = mean(`Y/C`),
    `Y/G` = mean(`Y/G`),
    Rate = mean(Rate),
    Sk = sum(Sk),
    `Sk%` = mean(`Sk%`),
    `NY/A` = mean(`NY/A`),
    `ANY/A` = mean(`ANY/A`)
  )

#Replace any NaN's with 0 (i.e. some occur because record wasn't recorded due to minor performance)
numeric_columns <- sapply(merged_df, is.numeric)

for (col in colnames(merged_df[numeric_columns])) {
  merged_df[[col]][is.nan(merged_df[[col]])] <- 0
}


PFRstats <- merged_df

#395 QBS, 24 Cols
```


*Data Collection Pt2*
```{r}
#Now using NFL.com fumbles, but they only do rushing fumbles. 

#Scrape each year's rushing data for fumbles, put together each year's tables that are on different pages, then put all the years together, then if name appears add to PFR? but then how do multiple seasons work? Only did page up to where it's all 0 fumbles. 

#Fumbles for All Players in 1997, separations and repeats in code is for various pages of data table.
scrape_nfl_table <- function(url) {
  page <- read_html(url)
  table_selector <- "#main-content > section.d3-l-grid--outer.d3-l-section-row > div > div > div > div > table"
  table_node <- page %>% html_nodes(css = table_selector)
  table_data <- table_node %>% html_table()
  return(as.data.frame(table_data[[1]]))
}

urls <- c(
  "https://www.nfl.com/stats/player-stats/category/rushing/1997/reg/all/rushingfumbles/desc",
  "https://www.nfl.com/stats/player-stats/category/rushing/1997/REG/all/rushingfumbles/DESC?aftercursor=AAAAGQAAAA5AEAAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5STBJaXdpTXpJd01EVXpOR1F0TkRrd05DMHhNVGM1TFRsak0yTXRZamRtTURkaFpEQmtOR0kzSWl3aU1UazVOeUpkZlE9PQ==",
  "https://www.nfl.com/stats/player-stats/category/rushing/1997/REG/all/rushingfumbles/DESC?aftercursor=AAAAMgAAAChAAAAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXlJaXdpTXpJd01EUTFOVEl0TkRreE1TMHlPREl5TFRsbE1qWXRZbVUyWmpNME56Y3hPV1JpSWl3aU1UazVOeUpkZlE9PQ==",
  "https://www.nfl.com/stats/player-stats/category/rushing/1997/REG/all/rushingfumbles/DESC?aftercursor=AAAASwAAAEc_8AAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXhJaXdpTXpJd01EUXhOVEl0TkRFeE9TMDFORE13TFdKbVpXUXRaR1U1T1RSbE5tWmpaVEEwSWl3aU1UazVOeUpkZlE9PQ==",
  "https://www.nfl.com/stats/player-stats/category/rushing/1997/REG/all/rushingfumbles/DESC?aftercursor=AAAAZAAAAEc_8AAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXhJaXdpTXpJd01EUTROREV0TlRJMk1DMDRPRGMwTFdOaU5EWXROV1V3TkRVNE9UbGtaV0V4SWl3aU1UazVOeUpkZlE9PQ==",
  "https://www.nfl.com/stats/player-stats/category/rushing/1997/REG/all/rushingfumbles/DESC?aftercursor=AAAAfQAAAEc_8AAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXhJaXdpTXpJd01EVXpOR1F0TkRreU5TMDVPRFF3TFRRd1l6Z3RNRFU1TURVeE5tUmpPV1JsSWl3aU1UazVOeUpkZlE9PQ=="
  
)

all_tables <- list()
for (url in urls) {
  table_data <- scrape_nfl_table(url)
  all_tables[[url]] <- table_data
}

Fumbles1997 <- do.call(rbind, all_tables)


#1998 Fumbles

urls <- c(
 "https://www.nfl.com/stats/player-stats/category/rushing/1998/REG/all/rushingfumbles/DESC",
 "https://www.nfl.com/stats/player-stats/category/rushing/1998/REG/all/rushingfumbles/DESC?aftercursor=AAAAGQAAABNACAAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXpJaXdpTXpJd01EUTNOREV0TlRJME5DMDJOakl6TFRreVpESXRZVGczTXpWa04yTXhZMlk0SWl3aU1UazVPQ0pkZlE9PQ==",
 "https://www.nfl.com/stats/player-stats/category/rushing/1998/REG/all/rushingfumbles/DESC?aftercursor=AAAAMgAAACVAAAAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXlJaXdpTXpJd01EVXpOR1F0TkRreU5TMDVPRFF3TFRRd1l6Z3RNRFU1TURVeE5tUmpPV1JsSWl3aU1UazVPQ0pkZlE9PQ==", 
 "https://www.nfl.com/stats/player-stats/category/rushing/1998/REG/all/rushingfumbles/DESC?aftercursor=AAAASwAAADo_8AAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXhJaXdpTXpJd01EUTBORFV0TkRJeU1DMDNOalExTFdaak9Ea3Raak0zTVdVME5tRXlaV0l3SWl3aU1UazVPQ0pkZlE9PQ==",
 "https://www.nfl.com/stats/player-stats/category/rushing/1998/REG/all/rushingfumbles/DESC?aftercursor=AAAAZAAAADo_8AAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXhJaXdpTXpJd01EUmtORFV0TkRFM055MDROamt5TFdKa056Y3RNV0k0TmpBeU0ySTFOVEl3SWl3aU1UazVPQ0pkZlE9PQ=="
)

all_tables <- list()
for (url in urls) {
  table_data <- scrape_nfl_table(url)
  all_tables[[url]] <- table_data
}

Fumbles1998 <- do.call(rbind, all_tables)

#1999 Fumbles

urls <- c(
 "https://www.nfl.com/stats/player-stats/category/rushing/1999/REG/all/rushingfumbles/DESC",
 "https://www.nfl.com/stats/player-stats/category/rushing/1999/REG/all/rushingfumbles/DESC?aftercursor=AAAAGQAAABlACAAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXpJaXdpTXpJd01EUXhORGt0TkdJMU5TMHpOekl5TFRRMFpXTXRNVEkxTlRJMFlXUTBNRGM0SWl3aU1UazVPU0pkZlE9PQ==",
 "https://www.nfl.com/stats/player-stats/category/rushing/1999/REG/all/rushingfumbles/DESC?aftercursor=AAAAMgAAACtAAAAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXlJaXdpTXpJd01EUTJOR010TlRVMU5TMHpOekl5TFRRelpEVXRZelF6TnpjMU16QTJNemsxSWl3aU1UazVPU0pkZlE9PQ==",
 "https://www.nfl.com/stats/player-stats/category/rushing/1999/REG/all/rushingfumbles/DESC?aftercursor=AAAASwAAAEU_8AAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXhJaXdpTXpJd01EUXlOR010TkRVeE9TMDFNRGMwTFRVME1qY3ROVGs0WmpFelpqRm1ZbUUxSWl3aU1UazVPU0pkZlE9PQ==",
 "https://www.nfl.com/stats/player-stats/category/rushing/1999/REG/all/rushingfumbles/DESC?aftercursor=AAAAZAAAAEU_8AAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXhJaXdpTXpJd01EUTROR1l0TkdNM055MHhOalV4TFRKa016UXROVEE0Wm1NMk1EZzVObVkxSWl3aU1UazVPU0pkZlE9PQ==",
 "https://www.nfl.com/stats/player-stats/category/rushing/1999/REG/all/rushingfumbles/DESC?aftercursor=AAAAfQAAAEU_8AAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXhJaXdpTXpJd01EVXpOVFF0TkRVME5pMDNNVGd4TFdJMFpHUXRaVGs1TldFNE1HRXpORGd5SWl3aU1UazVPU0pkZlE9PQ=="
)

all_tables <- list()
for (url in urls) {
  table_data <- scrape_nfl_table(url)
  all_tables[[url]] <- table_data
}

Fumbles1999 <- do.call(rbind, all_tables)

#2000 Fumbles
urls <- c(
 "https://www.nfl.com/stats/player-stats/category/rushing/2000/REG/all/rushingfumbles/DESC",
 "https://www.nfl.com/stats/player-stats/category/rushing/2000/REG/all/rushingfumbles/DESC?aftercursor=AAAAGQAAABFAEAAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5STBJaXdpTXpJd01EVXdOR010TlRVeU5DMHpPVFExTFRoaE0yRXRNMlUxWkRVNU16RXdZMll6SWl3aU1qQXdNQ0pkZlE9PQ==",
 "https://www.nfl.com/stats/player-stats/category/rushing/2000/REG/all/rushingfumbles/DESC?aftercursor=AAAAMgAAACpAAAAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXlJaXdpTXpJd01EUTNOREV0TlRJeE1DMHhPRFl4TFRsalltWXRaR0l6WmpOa1pXRmpNRGRqSWl3aU1qQXdNQ0pkZlE9PQ==",
 "https://www.nfl.com/stats/player-stats/category/rushing/2000/REG/all/rushingfumbles/DESC?aftercursor=AAAASwAAAD4_8AAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXhJaXdpTXpJd01EUTBOVFV0TkdVM01DMDFORGsxTFdZelpUUXRObVJqTjJNMFpUTTJPR0V5SWl3aU1qQXdNQ0pkZlE9PQ==",
 "https://www.nfl.com/stats/player-stats/category/rushing/2000/REG/all/rushingfumbles/DESC?aftercursor=AAAAZAAAAD4_8AAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXhJaXdpTXpJd01EUmtORE10TkRNMk5DMDFOekV6TFRNMk5qa3RNMkprTUdFNE5tVTFZVEprSWl3aU1qQXdNQ0pkZlE9PQ=="
)

all_tables <- list()
for (url in urls) {
  table_data <- scrape_nfl_table(url)
  all_tables[[url]] <- table_data
}

Fumbles2000 <- do.call(rbind, all_tables)

#2001 Fumbles
urls <- c(
 "https://www.nfl.com/stats/player-stats/category/rushing/2001/REG/all/rushingfumbles/DESC",
 "https://www.nfl.com/stats/player-stats/category/rushing/2001/REG/all/rushingfumbles/DESC?aftercursor=AAAAGQAAABhAEAAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5STBJaXdpTXpJd01EUXpORGd0TkRFeU1pMHlPRE00TFRnNE5tTXRNekUyWWpVM1pqTmtNMk5sSWl3aU1qQXdNU0pkZlE9PQ==",
 "https://www.nfl.com/stats/player-stats/category/rushing/2001/REG/all/rushingfumbles/DESC?aftercursor=AAAAMgAAAC1AAAAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXlJaXdpTXpJd01EUTJOREV0TlRVeE15MDRNalkwTFRVMU9EVXRORGs1T1RabVpXVTVNRGxpSWl3aU1qQXdNU0pkZlE9PQ==",
 "https://www.nfl.com/stats/player-stats/category/rushing/2001/REG/all/rushingfumbles/DESC?aftercursor=AAAASwAAAEQ_8AAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXhJaXdpTXpJd01EUXlOREV0TlRRd015MDVNVFl4TFdReU1XVXRNVGxqWW1WbVl6RmpObUl3SWl3aU1qQXdNU0pkZlE9PQ==",
 "https://www.nfl.com/stats/player-stats/category/rushing/2001/REG/all/rushingfumbles/DESC?aftercursor=AAAAZAAAAEQ_8AAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXhJaXdpTXpJd01EUmhOR1l0TkRnek1pMHlPVGt3TFdWaVpUa3RaVFl6WkdZNE5ETTNObVExSWl3aU1qQXdNU0pkZlE9PQ==",
 "https://www.nfl.com/stats/player-stats/category/rushing/2001/REG/all/rushingfumbles/DESC?aftercursor=AAAAfQAAAEQ_8AAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXhJaXdpTXpJd01EVTNORGd0TkRreU15MHpOak15TFdOak5qQXRZVEF5WVdVd01tRTBNVEJtSWl3aU1qQXdNU0pkZlE9PQ=="
)

all_tables <- list()
for (url in urls) {
  table_data <- scrape_nfl_table(url)
  all_tables[[url]] <- table_data
}

Fumbles2001 <- do.call(rbind, all_tables)

#2002 Fumbles
urls <- c(
 "https://www.nfl.com/stats/player-stats/category/rushing/2002/REG/all/rushingfumbles/DESC",
 "https://www.nfl.com/stats/player-stats/category/rushing/2002/REG/all/rushingfumbles/DESC?aftercursor=AAAAGQAAABVACAAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXpJaXdpTXpJd01EUTNOVEl0TkRVd015MDFOemszTFRnM00yTXROMkkyTmprM05qUTNZV1E0SWl3aU1qQXdNaUpkZlE9PQ==",
 "https://www.nfl.com/stats/player-stats/category/rushing/2002/REG/all/rushingfumbles/DESC?aftercursor=AAAAMgAAACVAAAAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXlJaXdpTXpJd01EUmhOREV0TkdReE55MDNNVGc1TFdJMlpUY3RNRE0xT1ROaVpqUm1NakUwSWl3aU1qQXdNaUpkZlE9PQ==",
 "https://www.nfl.com/stats/player-stats/category/rushing/2002/REG/all/rushingfumbles/DESC?aftercursor=AAAASwAAADs_8AAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXhJaXdpTXpJd01EUTBORFV0TlRRek1DMHlOVEkwTFRrME1XSXRZMkZtWVdabVlqYzVPVEJoSWl3aU1qQXdNaUpkZlE9PQ==",
 "https://www.nfl.com/stats/player-stats/category/rushing/2002/REG/all/rushingfumbles/DESC?aftercursor=AAAAZAAAADs_8AAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXhJaXdpTXpJd01EUmpORFV0TlRZME1DMHpNamt3TFRVek5tVXRabVk1T0RnMU1UbGxPR1JqSWl3aU1qQXdNaUpkZlE9PQ=="
)

all_tables <- list()
for (url in urls) {
  table_data <- scrape_nfl_table(url)
  all_tables[[url]] <- table_data
}

Fumbles2002 <- do.call(rbind, all_tables)

#2003 Fumbles
urls <- c(
 "https://www.nfl.com/stats/player-stats/category/rushing/2003/REG/all/rushingfumbles/DESC",
 "https://www.nfl.com/stats/player-stats/category/rushing/2003/REG/all/rushingfumbles/DESC?aftercursor=AAAAGQAAABFAEAAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5STBJaXdpTXpJd01EUmtOREV0TkdVMU1TMDFNRGszTFRZell6Z3RaR1prT1dOaFl6QTVNV1k0SWl3aU1qQXdNeUpkZlE9PQ==",
 "https://www.nfl.com/stats/player-stats/category/rushing/2003/REG/all/rushingfumbles/DESC?aftercursor=AAAAMgAAACpAAAAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXlJaXdpTXpJd01EUTJOVEl0TkRVMk9DMHlNemsxTFRObE9HUXRaRGxpWVRFellUSTVPVE16SWl3aU1qQXdNeUpkZlE9PQ==",
 "https://www.nfl.com/stats/player-stats/category/rushing/2003/REG/all/rushingfumbles/DESC?aftercursor=AAAASwAAAEQ_8AAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXhJaXdpTXpJd01EUXpOREV0TkdRME55MDBOakkxTFRaa09HTXRPR1ZrT1dNMVlUaGpOalEwSWl3aU1qQXdNeUpkZlE9PQ==",
 "https://www.nfl.com/stats/player-stats/category/rushing/2003/REG/all/rushingfumbles/DESC?aftercursor=AAAAZAAAAEQ_8AAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXhJaXdpTXpJd01EUmlORGt0TlRReE5TMDFOek16TFRZMk1XTXRNakEyT0RBek16TTVabVJsSWl3aU1qQXdNeUpkZlE9PQ=="
)

all_tables <- list()
for (url in urls) {
  table_data <- scrape_nfl_table(url)
  all_tables[[url]] <- table_data
}

Fumbles2003 <- do.call(rbind, all_tables)

#2004 Fumbles
urls <- c(
 "https://www.nfl.com/stats/player-stats/category/rushing/2004/REG/all/rushingfumbles/DESC",
 "https://www.nfl.com/stats/player-stats/category/rushing/2004/REG/all/rushingfumbles/DESC?aftercursor=AAAAGQAAABdACAAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXpJaXdpTXpJd01EUTBORFV0TkdNek5pMDNNelkzTFdZM05XVXRNbVV4TlRVMVpURmhORFF3SWl3aU1qQXdOQ0pkZlE9PQ==",
 "https://www.nfl.com/stats/player-stats/category/rushing/2004/REG/all/rushingfumbles/DESC?aftercursor=AAAAMgAAACdAAAAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXlJaXdpTXpJd01EUmlORGt0TkdVMk15MHhPRGd5TFRaaU9XTXRPV1F5WTJFMU1HTmlPRGd5SWl3aU1qQXdOQ0pkZlE9PQ==",
 "https://www.nfl.com/stats/player-stats/category/rushing/2004/REG/all/rushingfumbles/DESC?aftercursor=AAAASwAAAEA_8AAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXhJaXdpTXpJd01EUXpOR1l0TkRJM05DMDBORGd4TFRrMFl6TXRNV1JtT1RFNE5ERXhNMk14SWl3aU1qQXdOQ0pkZlE9PQ==",
 "https://www.nfl.com/stats/player-stats/category/rushing/2004/REG/all/rushingfumbles/DESC?aftercursor=AAAAZAAAAEA_8AAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXhJaXdpTXpJd01EUmtORE10TkRNMk1DMHdOemMzTFRFNU16RXRPRFF5TnprM05UZGpZV0l6SWl3aU1qQXdOQ0pkZlE9PQ=="
)

all_tables <- list()
for (url in urls) {
  table_data <- scrape_nfl_table(url)
  all_tables[[url]] <- table_data
}

Fumbles2004 <- do.call(rbind, all_tables)

#2005 Fumbles
urls <- c(
 "https://www.nfl.com/stats/player-stats/category/rushing/2005/reg/all/rushingfumbles/desc",
 "https://www.nfl.com/stats/player-stats/category/rushing/2005/REG/all/rushingfumbles/DESC?aftercursor=AAAAGQAAABJACAAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXpJaXdpTXpJd01EUTJORGt0TlRRM09TMHlPVEUxTFdNNU9UZ3RaalV3TVRFNVl6Sm1aR1EwSWl3aU1qQXdOU0pkZlE9PQ==",
 "https://www.nfl.com/stats/player-stats/category/rushing/2005/REG/all/rushingfumbles/DESC?aftercursor=AAAAMgAAACNAAAAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXlJaXdpTXpJd01EUmhOR1l0TkdVM05TMDFOelUxTFRobU9UTXRZbVV3T0RnMU5XWmxPV0l3SWl3aU1qQXdOU0pkZlE9PQ==",
 "https://www.nfl.com/stats/player-stats/category/rushing/2005/REG/all/rushingfumbles/DESC?aftercursor=AAAASwAAAEA_8AAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXhJaXdpTXpJd01EUTBORGt0TkdNeU5TMDFOelkzTFROaE1XUXROVEZrWmpjNVpXRXlNV0UxSWl3aU1qQXdOU0pkZlE9PQ==",
 "https://www.nfl.com/stats/player-stats/category/rushing/2005/REG/all/rushingfumbles/DESC?aftercursor=AAAAZAAAAEA_8AAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXhJaXdpTXpJd01EUmtOREV0TlRVeE15MHdOalUwTFRjeE1HUXROalZtTURReE9USXlZbUV3SWl3aU1qQXdOU0pkZlE9PQ=="
)

all_tables <- list()
for (url in urls) {
  table_data <- scrape_nfl_table(url)
  all_tables[[url]] <- table_data
}

Fumbles2005 <- do.call(rbind, all_tables)

#2006 Fumbles
urls <- c(
  "https://www.nfl.com/stats/player-stats/category/rushing/2006/reg/all/rushingfumbles/desc",
  "https://www.nfl.com/stats/player-stats/category/rushing/2006/REG/all/rushingfumbles/DESC?aftercursor=AAAAGQAAAAxAEAAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5STBJaXdpTXpJd01EVTJORGt0TkRNek1TMHhORFkzTFRneE5HUXRaRFF4WlRjMlpqVXdOMlEwSWl3aU1qQXdOaUpkZlE9PQ==",
  "https://www.nfl.com/stats/player-stats/category/rushing/2006/REG/all/rushingfumbles/DESC?aftercursor=AAAAMgAAACZAAAAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXlJaXdpTXpJd01EUmhOREV0TkRNM01DMDFOamc0TFRVME5tWXRZakUxTnpCbU1Ea3daamt3SWl3aU1qQXdOaUpkZlE9PQ==",
  "https://www.nfl.com/stats/player-stats/category/rushing/2006/REG/all/rushingfumbles/DESC?aftercursor=AAAASwAAAEI_8AAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXhJaXdpTXpJd01EUXlOVEl0TkdZek5DMHhNelF6TFRJeE5qVXRaamd3WVdSbE0yUTNaR0UySWl3aU1qQXdOaUpkZlE9PQ==",
  "https://www.nfl.com/stats/player-stats/category/rushing/2006/REG/all/rushingfumbles/DESC?aftercursor=AAAAZAAAAEI_8AAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXhJaXdpTXpJd01EUTROR1l0TkdZM01DMDFOVFE1TFRoaFl6WXRObU13T1dFNU16ZzFNVEV4SWl3aU1qQXdOaUpkZlE9PQ==",
  "https://www.nfl.com/stats/player-stats/category/rushing/2006/REG/all/rushingfumbles/DESC?aftercursor=AAAAfQAAAEI_8AAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXhJaXdpTXpJd01EVTBOVFV0TlRJd05pMHpNVGsyTFRFM016TXRaRGRqWm1SallXTTVZamxtSWl3aU1qQXdOaUpkZlE9PQ=="
)

all_tables <- list()
for (url in urls) {
  table_data <- scrape_nfl_table(url)
  all_tables[[url]] <- table_data
}

Fumbles2006 <- do.call(rbind, all_tables)

#Fumbles 2007
urls <- c(
 "https://www.nfl.com/stats/player-stats/category/rushing/2007/reg/all/rushingfumbles/desc",
 "https://www.nfl.com/stats/player-stats/category/rushing/2007/REG/all/rushingfumbles/DESC?aftercursor=AAAAGQAAABhACAAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXpJaXdpTXpJd01EUXpOVFV0TkdNMU9DMDJNRFUyTFdFME5UUXRZMkl4T1dJNU5XVTRaalUxSWl3aU1qQXdOeUpkZlE9PQ==",
 "https://www.nfl.com/stats/player-stats/category/rushing/2007/REG/all/rushingfumbles/DESC?aftercursor=AAAAMgAAACNAAAAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXlJaXdpTXpJd01EVXdORFV0TkdVek55MDFNRGsyTFdWaU5UQXRNamcyTWpjNE1tRXpaV1kxSWl3aU1qQXdOeUpkZlE9PQ==",
 "https://www.nfl.com/stats/player-stats/category/rushing/2007/REG/all/rushingfumbles/DESC?aftercursor=AAAASwAAADs_8AAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXhJaXdpTXpJd01EUXpOREV0TlRNMU5DMHhNVE16TFRFMFlUY3RNV1EyWmpJeVlUQTRNR0l6SWl3aU1qQXdOeUpkZlE9PQ==",
 "https://www.nfl.com/stats/player-stats/category/rushing/2007/REG/all/rushingfumbles/DESC?aftercursor=AAAAZAAAADs_8AAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXhJaXdpTXpJd01EUmtOR1l0TkdZMU5TMHhOelUzTFdaa05tUXRaak0yTVRoa05HSmlNREEySWl3aU1qQXdOeUpkZlE9PQ=="
)

all_tables <- list()
for (url in urls) {
  table_data <- scrape_nfl_table(url)
  all_tables[[url]] <- table_data
}

Fumbles2007 <- do.call(rbind, all_tables)

# Fumbles 2008

urls <- c(
 "https://www.nfl.com/stats/player-stats/category/rushing/2008/reg/all/rushingfumbles/desc",
 "https://www.nfl.com/stats/player-stats/category/rushing/2008/REG/all/rushingfumbles/DESC?aftercursor=AAAAGQAAABZACAAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXpJaXdpTXpJd01EUTJORGt0TlRRM09TMHlPVEUxTFdNNU9UZ3RaalV3TVRFNVl6Sm1aR1EwSWl3aU1qQXdPQ0pkZlE9PQ==",
 "https://www.nfl.com/stats/player-stats/category/rushing/2008/REG/all/rushingfumbles/DESC?aftercursor=AAAAMgAAACFAAAAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXlJaXdpTXpJd01EUm1OVE10TlRVek9TMDBOakkzTFRkalptVXRPRFUzTnpFNFpXWTFPRFpqSWl3aU1qQXdPQ0pkZlE9PQ==",
 "https://www.nfl.com/stats/player-stats/category/rushing/2008/REG/all/rushingfumbles/DESC?aftercursor=AAAASwAAADo_8AAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXhJaXdpTXpJd01EUTRORGt0TkRjM09DMDBNakE0TFRKbU9XUXROV1l4TkRKak5USmxOelV3SWl3aU1qQXdPQ0pkZlE9PQ==",
 "https://www.nfl.com/stats/player-stats/category/rushing/2008/REG/all/rushingfumbles/DESC?aftercursor=AAAAZAAAADo_8AAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXhJaXdpTXpJd01EVXpORGt0TkdRME9DMHlORGsyTFRnMU56Y3RNek16Tkdaak9UTTJaVFZqSWl3aU1qQXdPQ0pkZlE9PQ=="
)

all_tables <- list()
for (url in urls) {
  table_data <- scrape_nfl_table(url)
  all_tables[[url]] <- table_data
}

Fumbles2008 <- do.call(rbind, all_tables)

# Fumbles 2009

urls <- c(
 "https://www.nfl.com/stats/player-stats/category/rushing/2009/reg/all/rushingfumbles/desc",
 "https://www.nfl.com/stats/player-stats/category/rushing/2009/REG/all/rushingfumbles/DESC?aftercursor=AAAAGQAAABJACAAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXpJaXdpTXpJd01EUmtORE10TkdVd01TMDNOVEUzTFRoaE9ETXROVGMyWVRFeFpqZGpZbVkySWl3aU1qQXdPU0pkZlE9PQ==",
 "https://www.nfl.com/stats/player-stats/category/rushing/2009/REG/all/rushingfumbles/DESC?aftercursor=AAAAMgAAACFAAAAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXlJaXdpTXpJd01EUmhOR1l0TkRnek9TMDVORGcwTFRsbU9HSXRNV1EzTURFMk5tTTRNalJqSWl3aU1qQXdPU0pkZlE9PQ==",
 "https://www.nfl.com/stats/player-stats/category/rushing/2009/REG/all/rushingfumbles/DESC?aftercursor=AAAASwAAAEM_8AAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXhJaXdpTXpJd01EUXlOVEl0TkdZMk5pMHlOelExTFdNMk9XTXROV1UzT1RNM1pqUTJNVEE0SWl3aU1qQXdPU0pkZlE9PQ==",
 "https://www.nfl.com/stats/player-stats/category/rushing/2009/REG/all/rushingfumbles/DESC?aftercursor=AAAAZAAAAEM_8AAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXhJaXdpTXpJd01EUmlOR1l0TkdNeE1DMDFNRE0zTFdJNVpUVXRZelEzWW1VNE5XUTVZVE15SWl3aU1qQXdPU0pkZlE9PQ==",
 "https://www.nfl.com/stats/player-stats/category/rushing/2009/REG/all/rushingfumbles/DESC?aftercursor=AAAAfQAAAEM_8AAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXhJaXdpTXpJd01EVTNORGd0TkRrek55MHlNVEV6TFRkalpXRXRPVEk0TURGbU9ESTROV1ZsSWl3aU1qQXdPU0pkZlE9PQ=="
)

all_tables <- list()
for (url in urls) {
  table_data <- scrape_nfl_table(url)
  all_tables[[url]] <- table_data
}

Fumbles2009 <- do.call(rbind, all_tables)

# Fumbles 2010

urls <- c(
  "https://www.nfl.com/stats/player-stats/category/rushing/2010/reg/all/rushingfumbles/desc",
  "https://www.nfl.com/stats/player-stats/category/rushing/2010/REG/all/rushingfumbles/DESC?aftercursor=AAAAGQAAABRACAAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXpJaXdpTXpJd01EUmtORE10TkRZd09DMDBPVGMwTFRrMFltTXRNR016TlRjd04yWmpaVEUwSWl3aU1qQXhNQ0pkZlE9PQ==",
  "https://www.nfl.com/stats/player-stats/category/rushing/2010/REG/all/rushingfumbles/DESC?aftercursor=AAAAMgAAACFAAAAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXlJaXdpTXpJd01EUmtORE10TkRjd01DMHhPVGsxTFRrNVl6VXRPREJtTXpZeU5UTXpNV0V5SWl3aU1qQXhNQ0pkZlE9PQ==",
  "https://www.nfl.com/stats/player-stats/category/rushing/2010/REG/all/rushingfumbles/DESC?aftercursor=AAAASwAAADo_8AAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXhJaXdpTXpJd01EUTJORFV0TkdNMk5DMHlNRGszTFdSaU0yRXROR001TVRNelkyUTRPRGt3SWl3aU1qQXhNQ0pkZlE9PQ==",
  "https://www.nfl.com/stats/player-stats/category/rushing/2010/REG/all/rushingfumbles/DESC?aftercursor=AAAAZAAAADo_8AAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXhJaXdpTXpJd01EVXlORGd0TkdZME1DMDFOVE00TFdOalpqZ3RPVGhrTldWak5qUmpaamd5SWl3aU1qQXhNQ0pkZlE9PQ=="
)

all_tables <- list()
for (url in urls) {
  table_data <- scrape_nfl_table(url)
  all_tables[[url]] <- table_data
}

Fumbles2010 <- do.call(rbind, all_tables)

#Fumbles 2011

urls <- c(
  "https://www.nfl.com/stats/player-stats/category/rushing/2011/reg/all/rushingfumbles/desc",
  "https://www.nfl.com/stats/player-stats/category/rushing/2011/REG/all/rushingfumbles/DESC?aftercursor=AAAAGQAAAA9ACAAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXpJaXdpTXpJd01EUmpOVGt0TkdVME5DMHlPVGMyTFRWbU5XUXRZbVEyWlRneE5tUTFOalJtSWl3aU1qQXhNU0pkZlE9PQ==",
  "https://www.nfl.com/stats/player-stats/category/rushing/2011/REG/all/rushingfumbles/DESC?aftercursor=AAAAMgAAABxAAAAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXlJaXdpTXpJd01EVTNORGt0TkdNeU55MHhNVEUxTFRObVlqRXRaVFZqWmpCa05qVTVOemc0SWl3aU1qQXhNU0pkZlE9PQ==",
  "https://www.nfl.com/stats/player-stats/category/rushing/2011/REG/all/rushingfumbles/DESC?aftercursor=AAAASwAAADQ_8AAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXhJaXdpTXpJd01EUTRORFV0TkdVMU1DMDNOVGd3TFdVME9XTXRaakEzWVRrMFpqTmhaV00wSWl3aU1qQXhNU0pkZlE9PQ==",
  "https://www.nfl.com/stats/player-stats/category/rushing/2011/REG/all/rushingfumbles/DESC?aftercursor=AAAAZAAAADQ_8AAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXhJaXdpTXpJd01EVXdOR1l0TlRjeE5pMHlOemN5TFRWaVlqZ3RNRFJrWVRrellqWXlNR05tSWl3aU1qQXhNU0pkZlE9PQ=="
)

all_tables <- list()
for (url in urls) {
  table_data <- scrape_nfl_table(url)
  all_tables[[url]] <- table_data
}

Fumbles2011 <- do.call(rbind, all_tables)

#Fumbles 2012
urls <- c(
  "https://www.nfl.com/stats/player-stats/category/rushing/2012/reg/all/rushingfumbles/desc",
  "https://www.nfl.com/stats/player-stats/category/rushing/2012/REG/all/rushingfumbles/DESC?aftercursor=AAAAGQAAABBACAAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXpJaXdpTXpJd01EUmhORFV0TkdVMU9DMDNPVFkxTFdFME5qZ3RZalExWmpFelltWXpOVGcwSWl3aU1qQXhNaUpkZlE9PQ==",
  "https://www.nfl.com/stats/player-stats/category/rushing/2012/REG/all/rushingfumbles/DESC?aftercursor=AAAAMgAAACNAAAAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXlJaXdpTXpJd01EVXlORFV0TkRRMU1DMDFNVGN4TFRZMU56QXRaREZrTVdRM1pURXlPRGcwSWl3aU1qQXhNaUpkZlE9PQ==",
  "https://www.nfl.com/stats/player-stats/category/rushing/2012/REG/all/rushingfumbles/DESC?aftercursor=AAAASwAAADo_8AAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXhJaXdpTXpJd01EUTROREV0TlRNMU15MDJOems1TFdFek4ySXRaalJpWVdJeE5XVTBNekV5SWl3aU1qQXhNaUpkZlE9PQ==",
  "https://www.nfl.com/stats/player-stats/category/rushing/2012/REG/all/rushingfumbles/DESC?aftercursor=AAAAZAAAADo_8AAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXhJaXdpTXpJd01EVTBOREV0TlRReE15MDNPRGc1TFdaaE1qTXROemMzWm1ZME5UTTNaVGd5SWl3aU1qQXhNaUpkZlE9PQ=="
)

all_tables <- list()
for (url in urls) {
  table_data <- scrape_nfl_table(url)
  all_tables[[url]] <- table_data
}

Fumbles2012 <- do.call(rbind, all_tables)

#Fumbles 2013
urls <- c(
  "https://www.nfl.com/stats/player-stats/category/rushing/2013/reg/all/rushingfumbles/desc",
  "https://www.nfl.com/stats/player-stats/category/rushing/2013/REG/all/rushingfumbles/DESC?aftercursor=AAAAGQAAAA1ACAAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXpJaXdpTXpJd01EVXlORGt0TkRRMk5TMDROelU1TFRkaU5UUXRZV0UxWXpWa1ltVmtOREl4SWl3aU1qQXhNeUpkZlE9PQ==",
  "https://www.nfl.com/stats/player-stats/category/rushing/2013/REG/all/rushingfumbles/DESC?aftercursor=AAAAMgAAAB9AAAAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXlJaXdpTXpJd01EVXlORGt0TkRNMk15MDFORFV3TFRoaVl6TXRNbUl6Tm1NME5UZzJPVFZrSWl3aU1qQXhNeUpkZlE9PQ==",
  "https://www.nfl.com/stats/player-stats/category/rushing/2013/REG/all/rushingfumbles/DESC?aftercursor=AAAASwAAADg_8AAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXhJaXdpTXpJd01EUmhOREV0TkRNM01DMDFOamc0TFRVME5tWXRZakUxTnpCbU1Ea3daamt3SWl3aU1qQXhNeUpkZlE9PQ==",
  "https://www.nfl.com/stats/player-stats/category/rushing/2013/REG/all/rushingfumbles/DESC?aftercursor=AAAAZAAAADg_8AAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXhJaXdpTXpJd01EVXpOVFF0TkRFMU9DMHpOemcyTFRGa056Y3RabUV6Tm1Wa01UQTBPR00zSWl3aU1qQXhNeUpkZlE9PQ=="
)

all_tables <- list()
for (url in urls) {
  table_data <- scrape_nfl_table(url)
  all_tables[[url]] <- table_data
}

Fumbles2013 <- do.call(rbind, all_tables)

#Fumbles 2014
urls <- c(
  "https://www.nfl.com/stats/player-stats/category/rushing/2014/reg/all/rushingfumbles/desc",
  "https://www.nfl.com/stats/player-stats/category/rushing/2014/REG/all/rushingfumbles/DESC?aftercursor=AAAAGQAAAA5ACAAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXpJaXdpTXpJd01EVXlOR1l0TkRRek15MDVNamt6TFdFelkyWXRZV1EzTnpVNFpEQXpNREF6SWl3aU1qQXhOQ0pkZlE9PQ==",
  "https://www.nfl.com/stats/player-stats/category/rushing/2014/REG/all/rushingfumbles/DESC?aftercursor=AAAAMgAAABxAAAAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXlJaXdpTXpJd01EVXpOVFF0TkRFeE1DMHdNREkxTFRGalpHUXRaVEUxTWpCbFpETmxPV05qSWl3aU1qQXhOQ0pkZlE9PQ==",
  "https://www.nfl.com/stats/player-stats/category/rushing/2014/REG/all/rushingfumbles/DESC?aftercursor=AAAASwAAADY_8AAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXhJaXdpTXpJd01EUmhORFV0TkRZME9TMDRPRFl3TFdJNVlXUXRNRFl3T0dZMk5HTTNPVFZsSWl3aU1qQXhOQ0pkZlE9PQ==",
  "https://www.nfl.com/stats/player-stats/category/rushing/2014/REG/all/rushingfumbles/DESC?aftercursor=AAAAZAAAADY_8AAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXhJaXdpTXpJd01EVXpORGd0TkRFMU15MDFNRGczTFdOa016WXROV0psTWpRMk16VXhNbVV6SWl3aU1qQXhOQ0pkZlE9PQ=="
)

all_tables <- list()
for (url in urls) {
  table_data <- scrape_nfl_table(url)
  all_tables[[url]] <- table_data
}

Fumbles2014 <- do.call(rbind, all_tables)

#Fumbles 2015
urls <- c(
  "https://www.nfl.com/stats/player-stats/category/rushing/2015/reg/all/rushingfumbles/desc",
  "https://www.nfl.com/stats/player-stats/category/rushing/2015/REG/all/rushingfumbles/DESC?aftercursor=AAAAGQAAABBACAAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXpJaXdpTXpJd01EUmtOREV0TlRNeU5pMDVPRGsyTFRZd1l6SXRabU5rWkdWbU9EVTVZV0UwSWl3aU1qQXhOU0pkZlE9PQ==",
  "https://www.nfl.com/stats/player-stats/category/rushing/2015/REG/all/rushingfumbles/DESC?aftercursor=AAAAMgAAACJAAAAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXlJaXdpTXpJd01EUmtOREV0TlRJeE9DMDJNelEzTFRKaU1Ea3ROalF5TnpabVlUWXhaalk0SWl3aU1qQXhOU0pkZlE9PQ==",
  "https://www.nfl.com/stats/player-stats/category/rushing/2015/REG/all/rushingfumbles/DESC?aftercursor=AAAASwAAADo_8AAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXhJaXdpTXpJd01EUTROREV0TlRJek55MHdNRFU0TFRkall6VXROVE5rTUdRM1lUUTNOelk1SWl3aU1qQXhOU0pkZlE9PQ==",
  "https://www.nfl.com/stats/player-stats/category/rushing/2015/REG/all/rushingfumbles/DESC?aftercursor=AAAAZAAAADo_8AAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXhJaXdpTXpJd01EVXpORGt0TkdRMk5pMDVNRE0zTFRkaVlUTXROamd3TURJeE1ESTJORFJtSWl3aU1qQXhOU0pkZlE9PQ=="
)

all_tables <- list()
for (url in urls) {
  table_data <- scrape_nfl_table(url)
  all_tables[[url]] <- table_data
}

Fumbles2015 <- do.call(rbind, all_tables)

#Fumbles 2016
urls <- c(
  "https://www.nfl.com/stats/player-stats/category/rushing/2016/reg/all/rushingfumbles/desc",
  "https://www.nfl.com/stats/player-stats/category/rushing/2016/REG/all/rushingfumbles/DESC?aftercursor=AAAAGQAAAAxACAAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXpJaXdpTXpJd01EVTBOREV0TlRrM05pMDBPRFk0TFdJNE1XUXRaR1l6TVdaaVlqZG1aVGN5SWl3aU1qQXhOaUpkZlE9PQ==",
  "https://www.nfl.com/stats/player-stats/category/rushing/2016/REG/all/rushingfumbles/DESC?aftercursor=AAAAMgAAABtAAAAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXlJaXdpTXpJd01EVXlORGt0TlRZMk5TMHhOak0wTFdFeE9USXROemRqT1dNNFpUWXlOakpsSWl3aU1qQXhOaUpkZlE9PQ==",
  "https://www.nfl.com/stats/player-stats/category/rushing/2016/REG/all/rushingfumbles/DESC?aftercursor=AAAASwAAADo_8AAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXhJaXdpTXpJd01EUTJOREV0TlRJM09DMDVNakkzTFROalptTXRZbVU1WVRWa1lqWTJOVGhtSWl3aU1qQXhOaUpkZlE9PQ==",
  "https://www.nfl.com/stats/player-stats/category/rushing/2016/REG/all/rushingfumbles/DESC?aftercursor=AAAAZAAAADo_8AAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXhJaXdpTXpJd01EVXlOR1l0TkRJMk1DMHhOams0TFdSbU5HUXRZVGd5WldSbU1tTmxZelJsSWl3aU1qQXhOaUpkZlE9PQ=="
)

all_tables <- list()
for (url in urls) {
  table_data <- scrape_nfl_table(url)
  all_tables[[url]] <- table_data
}

Fumbles2016 <- do.call(rbind, all_tables)

#Fumbles 2017
urls <- c(
  "https://www.nfl.com/stats/player-stats/category/rushing/2017/reg/all/rushingfumbles/desc",
  "https://www.nfl.com/stats/player-stats/category/rushing/2017/REG/all/rushingfumbles/DESC?aftercursor=AAAAGQAAABhAAAAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXlJaXdpTXpJd01EUXlOREV0TlRJd055MDNOek16TFRVNU1UTXROVGd5TURGbE9UWmpZVGt6SWl3aU1qQXhOeUpkZlE9PQ==",
  "https://www.nfl.com/stats/player-stats/category/rushing/2017/REG/all/rushingfumbles/DESC?aftercursor=AAAAMgAAABhAAAAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXlJaXdpTXpJd01EVTVORFV0TkdNd05pMHdNVGcyTFdOa01HWXRZVGt6WXpjMFlUQmtObUUySWl3aU1qQXhOeUpkZlE9PQ==",
  "https://www.nfl.com/stats/player-stats/category/rushing/2017/REG/all/rushingfumbles/DESC?aftercursor=AAAASwAAADM_8AAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXhJaXdpTXpJd01EUTROR1l0TlRjeU15MDVOREU0TFRrNE1qWXRNRGc0WWpjeE56Wm1NelJrSWl3aU1qQXhOeUpkZlE9PQ==",
  "https://www.nfl.com/stats/player-stats/category/rushing/2017/REG/all/rushingfumbles/DESC?aftercursor=AAAAZAAAADM_8AAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXhJaXdpTXpJd01EVXpOR1F0TkRrd015MHhNVEkyTFRZME1UUXRaV1ZpWVRVMk1ETmpZelEwSWl3aU1qQXhOeUpkZlE9PQ=="
)

all_tables <- list()
for (url in urls) {
  table_data <- scrape_nfl_table(url)
  all_tables[[url]] <- table_data
}

Fumbles2017 <- do.call(rbind, all_tables)

#Fumbles 2018
urls <- c(
  "https://www.nfl.com/stats/player-stats/category/rushing/2018/reg/all/rushingfumbles/desc",
  "https://www.nfl.com/stats/player-stats/category/rushing/2018/REG/all/rushingfumbles/DESC?aftercursor=AAAAGQAAABZAAAAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXlJaXdpTXpJd01EUXpOR1l0TkRnME1pMDNOalF5TFRJeU0yRXRNRFJrTmpGa016Vm1ZalZqSWl3aU1qQXhPQ0pkZlE9PQ==",
  "https://www.nfl.com/stats/player-stats/category/rushing/2018/REG/all/rushingfumbles/DESC?aftercursor=AAAAMgAAAC4_8AAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXhJaXdpTXpJd01EUXlOREV0TlRJd055MDNOek16TFRVNU1UTXROVGd5TURGbE9UWmpZVGt6SWl3aU1qQXhPQ0pkZlE9PQ==",
  "https://www.nfl.com/stats/player-stats/category/rushing/2018/REG/all/rushingfumbles/DESC?aftercursor=AAAASwAAAC4_8AAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXhJaXdpTXpJd01EUmhOVFV0TlRNNE1TMHlOek0yTFRZNU5EQXRNbVkxWXpKaE1EZ3lNMkkzSWl3aU1qQXhPQ0pkZlE9PQ=="
  
)

all_tables <- list()
for (url in urls) {
  table_data <- scrape_nfl_table(url)
  all_tables[[url]] <- table_data
}

Fumbles2018 <- do.call(rbind, all_tables)

#Fumbles 2019
urls <- c(
  "https://www.nfl.com/stats/player-stats/category/rushing/2019/reg/all/rushingfumbles/desc",
  "https://www.nfl.com/stats/player-stats/category/rushing/2019/REG/all/rushingfumbles/DESC?aftercursor=AAAAGQAAAA9ACAAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXpJaXdpTXpJd01EUmlOREV0TkdReU5DMDBNRFU0TFRWaE0ySXRNREZpWkRNNVpUWmhNalZrSWl3aU1qQXhPU0pkZlE9PQ==",
  "https://www.nfl.com/stats/player-stats/category/rushing/2019/REG/all/rushingfumbles/DESC?aftercursor=AAAAMgAAAB9AAAAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXlJaXdpTXpJd01EVXpOVFF0TkRFeE15MDBNVFUzTFRFNVlqRXRNemRsTmpnek5XUXdPV0k1SWl3aU1qQXhPU0pkZlE9PQ==",
  "https://www.nfl.com/stats/player-stats/category/rushing/2019/REG/all/rushingfumbles/DESC?aftercursor=AAAASwAAADQ_8AAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXhJaXdpTXpJd01EUmtORGt0TkdNeE5DMHdNRGt3TFRKa09HRXRNemcyTmpFMFlXUm1NVFExSWl3aU1qQXhPU0pkZlE9PQ=="
)

all_tables <- list()
for (url in urls) {
  table_data <- scrape_nfl_table(url)
  all_tables[[url]] <- table_data
}

Fumbles2019 <- do.call(rbind, all_tables)

#Fumbles 2020
urls <- c(
  "https://www.nfl.com/stats/player-stats/category/rushing/2020/reg/all/rushingfumbles/desc",
  "https://www.nfl.com/stats/player-stats/category/rushing/2020/REG/all/rushingfumbles/DESC?aftercursor=AAAAGQAAABlAAAAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXlJaXdpTXpJd01EUXlOVEl0TkRVeU5TMDJPREU1TFdZMFpUTXRaak0wTTJFek9URmpaR0prSWl3aU1qQXlNQ0pkZlE9PQ==",
  "https://www.nfl.com/stats/player-stats/category/rushing/2020/REG/all/rushingfumbles/DESC?aftercursor=AAAAMgAAACg_8AAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXhJaXdpTXpJd01EUTBOREV0TkdNMk5TMDVPVEF3TFRVMU1XUXRZVE14WVRBME1qTmlNMk5oSWl3aU1qQXlNQ0pkZlE9PQ==",
  "https://www.nfl.com/stats/player-stats/category/rushing/2020/REG/all/rushingfumbles/DESC?aftercursor=AAAASwAAACg_8AAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXhJaXdpTXpJd01EUmpOREV0TkRrMk5pMDROekV6TFRsbU1tRXRaV1UyT1dNeU5HRTNObUpqSWl3aU1qQXlNQ0pkZlE9PQ==",
  "https://www.nfl.com/stats/player-stats/category/rushing/2020/REG/all/rushingfumbles/DESC?aftercursor=AAAAZAAAACg_8AAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXhJaXdpTXpJd01EVTBOVEl0TlRVeU1TMDFNek0yTFRnMU1Ua3RZemhqWWpRMVpXRTVZamMwSWl3aU1qQXlNQ0pkZlE9PQ=="
)

all_tables <- list()
for (url in urls) {
  table_data <- scrape_nfl_table(url)
  all_tables[[url]] <- table_data
}

Fumbles2020 <- do.call(rbind, all_tables)

#Fumbles 2021
urls <- c(
  "https://www.nfl.com/stats/player-stats/category/rushing/2021/reg/all/rushingfumbles/desc",
  "https://www.nfl.com/stats/player-stats/category/rushing/2021/REG/all/rushingfumbles/DESC?aftercursor=AAAAGQAAABZAAAAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXlJaXdpTXpJd01EUXpOR1l0TlRVM01DMDVOREF3TFdVeFlXVXRaamd6TldGaVlqVTVOak5sSWl3aU1qQXlNU0pkZlE9PQ==",
  "https://www.nfl.com/stats/player-stats/category/rushing/2021/REG/all/rushingfumbles/DESC?aftercursor=AAAAMgAAADA_8AAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXhJaXdpTXpJd01EUXlOR1l0TkdNeE5pMDNOamszTFdJd01tUXRNVE5pTVRSa01XRTRabVV5SWl3aU1qQXlNU0pkZlE9PQ==",
  "https://www.nfl.com/stats/player-stats/category/rushing/2021/REG/all/rushingfumbles/DESC?aftercursor=AAAASwAAADA_8AAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXhJaXdpTXpJd01EUmhOR1l0TkRneE55MDBORGMzTFRSbE5XWXRaR0kyWm1JMVlUazFZV0psSWl3aU1qQXlNU0pkZlE9PQ=="
)

all_tables <- list()
for (url in urls) {
  table_data <- scrape_nfl_table(url)
  all_tables[[url]] <- table_data
}

Fumbles2021 <- do.call(rbind, all_tables)

#Fumbles 2022
urls <- c(
  "https://www.nfl.com/stats/player-stats/category/rushing/2022/reg/all/rushingfumbles/desc",
  "https://www.nfl.com/stats/player-stats/category/rushing/2022/REG/all/rushingfumbles/DESC?aftercursor=AAAAGQAAAA1ACAAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXpJaXdpTXpJd01EVXpORGt0TkdVeE9DMDJPVEU1TFdReFpUWXRNREF6WmpRMk16SmlZVGczSWl3aU1qQXlNaUpkZlE9PQ==",
  "https://www.nfl.com/stats/player-stats/category/rushing/2022/REG/all/rushingfumbles/DESC?aftercursor=AAAAMgAAAB1AAAAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXlJaXdpTXpJd01EVTNORGt0TkdNM055MDNOemd4TFRjNU5XTXRPVFJqTnpVek56QTJaREZrSWl3aU1qQXlNaUpkZlE9PQ==",
  "https://www.nfl.com/stats/player-stats/category/rushing/2022/REG/all/rushingfumbles/DESC?aftercursor=AAAASwAAADU_8AAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXhJaXdpTXpJd01EUTRORGt0TkdNMk1DMDVOVGszTFdNMVlUa3RORE0yT1dJNVl6ZGpaREZsSWl3aU1qQXlNaUpkZlE9PQ==",
  "https://www.nfl.com/stats/player-stats/category/rushing/2022/REG/all/rushingfumbles/DESC?aftercursor=AAAAZAAAADU_8AAAAAAAADFleUp6WldGeVkyaEJablJsY2lJNld5SXhJaXdpTXpJd01EVXpOREV0TkdVeE5TMHpOVFkzTFRnMk9XUXROemxqTnpNNU5qVmlOVFJsSWl3aU1qQXlNaUpkZlE9PQ=="
)

all_tables <- list()
for (url in urls) {
  table_data <- scrape_nfl_table(url)
  all_tables[[url]] <- table_data
}

Fumbles2022 <- do.call(rbind, all_tables)

#Bind fumbles data frames together
allFumbles <- bind_rows(Fumbles1997, Fumbles1998, Fumbles1999, Fumbles2000, Fumbles2001,
                        Fumbles2002, Fumbles2003, Fumbles2004, Fumbles2005, Fumbles2006,
                        Fumbles2007, Fumbles2008, Fumbles2009, Fumbles2010, Fumbles2011, 
                        Fumbles2012, Fumbles2013, Fumbles2014, Fumbles2015, Fumbles2016,
                        Fumbles2017, Fumbles2018, Fumbles2019, Fumbles2020, Fumbles2021, 
                        Fumbles2022)

#Combine rows of the same player
allFumbles <- allFumbles %>%
  group_by(Player) %>%
  summarise(
    Rush_Yds = sum(`Rush Yds`),
    Rush_Att = sum(Att),
    Rush_TD = sum(TD),
    `Rush_20+` = sum(`20+`),
    `Rush_40+` = sum(`40+`),
    Rush_Lng = max(Lng),
    Rush_1st = sum(`Rush 1st`),
    Rush_1st_Perc = mean(`Rush 1st%`),
    Rush_Fumbles = sum(`Rush FUM`)
  )

# Merge data based on the 'Player' column
QBStats <- merge(PFRstats, allFumbles, by="Player", all.x=TRUE)

# Replace NA values with 0
QBStats[is.na(QBStats)] <- 0
#395 qbs , 33 cols
```

*Add College Stats to PFRstats(currently acting as main dataframe)*
```{r}
# NCAA stats are found using sports-reference.com as they're not available on NCAA.com
# Of course we leave out 2022 college year as we only go to 2022 QB's who played full 2022 season, and we include 4 years prior to 1997 as a QB drafted in 1997 is included in our Stats (4 years eligibility NCAA)
# List of URLs
urls <- c(
  "https://www.sports-reference.com/cfb/years/1993-passing.html",
  "https://www.sports-reference.com/cfb/years/1994-passing.html",
  "https://www.sports-reference.com/cfb/years/1995-passing.html",
  "https://www.sports-reference.com/cfb/years/1996-passing.html",
  "https://www.sports-reference.com/cfb/years/1997-passing.html",
  "https://www.sports-reference.com/cfb/years/1997-passing.html",
  "https://www.sports-reference.com/cfb/years/1998-passing.html",
  "https://www.sports-reference.com/cfb/years/1999-passing.html",
  "https://www.sports-reference.com/cfb/years/2000-passing.html", 
  "https://www.sports-reference.com/cfb/years/2001-passing.html",
  "https://www.sports-reference.com/cfb/years/2002-passing.html",
  "https://www.sports-reference.com/cfb/years/2003-passing.html",
  "https://www.sports-reference.com/cfb/years/2004-passing.html",
  "https://www.sports-reference.com/cfb/years/2005-passing.html",
  "https://www.sports-reference.com/cfb/years/2006-passing.html",
  "https://www.sports-reference.com/cfb/years/2007-passing.html",
  "https://www.sports-reference.com/cfb/years/2008-passing.html",
  "https://www.sports-reference.com/cfb/years/2009-passing.html",
  "https://www.sports-reference.com/cfb/years/2010-passing.html",
  "https://www.sports-reference.com/cfb/years/2011-passing.html",
  "https://www.sports-reference.com/cfb/years/2012-passing.html",
  "https://www.sports-reference.com/cfb/years/2013-passing.html",
  "https://www.sports-reference.com/cfb/years/2014-passing.html",
  "https://www.sports-reference.com/cfb/years/2015-passing.html",
  "https://www.sports-reference.com/cfb/years/2016-passing.html",
  "https://www.sports-reference.com/cfb/years/2017-passing.html",
  "https://www.sports-reference.com/cfb/years/2018-passing.html",
  "https://www.sports-reference.com/cfb/years/2019-passing.html",
  "https://www.sports-reference.com/cfb/years/2020-passing.html",
  "https://www.sports-reference.com/cfb/years/2021-passing.html"
)

# Initialize an empty list to store data frames
dataframes <- list()

# Loop through each URL
for (url in urls) {
  Sys.sleep(5)

  page <- read_html(url)
  table_selector <- "#div_passing"
  table_node <- page %>% html_nodes(css = table_selector)
  table_data <- table_node %>% html_table()
  NCAA_data <- as.data.frame(table_data[[1]])

  # Convert the first row to character vector for column names
  col_names <- as.character(unlist(NCAA_data[1, ]))
  colnames(NCAA_data) <- col_names

  # Add a column "Year_Drafted" that contains the draft year extracted from the URL
  year <- as.numeric(sub(".*/years/(\\d+)-.*", "\\1", url))
  NCAA_data$Year <- year

  # Remove Header Rows
  NCAA_data <- NCAA_data[!grepl('Rk', NCAA_data$Rk), ]

  # Append the dataframe to the list
  dataframes <- append(dataframes, list(NCAA_data))
}

# Combine all dataframes into one
NCAAStats <- do.call(rbind, dataframes)

#Strip names of any symbols used for indication purposes
NCAAStats$Player <- sub("\\*\\s*", "", NCAAStats$Player)




# Remove the "Year" column
NCAAStats <- NCAAStats[, -ncol(NCAAStats)]

#Make columns numeric
cols_to_num <- c("G", "Cmp", "Att", "Pct","Yds", "Y/A","AY/A","TD", "Int", "Rate","Att.1", "Yds.1", "Avg", "TD.1")
NCAAStats[cols_to_num] <- lapply(NCAAStats[cols_to_num], as.numeric)

# Group by "Player" and summarize the data
NCAAStats <- NCAAStats %>%
  group_by(Player) %>%
  summarise(
    Col_G = sum(G),
    Col_Cmp = sum(Cmp),
    Col_Att = sum(Att),
    Col_Yds = sum(Yds),
    Col_TD = sum(TD),
    Col_Int = sum(Int),
    Col_Rush_Att = sum(`Att.1`),
    Col_Rush_Yds = sum(`Yds.1`),
    Col_Rush_TD = sum(`TD.1`),
    Col_Pct = mean(Pct),
    `Col_Y/A` = mean(`Y/A`),
    `Col_AY/A` = mean(`AY/A`),
    Col_Rate = mean(Rate),
    Col_Rush_Avg = mean(Avg)
  )

#Add NCAA Stats to main QBStats data frame
QBStats <- merge(QBStats, NCAAStats, by="Player", all.x=TRUE)
#395 QBS 47 Cols

merged_df$Year_Drafted <- NA
merged_df$Overall_Pick <- NA
#Add Year Drafted for each guy, because current df has all qbs that played from 1997-2022, not drafted 1997-2022,
#0 being UDFA (undrafted free agent)
QBStats[QBStats$Player == "Aaron Brooks", c("Year_Drafted", "Overall_Pick")] <- c(1999,131)
QBStats[QBStats$Player == "Aaron Rodgers", c("Year_Drafted","Overall_Pick")] <- c(2005,24)
QBStats[QBStats$Player == "AJ Feeley", c("Year_Drafted","Overall_Pick")] <- c(2001,155)
QBStats[QBStats$Player == "AJ McCarron", c("Year_Drafted","Overall_Pick")] <- c(2014,164)
QBStats[QBStats$Player == "Akili Smith", c("Year_Drafted","Overall_Pick")] <- c(1999,3)
QBStats[QBStats$Player == "Alex Smith", c("Year_Drafted","Overall_Pick")] <- c(2005,1)
QBStats[QBStats$Player == "Alex Tanney", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Alex Van Pelt", c("Year_Drafted","Overall_Pick")] <- c(1993,216)
QBStats[QBStats$Player == "Andrew Luck", c("Year_Drafted","Overall_Pick")] <- c(2012,1)
QBStats[QBStats$Player == "Andrew Walter", c("Year_Drafted","Overall_Pick")] <- c(2005,69)
QBStats[QBStats$Player == "Andy Dalton", c("Year_Drafted","Overall_Pick")] <- c(2012,35)
QBStats[QBStats$Player == "Anthony Brown", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Anthony Wright", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Armanti Edwards", c("Year_Drafted","Overall_Pick")] <- c(2010,89)
QBStats[QBStats$Player == "Austin Davis", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Bailey Zappe", c("Year_Drafted","Overall_Pick")] <- c(2022,137)
QBStats[QBStats$Player == "Baker Mayfield", c("Year_Drafted","Overall_Pick")] <- c(2018,1)
QBStats[QBStats$Player == "Ben DiNucci", c("Year_Drafted","Overall_Pick")] <- c(2020,231)
QBStats[QBStats$Player == "Ben Roethlisberger", c("Year_Drafted","Overall_Pick")] <- c(2004,11)
QBStats[QBStats$Player == "Billy Joe Hobert", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Billy Joe Tolliver", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Billy Volek", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "BJ Daniels", c("Year_Drafted","Overall_Pick")] <- c(2013,237)
QBStats[QBStats$Player == "Blaine Gabbert", c("Year_Drafted","Overall_Pick")] <- c(2011,10)
QBStats[QBStats$Player == "Blake Bortles", c("Year_Drafted","Overall_Pick")] <- c(2014,3)
QBStats[QBStats$Player == "Bobby Hoying", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Boomer Esiason", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Brad Johnson", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Bradlee Van Pelt", c("Year_Drafted","Overall_Pick")] <- c(2004,250)
QBStats[QBStats$Player == "Brady Quinn", c("Year_Drafted","Overall_Pick")] <- c(2007,22)
QBStats[QBStats$Player == "Brandon Allen", c("Year_Drafted","Overall_Pick")] <- c(2016,201)
QBStats[QBStats$Player == "Brandon Weeden", c("Year_Drafted","Overall_Pick")] <- c(2012,22)
QBStats[QBStats$Player == "Brett Basanez", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Brett Favre", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Brett Hundley", c("Year_Drafted","Overall_Pick")] <- c(2015,147)
QBStats[QBStats$Player == "Brett Rypien", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Brian Brohm", c("Year_Drafted","Overall_Pick")] <- c(2008,56)
QBStats[QBStats$Player == "Brian Griese", c("Year_Drafted","Overall_Pick")] <- c(1998,91)
QBStats[QBStats$Player == "Brian Hoyer", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Brian St Pierre", c("Year_Drafted","Overall_Pick")] <- c(2003,163)
QBStats[QBStats$Player == "Brock Berlin", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Brock Huard", c("Year_Drafted","Overall_Pick")] <- c(1999,77)
QBStats[QBStats$Player == "Brock Osweiler", c("Year_Drafted","Overall_Pick")] <- c(2012,57)
QBStats[QBStats$Player == "Brock Purdy", c("Year_Drafted","Overall_Pick")] <- c(2022,262)
QBStats[QBStats$Player == "Brodie Croyle", c("Year_Drafted","Overall_Pick")] <- c(2006,85)
QBStats[QBStats$Player == "Brooks Bollinger", c("Year_Drafted","Overall_Pick")] <- c(2003,200)
QBStats[QBStats$Player == "Bruce Gradkowski", c("Year_Drafted","Overall_Pick")] <- c(2006,194)
QBStats[QBStats$Player == "Bryce Perkins", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Bryce Petty", c("Year_Drafted","Overall_Pick")] <- c(2015,103)
QBStats[QBStats$Player == "Bubby Brister", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Byron Leftwich", c("Year_Drafted","Overall_Pick")] <- c(2003,7)
QBStats[QBStats$Player == "Cade McNown", c("Year_Drafted","Overall_Pick")] <- c(1999,12)
QBStats[QBStats$Player == "Caleb Hanie", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Cam Newton", c("Year_Drafted","Overall_Pick")] <- c(2011,1)
QBStats[QBStats$Player == "Cardale Jones", c("Year_Drafted","Overall_Pick")] <- c(2016,139)
QBStats[QBStats$Player == "Carson Palmer", c("Year_Drafted","Overall_Pick")] <- c(2003,1)
QBStats[QBStats$Player == "Carson Wentz", c("Year_Drafted","Overall_Pick")] <- c(2016,2)
QBStats[QBStats$Player == "Case Keenum", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Chad Henne", c("Year_Drafted","Overall_Pick")] <- c(2008,57)
QBStats[QBStats$Player == "Chad Hutchinson", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Chad Pennington", c("Year_Drafted","Overall_Pick")] <- c(2000,18)
QBStats[QBStats$Player == "Charlie Batch", c("Year_Drafted","Overall_Pick")] <- c(1998,60)
QBStats[QBStats$Player == "Charlie Frye", c("Year_Drafted","Overall_Pick")] <- c(2005,67)
QBStats[QBStats$Player == "Charlie Whitehurst", c("Year_Drafted","Overall_Pick")] <- c(2006,81)
QBStats[QBStats$Player == "Chase Daniel", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Chris Chandler", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Chris Greisen", c("Year_Drafted","Overall_Pick")] <- c(1999,239)
QBStats[QBStats$Player == "Chris Miller", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Chris Redman", c("Year_Drafted","Overall_Pick")] <- c(2000,75)
QBStats[QBStats$Player == "Chris Simms", c("Year_Drafted","Overall_Pick")] <- c(2003,97)
QBStats[QBStats$Player == "Chris Streveler", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Chris Weinke", c("Year_Drafted","Overall_Pick")] <- c(2001,106)
QBStats[QBStats$Player == "Christian Ponder", c("Year_Drafted","Overall_Pick")] <- c(2011,12)
QBStats[QBStats$Player == "CJ Beathard", c("Year_Drafted","Overall_Pick")] <- c(2017,104)
QBStats[QBStats$Player == "Cleo Lemon", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Clint Stoerner", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Cody Kessler", c("Year_Drafted","Overall_Pick")] <- c(2016,93)
QBStats[QBStats$Player == "Cody Pickett", c("Year_Drafted","Overall_Pick")] <- c(2004,217)
QBStats[QBStats$Player == "Colin Kaepernick", c("Year_Drafted","Overall_Pick")] <- c(2011,36)
QBStats[QBStats$Player == "Colt McCoy", c("Year_Drafted","Overall_Pick")] <- c(2010,85)
QBStats[QBStats$Player == "Connor Cook", c("Year_Drafted","Overall_Pick")] <- c(2016,100)
QBStats[QBStats$Player == "Connor Shaw", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Cooper Rush", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Cory Sauter", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Craig Erickson", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Craig Krenzel", c("Year_Drafted","Overall_Pick")] <- c(2004,148)
QBStats[QBStats$Player == "Craig Nall", c("Year_Drafted","Overall_Pick")] <- c(2002,164)
QBStats[QBStats$Player == "Craig Whelihan", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Curtis Painter", c("Year_Drafted","Overall_Pick")] <- c(2009,201)
QBStats[QBStats$Player == "Dak Prescott", c("Year_Drafted","Overall_Pick")] <- c(2016,135)
QBStats[QBStats$Player == "Dameyune Craig", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Damon Huard", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Dan Marino", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Dan Orlovsky", c("Year_Drafted","Overall_Pick")] <- c(2005,145)
QBStats[QBStats$Player == "Daniel Jones", c("Year_Drafted","Overall_Pick")] <- c(2019,6)
QBStats[QBStats$Player == "Danny Kanell", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Danny Wuerffel", c("Year_Drafted","Overall_Pick")] <- c(1997,99)
QBStats[QBStats$Player == "Daunte Culpepper", c("Year_Drafted","Overall_Pick")] <- c(1999,11)
QBStats[QBStats$Player == "Dave Brown", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Dave Krieg", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Dave Ragone", c("Year_Drafted","Overall_Pick")] <- c(2003,88)
QBStats[QBStats$Player == "David Blough", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "David Carr", c("Year_Drafted","Overall_Pick")] <- c(2002,1)
QBStats[QBStats$Player == "David Fales", c("Year_Drafted","Overall_Pick")] <- c(2014,183)
QBStats[QBStats$Player == "David Garrard", c("Year_Drafted","Overall_Pick")] <- c(2002,108)
QBStats[QBStats$Player == "David Klingler", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Davis Mills", c("Year_Drafted","Overall_Pick")] <- c(2021,67)
QBStats[QBStats$Player == "Davis Webb", c("Year_Drafted","Overall_Pick")] <- c(2017,87)
QBStats[QBStats$Player == "Dennis Dixon", c("Year_Drafted","Overall_Pick")] <- c(2008,156)
QBStats[QBStats$Player == "Derek Anderson", c("Year_Drafted","Overall_Pick")] <- c(2005,213)
QBStats[QBStats$Player == "Derek Carr", c("Year_Drafted","Overall_Pick")] <- c(2014,36)
QBStats[QBStats$Player == "Deshaun Watson", c("Year_Drafted","Overall_Pick")] <- c(2017,12)
QBStats[QBStats$Player == "DeShone Kizer", c("Year_Drafted","Overall_Pick")] <- c(2017,52)
QBStats[QBStats$Player == "Desmond Ridder", c("Year_Drafted","Overall_Pick")] <- c(2022,74)
QBStats[QBStats$Player == "Devlin Hodges", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Dominique Davis", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Donald Hollas", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Donovan McNabb", c("Year_Drafted","Overall_Pick")] <- c(1999,2)
QBStats[QBStats$Player == "Doug Flutie", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Doug Johnson", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Doug Nussmeier", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Doug Pederson", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Drew Bledsoe", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Drew Brees", c("Year_Drafted","Overall_Pick")] <- c(2001,32)
QBStats[QBStats$Player == "Drew Henson", c("Year_Drafted","Overall_Pick")] <- c(2003,192)
QBStats[QBStats$Player == "Drew Lock", c("Year_Drafted","Overall_Pick")] <- c(2019,42)
QBStats[QBStats$Player == "Drew Stanton", c("Year_Drafted","Overall_Pick")] <- c(2007,43)
QBStats[QBStats$Player == "Dwayne Haskins", c("Year_Drafted","Overall_Pick")] <- c(2019,15)
QBStats[QBStats$Player == "Easton Stick", c("Year_Drafted","Overall_Pick")] <- c(2019,166)
QBStats[QBStats$Player == "EJ Manuel", c("Year_Drafted","Overall_Pick")] <- c(2013,16)
QBStats[QBStats$Player == "Eli Manning", c("Year_Drafted","Overall_Pick")] <- c(2004,1)
QBStats[QBStats$Player == "Elvis Grbac", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Eric Kresser", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Eric Zeier", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Erik Kramer", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Feleipe Franks", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Frank Reich", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Gardner Minshew II", c("Year_Drafted","Overall_Pick")] <- c(2019,178)
QBStats[QBStats$Player == "Garrett Gilbert", c("Year_Drafted","Overall_Pick")] <- c(2014,214)
QBStats[QBStats$Player == "Geno Smith", c("Year_Drafted","Overall_Pick")] <- c(2013,39)
QBStats[QBStats$Player == "Gibran Hamdan", c("Year_Drafted","Overall_Pick")] <- c(2003,232)
QBStats[QBStats$Player == "Glenn Foley", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Graham Harrell", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Greg McElroy", c("Year_Drafted","Overall_Pick")] <- c(2011,208)
QBStats[QBStats$Player == "Gus Frerotte", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Heath Shuler", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Henry Burris", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Ian Book", c("Year_Drafted","Overall_Pick")] <- c(2021,133)
QBStats[QBStats$Player == "Jacob Eason", c("Year_Drafted","Overall_Pick")] <- c(2020,122)
QBStats[QBStats$Player == "Jacoby Brissett", c("Year_Drafted","Overall_Pick")] <- c(2016,91)
QBStats[QBStats$Player == "Jake Delhomme", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Jake Fromm", c("Year_Drafted","Overall_Pick")] <- c(2020,167)
QBStats[QBStats$Player == "Jake Locker", c("Year_Drafted","Overall_Pick")] <- c(2011,8)
QBStats[QBStats$Player == "Jake Luton", c("Year_Drafted","Overall_Pick")] <- c(2020,189)
QBStats[QBStats$Player == "Jake Plummer", c("Year_Drafted","Overall_Pick")] <- c(1997,42)
QBStats[QBStats$Player == "Jake Rudock", c("Year_Drafted","Overall_Pick")] <- c(2016,191)
QBStats[QBStats$Player == "Jalen Hurts", c("Year_Drafted","Overall_Pick")] <- c(2020,53)
QBStats[QBStats$Player == "JaMarcus Russell", c("Year_Drafted","Overall_Pick")] <- c(2007,1)
QBStats[QBStats$Player == "Jameis Winston", c("Year_Drafted","Overall_Pick")] <- c(2015,1)
QBStats[QBStats$Player == "James Ritchey", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Jamie Martin", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Jared Goff", c("Year_Drafted","Overall_Pick")] <- c(2016,1)
QBStats[QBStats$Player == "Jared Lorenzen", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Jarious Jackson", c("Year_Drafted","Overall_Pick")] <- c(2000,214)
QBStats[QBStats$Player == "Jarrett Stidham", c("Year_Drafted","Overall_Pick")] <- c(2019,133)
QBStats[QBStats$Player == "Jason Campbell", c("Year_Drafted","Overall_Pick")] <- c(2005,25)
QBStats[QBStats$Player == "Jason Garrett", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Jay Cutler", c("Year_Drafted","Overall_Pick")] <- c(2006,11)
QBStats[QBStats$Player == "Jay Fiedler", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Jeff Blake", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Jeff Brohm", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Jeff Driskel", c("Year_Drafted","Overall_Pick")] <- c(2016,207)
QBStats[QBStats$Player == "Jeff Garcia", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Jeff George", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Jeff Hostetler", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Jeff Lewis", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Jeff Tuel", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Jesse Palmer", c("Year_Drafted","Overall_Pick")] <- c(2001,125)
QBStats[QBStats$Player == "Jim Druckenmiller", c("Year_Drafted","Overall_Pick")] <- c(1997,26)
QBStats[QBStats$Player == "Jim Everett", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Jim Harbaugh", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Jim Miller", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Jim Sorgi", c("Year_Drafted","Overall_Pick")] <- c(2004,193)
QBStats[QBStats$Player == "Jimmy Clausen", c("Year_Drafted","Overall_Pick")] <- c(2010,48)
QBStats[QBStats$Player == "Jimmy Garoppolo", c("Year_Drafted","Overall_Pick")] <- c(2014,62)
QBStats[QBStats$Player == "Joe Burrow", c("Year_Drafted","Overall_Pick")] <- c(2020,1)
QBStats[QBStats$Player == "Joe Callahan", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Joe Flacco", c("Year_Drafted","Overall_Pick")] <- c(2008,18)
QBStats[QBStats$Player == "Joe Germaine", c("Year_Drafted","Overall_Pick")] <- c(1999,101)
QBStats[QBStats$Player == "Joe Webb", c("Year_Drafted","Overall_Pick")] <- c(2010,199)
QBStats[QBStats$Player == "Joey Harrington", c("Year_Drafted","Overall_Pick")] <- c(2002,3)
QBStats[QBStats$Player == "John Beck", c("Year_Drafted","Overall_Pick")] <- c(2007,40)
QBStats[QBStats$Player == "John Elway", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "John Friesz", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "John Navarre", c("Year_Drafted","Overall_Pick")] <- c(2004,202)
QBStats[QBStats$Player == "John Skelton", c("Year_Drafted","Overall_Pick")] <- c(2010,155)
QBStats[QBStats$Player == "John Wolford", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Johnny Manziel", c("Year_Drafted","Overall_Pick")] <- c(2014,22)
QBStats[QBStats$Player == "Jon Kitna", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Jonathan Quinn", c("Year_Drafted","Overall_Pick")] <- c(1998,86)
QBStats[QBStats$Player == "Jordan Love", c("Year_Drafted","Overall_Pick")] <- c(2020,26)
QBStats[QBStats$Player == "Jordan Palmer", c("Year_Drafted","Overall_Pick")] <- c(2007,205)
QBStats[QBStats$Player == "Josh Allen", c("Year_Drafted","Overall_Pick")] <- c(2018,7)
QBStats[QBStats$Player == "Josh Freeman", c("Year_Drafted","Overall_Pick")] <- c(2009,17)
QBStats[QBStats$Player == "Josh Johnson", c("Year_Drafted","Overall_Pick")] <- c(2008,160)
QBStats[QBStats$Player == "Josh McCown", c("Year_Drafted","Overall_Pick")] <- c(2002,81)
QBStats[QBStats$Player == "Josh Rosen", c("Year_Drafted","Overall_Pick")] <- c(2018,10)
QBStats[QBStats$Player == "Joshua Dobbs", c("Year_Drafted","Overall_Pick")] <- c(2017,135)
QBStats[QBStats$Player == "JP Losman", c("Year_Drafted","Overall_Pick")] <- c(2004,22)
QBStats[QBStats$Player == "JT OSullivan", c("Year_Drafted","Overall_Pick")] <- c(2002,186)
QBStats[QBStats$Player == "Justin Fields", c("Year_Drafted","Overall_Pick")] <- c(2021,11)
QBStats[QBStats$Player == "Justin Herbert", c("Year_Drafted","Overall_Pick")] <- c(2020,6)
QBStats[QBStats$Player == "Keith Null", c("Year_Drafted","Overall_Pick")] <- c(2009,196)
QBStats[QBStats$Player == "Kellen Clemens", c("Year_Drafted","Overall_Pick")] <- c(2006,49)
QBStats[QBStats$Player == "Kellen Mond", c("Year_Drafted","Overall_Pick")] <- c(2021,66)
QBStats[QBStats$Player == "Kellen Moore", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Kelly Holcomb", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Ken Dorsey", c("Year_Drafted","Overall_Pick")] <- c(2003,241)
QBStats[QBStats$Player == "Kenny Pickett", c("Year_Drafted","Overall_Pick")] <- c(2022,20)
QBStats[QBStats$Player == "Kent Graham", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Kerry Collins", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Kevin Hogan", c("Year_Drafted","Overall_Pick")] <- c(2016,162)
QBStats[QBStats$Player == "Kevin Kolb", c("Year_Drafted","Overall_Pick")] <- c(2007,36)
QBStats[QBStats$Player == "Kevin OConnell", c("Year_Drafted","Overall_Pick")] <- c(2008,94)
QBStats[QBStats$Player == "Kevin Thompson", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Kirk Cousins", c("Year_Drafted","Overall_Pick")] <- c(2012,102)
QBStats[QBStats$Player == "Kliff Kingsbury", c("Year_Drafted","Overall_Pick")] <- c(2003,201)
QBStats[QBStats$Player == "Kordell Stewart", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Koy Detmer", c("Year_Drafted","Overall_Pick")] <- c(1997,207)
QBStats[QBStats$Player == "Kurt Kittner", c("Year_Drafted","Overall_Pick")] <- c(2002,158)
QBStats[QBStats$Player == "Kurt Warner", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Kyle Allen", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Kyle Boller", c("Year_Drafted","Overall_Pick")] <- c(2003,19)
QBStats[QBStats$Player == "Kyle Lauletta", c("Year_Drafted","Overall_Pick")] <- c(2018,108)
QBStats[QBStats$Player == "Kyle Orton", c("Year_Drafted","Overall_Pick")] <- c(2005,106)
QBStats[QBStats$Player == "Kyle Trask", c("Year_Drafted","Overall_Pick")] <- c(2021,64)
QBStats[QBStats$Player == "Kyler Murray", c("Year_Drafted","Overall_Pick")] <- c(2019,1)
QBStats[QBStats$Player == "Lamar Jackson", c("Year_Drafted","Overall_Pick")] <- c(2018,32)
QBStats[QBStats$Player == "Landry Jones", c("Year_Drafted","Overall_Pick")] <- c(2013,115)
QBStats[QBStats$Player == "Levi Brown", c("Year_Drafted","Overall_Pick")] <- c(2010,209)
QBStats[QBStats$Player == "Logan Woodside", c("Year_Drafted","Overall_Pick")] <- c(2018,249)
QBStats[QBStats$Player == "Luke Falk", c("Year_Drafted","Overall_Pick")] <- c(2018,199)
QBStats[QBStats$Player == "Luke McCown", c("Year_Drafted","Overall_Pick")] <- c(2004,106)
QBStats[QBStats$Player == "Mac Jones", c("Year_Drafted","Overall_Pick")] <- c(2021,15)
QBStats[QBStats$Player == "Malik Willis", c("Year_Drafted","Overall_Pick")] <- c(2022,86)
QBStats[QBStats$Player == "Marc Bulger", c("Year_Drafted","Overall_Pick")] <- c(2000,168)
QBStats[QBStats$Player == "Marcus Mariota", c("Year_Drafted","Overall_Pick")] <- c(2015,2)
QBStats[QBStats$Player == "Mark Brunell", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Mark Hartsell", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Mark Rypien", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Mark Sanchez", c("Year_Drafted","Overall_Pick")] <- c(2009,5)
QBStats[QBStats$Player == "Marques Tuiasosopo", c("Year_Drafted","Overall_Pick")] <- c(2001,59)
QBStats[QBStats$Player == "Mason Rudolph", c("Year_Drafted","Overall_Pick")] <- c(2018,76)
QBStats[QBStats$Player == "Matt Barkley", c("Year_Drafted","Overall_Pick")] <- c(2013,98)
QBStats[QBStats$Player == "Matt Blundin", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Matt Cassel", c("Year_Drafted","Overall_Pick")] <- c(2005,230)
QBStats[QBStats$Player == "Matt Flynn", c("Year_Drafted","Overall_Pick")] <- c(2008,209)
QBStats[QBStats$Player == "Matt Gutierrez", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Matt Hasselbeck", c("Year_Drafted","Overall_Pick")] <- c(1998,187)
QBStats[QBStats$Player == "Matt Leinart", c("Year_Drafted","Overall_Pick")] <- c(2006,10)
QBStats[QBStats$Player == "Matt Lytle", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Matt Mauck", c("Year_Drafted","Overall_Pick")] <- c(2004,225)
QBStats[QBStats$Player == "Matt McGloin", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Matt Moore", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Matt Ryan", c("Year_Drafted","Overall_Pick")] <- c(2008,3)
QBStats[QBStats$Player == "Matt Schaub", c("Year_Drafted","Overall_Pick")] <- c(2004,90)
QBStats[QBStats$Player == "Matt Simms", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Matthew Stafford", c("Year_Drafted","Overall_Pick")] <- c(2009,1)
QBStats[QBStats$Player == "Max Hall", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Michael Bishop", c("Year_Drafted","Overall_Pick")] <- c(1999,227)
QBStats[QBStats$Player == "Michael Vick", c("Year_Drafted","Overall_Pick")] <- c(2001,1)
QBStats[QBStats$Player == "Mike Cherry", c("Year_Drafted","Overall_Pick")] <- c(1997,171)
QBStats[QBStats$Player == "Mike Glennon", c("Year_Drafted","Overall_Pick")] <- c(2013,73)
QBStats[QBStats$Player == "Mike Kafka", c("Year_Drafted","Overall_Pick")] <- c(2010,122)
QBStats[QBStats$Player == "Mike McMahon", c("Year_Drafted","Overall_Pick")] <- c(2001,149)
QBStats[QBStats$Player == "Mike Quinn", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Mike Tomczak", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Mike White", c("Year_Drafted","Overall_Pick")] <- c(2018,171)
QBStats[QBStats$Player == "Mitchell Trubisky", c("Year_Drafted","Overall_Pick")] <- c(2017,2)
QBStats[QBStats$Player == "Moses Moreno", c("Year_Drafted","Overall_Pick")] <- c(1998,232)
QBStats[QBStats$Player == "Nate Sudfeld", c("Year_Drafted","Overall_Pick")] <- c(2016,187)
QBStats[QBStats$Player == "Nathan Peterman", c("Year_Drafted","Overall_Pick")] <- c(2017,171)
QBStats[QBStats$Player == "Neil ODonnell", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Nick Foles", c("Year_Drafted","Overall_Pick")] <- c(2012,88)
QBStats[QBStats$Player == "Nick Mullens", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Patrick Mahomes", c("Year_Drafted","Overall_Pick")] <- c(2017,10)
QBStats[QBStats$Player == "Patrick Ramsey", c("Year_Drafted","Overall_Pick")] <- c(2002,32)
QBStats[QBStats$Player == "Paul Justin", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Paxton Lynch", c("Year_Drafted","Overall_Pick")] <- c(2016,26)
QBStats[QBStats$Player == "Pete Gonzalez", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Peyton Manning", c("Year_Drafted","Overall_Pick")] <- c(1998,1)
QBStats[QBStats$Player == "Philip Rivers", c("Year_Drafted","Overall_Pick")] <- c(2004,4)
QBStats[QBStats$Player == "PJ Walker", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Quincy Carter", c("Year_Drafted","Overall_Pick")] <- c(2001,53)
QBStats[QBStats$Player == "Quinn Gray", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Randall Cunningham", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Randy Fasani", c("Year_Drafted","Overall_Pick")] <- c(2002,137)
QBStats[QBStats$Player == "Ray Lucas", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Rex Grossman", c("Year_Drafted","Overall_Pick")] <- c(2003,22)
QBStats[QBStats$Player == "Rich Gannon", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Richard Bartel", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Rick Mirer", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Rob Johnson", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Robert Griffin III", c("Year_Drafted","Overall_Pick")] <- c(2012,2)
QBStats[QBStats$Player == "Rodney Peete", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Rohan Davey", c("Year_Drafted","Overall_Pick")] <- c(2002,117)
QBStats[QBStats$Player == "Russell Wilson", c("Year_Drafted","Overall_Pick")] <- c(2012,75)
QBStats[QBStats$Player == "Rusty Smith", c("Year_Drafted","Overall_Pick")] <- c(2010,176)
QBStats[QBStats$Player == "Ryan Finley", c("Year_Drafted","Overall_Pick")] <- c(2019,104)
QBStats[QBStats$Player == "Ryan Fitzpatrick", c("Year_Drafted","Overall_Pick")] <- c(2005,250)
QBStats[QBStats$Player == "Ryan Griffin", c("Year_Drafted","Overall_Pick")] <- c(2013,201)
QBStats[QBStats$Player == "Ryan Leaf", c("Year_Drafted","Overall_Pick")] <- c(1998,2)
QBStats[QBStats$Player == "Ryan Lindley", c("Year_Drafted","Overall_Pick")] <- c(2012,185)
QBStats[QBStats$Player == "Ryan Mallett", c("Year_Drafted","Overall_Pick")] <- c(2011,74)
QBStats[QBStats$Player == "Ryan Nassib", c("Year_Drafted","Overall_Pick")] <- c(2013,110)
QBStats[QBStats$Player == "Ryan Tannehill", c("Year_Drafted","Overall_Pick")] <- c(2012,8)
QBStats[QBStats$Player == "Sage Rosenfels", c("Year_Drafted","Overall_Pick")] <- c(2001,109)
QBStats[QBStats$Player == "Sam Bradford", c("Year_Drafted","Overall_Pick")] <- c(2010,1)
QBStats[QBStats$Player == "Sam Darnold", c("Year_Drafted","Overall_Pick")] <- c(2018,3)
QBStats[QBStats$Player == "Sam Ehlinger", c("Year_Drafted","Overall_Pick")] <- c(2021,218)
QBStats[QBStats$Player == "Sam Howell", c("Year_Drafted","Overall_Pick")] <- c(2022,144)
QBStats[QBStats$Player == "Scott Covington", c("Year_Drafted","Overall_Pick")] <- c(1999,245)
QBStats[QBStats$Player == "Scott Mitchell", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Scott Tolzien", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Scott Zolak", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Sean Mannion", c("Year_Drafted","Overall_Pick")] <- c(2015,89)
QBStats[QBStats$Player == "Sean Renfree", c("Year_Drafted","Overall_Pick")] <- c(2013,249)
QBStats[QBStats$Player == "Seneca Wallace", c("Year_Drafted","Overall_Pick")] <- c(2003,110)
QBStats[QBStats$Player == "Shane Matthews", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Shaun Hill", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Shaun King", c("Year_Drafted","Overall_Pick")] <- c(1999,50)
QBStats[QBStats$Player == "SKylar Thompson", c("Year_Drafted","Overall_Pick")] <- c(2022,247)
QBStats[QBStats$Player == "Spergon Wynn", c("Year_Drafted","Overall_Pick")] <- c(2000,183)
QBStats[QBStats$Player == "Stan Humphries", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Stephen McGee", c("Year_Drafted","Overall_Pick")] <- c(2009,101)
QBStats[QBStats$Player == "Steve Beuerlein", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Steve Bono", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Steve DeBerg", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Steve Matthews", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Steve McNair", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Steve Stenstrom", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Steve Walsh", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Steve Young", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Stoney Case", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Tarvaris Jackson", c("Year_Drafted","Overall_Pick")] <- c(2006,64)
QBStats[QBStats$Player == "Taylor Heinicke", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Taysom Hill", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Teddy Bridgewater", c("Year_Drafted","Overall_Pick")] <- c(2014,32)
QBStats[QBStats$Player == "Tee Martin", c("Year_Drafted","Overall_Pick")] <- c(2000,163)
QBStats[QBStats$Player == "Terrelle Pryor", c("Year_Drafted","Overall_Pick")] <- c(0,0) #mostly played WR in nfl
QBStats[QBStats$Player == "Thaddeus Lewis", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Tim Boyle", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Tim Couch", c("Year_Drafted","Overall_Pick")] <- c(1999,1)
QBStats[QBStats$Player == "Tim Hasselbeck", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Tim Rattay", c("Year_Drafted","Overall_Pick")] <- c(2000,212)
QBStats[QBStats$Player == "Tim Tebow", c("Year_Drafted","Overall_Pick")] <- c(2010,25)
QBStats[QBStats$Player == "TJ Yates", c("Year_Drafted","Overall_Pick")] <- c(2011,152)
QBStats[QBStats$Player == "Todd Bouman", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Todd Collins", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Todd Husak", c("Year_Drafted","Overall_Pick")] <- c(2000,202)
QBStats[QBStats$Player == "Todd Philcox", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Tom Brady", c("Year_Drafted","Overall_Pick")] <- c(2000,199)
QBStats[QBStats$Player == "Tom Brandstater", c("Year_Drafted","Overall_Pick")] <- c(2009,174)
QBStats[QBStats$Player == "Tom Savage", c("Year_Drafted","Overall_Pick")] <- c(2014,135)
QBStats[QBStats$Player == "Tommy Maddox", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Tony Banks", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Tony Graziani", c("Year_Drafted","Overall_Pick")] <- c(1997,204)
QBStats[QBStats$Player == "Tony Pike", c("Year_Drafted","Overall_Pick")] <- c(2010,204)
QBStats[QBStats$Player == "Tony Romo", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Trace McSorley", c("Year_Drafted","Overall_Pick")] <- c(2019,197)
QBStats[QBStats$Player == "Travis Brown", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Trent Dilfer", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Trent Edwards", c("Year_Drafted","Overall_Pick")] <- c(2007,92)
QBStats[QBStats$Player == "Trent Green", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Trevone Boykin", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Trevor Lawrence", c("Year_Drafted","Overall_Pick")] <- c(2021,1)
QBStats[QBStats$Player == "Trevor Siemian", c("Year_Drafted","Overall_Pick")] <- c(2015,250)
QBStats[QBStats$Player == "Trey Lance", c("Year_Drafted","Overall_Pick")] <- c(2021,3)
QBStats[QBStats$Player == "Troy Aikman", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Troy Smith", c("Year_Drafted","Overall_Pick")] <- c(2007,174)
QBStats[QBStats$Player == "Tua Tagovailoa", c("Year_Drafted","Overall_Pick")] <- c(2020,5)
QBStats[QBStats$Player == "Ty Detmer", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Tyler Bray", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Tyler Huntley", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Tyler Palko", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Tyler Thigpen", c("Year_Drafted","Overall_Pick")] <- c(2007,217)
QBStats[QBStats$Player == "Tyrod Taylor", c("Year_Drafted","Overall_Pick")] <- c(2011,180)
QBStats[QBStats$Player == "Vince Young", c("Year_Drafted","Overall_Pick")] <- c(2006,3)
QBStats[QBStats$Player == "Vinny Testaverde", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Wade Wilson", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Wally Richardson", c("Year_Drafted","Overall_Pick")] <- c(1997,234)
QBStats[QBStats$Player == "Warren Moon", c("Year_Drafted","Overall_Pick")] <- c(0,0)
QBStats[QBStats$Player == "Will Grier", c("Year_Drafted","Overall_Pick")] <- c(2019,100)
QBStats[QBStats$Player == "Zach Mettenberger", c("Year_Drafted","Overall_Pick")] <- c(2014,178)
QBStats[QBStats$Player == "Zach Wilson", c("Year_Drafted","Overall_Pick")] <- c(2021,2)


#Removing non 1997-2022 drafted qbs
QBStats <- QBStats[QBStats$Year_Drafted >= 1997, ]

#TO_DO MANUALLY FILL OUT SOME OF THE COLLEGE STATS 36 guys
PlayersMissing <- QBStats$Player[is.na(QBStats$Col_G)] 

QBStats[!is.na(QBStats$Player) & QBStats$Player == "Armanti Edwards", c("Col_G", "Col_Cmp", "Col_Att", "Col_Yds", "Col_TD", "Col_Int", 'Col_Rush_Att', 'Col_Rush_Yds', 'Col_Rush_TD')] <- c(51, 768, 1180, 10392, 74, 33, 755, 4361, 65)
QBStats[!is.na(QBStats$Player) & QBStats$Player == "Ben DiNucci", c("Col_G", "Col_Cmp", "Col_Att", "Col_Yds", "Col_TD", "Col_Int", 'Col_Rush_Att', 'Col_Rush_Yds', 'Col_Rush_TD')] <- c(29,479,687,5716,45,18,229,1002,16)
QBStats[!is.na(QBStats$Player) & QBStats$Player == "Cardale Jones", c("Col_G", "Col_Cmp", "Col_Att", "Col_Yds", "Col_TD", "Col_Int", 'Col_Rush_Att', 'Col_Rush_Yds', 'Col_Rush_TD')] <- c(23,166,269,2322,15,7,153,617,4)
QBStats[!is.na(QBStats$Player) & QBStats$Player == "Carson Wentz", c("Col_G", "Col_Cmp", "Col_Att", "Col_Yds", "Col_TD", "Col_Int", 'Col_Rush_Att', 'Col_Rush_Yds', 'Col_Rush_TD')] <- c(42,392,612,5115,45,14,216,1028,13)
QBStats[!is.na(QBStats$Player) & QBStats$Player == "Chris Miller", c("Col_G", "Col_Cmp", "Col_Att", "Col_Yds", "Col_TD", "Col_Int", 'Col_Rush_Att', 'Col_Rush_Yds', 'Col_Rush_TD')] <- c(36,560,1015,6681,42,39,180,160,7)
QBStats[!is.na(QBStats$Player) & QBStats$Player == "Craig Nall", c("Col_G", "Col_Cmp", "Col_Att", "Col_Yds", "Col_TD", "Col_Int", 'Col_Rush_Att', 'Col_Rush_Yds', 'Col_Rush_TD')] <- c(16,35,79,431,0,4,16,-65,0)
QBStats[!is.na(QBStats$Player) & QBStats$Player == "Drew Henson", c("Col_G", "Col_Cmp", "Col_Att", "Col_Yds", "Col_TD", "Col_Int", 'Col_Rush_Att', 'Col_Rush_Yds', 'Col_Rush_TD')] <- c(24,196,351,2631,22,7,60,74,4)
QBStats[!is.na(QBStats$Player) & QBStats$Player == "Easton Stick", c("Col_G", "Col_Cmp", "Col_Att", "Col_Yds", "Col_TD", "Col_Int", 'Col_Rush_Att', 'Col_Rush_Yds', 'Col_Rush_TD')] <- c(55,598,980,8693,88,28,427,2523,41)
QBStats[!is.na(QBStats$Player) & QBStats$Player == "Gardner Minshew II", c("Col_G", "Col_Cmp", "Col_Att", "Col_Yds", "Col_TD", "Col_Int", 'Col_Rush_Att', 'Col_Rush_Yds', 'Col_Rush_TD')] <- c(30,761,1168,8266,62,20,96,43,4)
QBStats[!is.na(QBStats$Player) & QBStats$Player == "Jimmy Garoppolo", c("Col_G", "Col_Cmp", "Col_Att", "Col_Yds", "Col_TD", "Col_Int", 'Col_Rush_Att', 'Col_Rush_Yds', 'Col_Rush_TD')] <- c(44,1009,1618,12835,116,51,250,-79,6)
QBStats[!is.na(QBStats$Player) & QBStats$Player == "John Skelton", c("Col_G", "Col_Cmp", "Col_Att", "Col_Yds", "Col_TD", "Col_Int", 'Col_Rush_Att', 'Col_Rush_Yds', 'Col_Rush_TD')] <- c(20,470,751,5758,39,17,126,214,7)
QBStats[!is.na(QBStats$Player) & QBStats$Player == "Kyle Lauletta", c("Col_G", "Col_Cmp", "Col_Att", "Col_Yds", "Col_TD", "Col_Int", 'Col_Rush_Att', 'Col_Rush_Yds', 'Col_Rush_TD')] <- c(36,682,1072,9381,66,31,177,186,10)
QBStats[!is.na(QBStats$Player) & QBStats$Player == "Matt Cassel", c("Col_G", "Col_Cmp", "Col_Att", "Col_Yds", "Col_TD", "Col_Int", 'Col_Rush_Att', 'Col_Rush_Yds', 'Col_Rush_TD')] <- c(33,20,33,192,0,1,11,32,0)
QBStats[!is.na(QBStats$Player) & QBStats$Player == "Michael Vick", c("Col_G", "Col_Cmp", "Col_Att", "Col_Yds", "Col_TD", "Col_Int", 'Col_Rush_Att', 'Col_Rush_Yds', 'Col_Rush_TD')] <- c(20,177,313,3074,20,11,212,1202,16)
QBStats[!is.na(QBStats$Player) & QBStats$Player == "Mike Cherry", c("Col_G", "Col_Cmp", "Col_Att", "Col_Yds", "Col_TD", "Col_Int", 'Col_Rush_Att', 'Col_Rush_Yds', 'Col_Rush_TD')] <- c(10,21,40,242,1,3,9,-9,0)
QBStats[!is.na(QBStats$Player) & QBStats$Player == "Mitchell Trubisky", c("Col_G", "Col_Cmp", "Col_Att", "Col_Yds", "Col_TD", "Col_Int", 'Col_Rush_Att', 'Col_Rush_Yds', 'Col_Rush_TD')] <- c(31,386,572,4762,41,10,120,439,8)
QBStats[!is.na(QBStats$Player) & QBStats$Player == "Randy Fasani", c("Col_G", "Col_Cmp", "Col_Att", "Col_Yds", "Col_TD", "Col_Int", 'Col_Rush_Att', 'Col_Rush_Yds', 'Col_Rush_TD')] <- c(36,188,369,2973,25,11,127,317,6)
QBStats[!is.na(QBStats$Player) & QBStats$Player == "Tyler Thigpen", c("Col_G", "Col_Cmp", "Col_Att", "Col_Yds", "Col_TD", "Col_Int", 'Col_Rush_Att', 'Col_Rush_Yds', 'Col_Rush_TD')] <- c(41,486,879,6598,53,25,345,1638,13)
QBStats[!is.na(QBStats$Player) & QBStats$Player == "AJ Feeley", c("Col_G", "Col_Cmp", "Col_Att", "Col_Yds", "Col_TD", "Col_Int", 'Col_Rush_Att', 'Col_Rush_Yds', 'Col_Rush_TD')] <- c(20,146,278,2133,15,6,37,0,1)
QBStats[!is.na(QBStats$Player) & QBStats$Player == "AJ McCarron", c("Col_G", "Col_Cmp", "Col_Att", "Col_Yds", "Col_TD", "Col_Int", 'Col_Rush_Att', 'Col_Rush_Yds', 'Col_Rush_TD')] <- c(53,686,1026,9019,77,15,119,-50,3)
QBStats[!is.na(QBStats$Player) & QBStats$Player == "BJ Daniels", c("Col_G", "Col_Cmp", "Col_Att", "Col_Yds", "Col_TD", "Col_Int", 'Col_Rush_Att', 'Col_Rush_Yds', 'Col_Rush_TD')] <- c(47,649,1132,8433,52,39,526,2068,25)
QBStats[!is.na(QBStats$Player) & QBStats$Player == "Brian St Pierre", c("Col_G", "Col_Cmp", "Col_Att", "Col_Yds", "Col_TD", "Col_Int", 'Col_Rush_Att', 'Col_Rush_Yds', 'Col_Rush_TD')] <- c(44,457,803,5837,48,32,172,419,2)
QBStats[!is.na(QBStats$Player) & QBStats$Player == "CJ Beathard", c("Col_G", "Col_Cmp", "Col_Att", "Col_Yds", "Col_TD", "Col_Int", 'Col_Rush_Att', 'Col_Rush_Yds', 'Col_Rush_TD')] <- c(40,454,782,5562,40,19,224,429,10)
QBStats[!is.na(QBStats$Player) & QBStats$Player == "EJ Manuel", c("Col_G", "Col_Cmp", "Col_Att", "Col_Yds", "Col_TD", "Col_Int", 'Col_Rush_Att', 'Col_Rush_Yds', 'Col_Rush_TD')] <- c(43,600,897,7741,47,28,298,827,11)
QBStats[!is.na(QBStats$Player) & QBStats$Player == "JP Losman", c("Col_G", "Col_Cmp", "Col_Att", "Col_Yds", "Col_TD", "Col_Int", 'Col_Rush_Att', 'Col_Rush_Yds', 'Col_Rush_TD')] <- c(38,570,987,6754,60,27,237,241,10)
QBStats[!is.na(QBStats$Player) & QBStats$Player == "Kevin OConnell", c("Col_G", "Col_Cmp", "Col_Att", "Col_Yds", "Col_TD", "Col_Int", 'Col_Rush_Att', 'Col_Rush_Yds', 'Col_Rush_TD')] <- c(39,664,1151,7689,46,34,395,1312,19)
QBStats[!is.na(QBStats$Player) & QBStats$Player == "TJ Yates", c("Col_G", "Col_Cmp", "Col_Att", "Col_Yds", "Col_TD", "Col_Int", 'Col_Rush_Att', 'Col_Rush_Yds', 'Col_Rush_TD')] <- c(45,795,1277,9377,58,46,220,-333,7)



#Do the advanced college stats and remove the mentioned above qbs
AddedQBs <- c("Armanti Edwards",'Ben DiNucci','Cardale Jones','Carson Wentz','Chris Miller',
              'Craig Nall','Drew Henson','Easton Stick','Gardner Minshew II','Jimmy Garoppolo','John Skelton',
              'Kyle Lauletta','Matt Cassel','Michael Vick','Mike Cherry','Mitchell Trubisky','Randy Fasani',
              'Tyler Thigpen','AJ Feeley','AJ McCarron','BJ Daniels','Brian St Pierre','CJ Beathard','EJ Manuel',
              'JP Losman','Kevin OConnell','TJ Yates')
QBStats <- QBStats %>%
  mutate(
    Col_Pct = ifelse(Player %in% AddedQBs, Col_Cmp/Col_Att, Col_Pct),
    `Col_Y/A` = ifelse(Player %in% AddedQBs, Col_Yds/Col_Att, `Col_Y/A`),
    `Col_AY/A` = ifelse(Player %in% AddedQBs,(Col_Yds+20*Col_TD-45*Col_Int)/Col_Att, `Col_AY/A`),
    Col_Rate = ifelse(Player %in% AddedQBs, (8.4*Col_Yds+330*Col_TD-200*Col_Int+100*Col_Cmp)/Col_Att, Col_Rate),
    Col_Rush_Avg = ifelse(Player %in% AddedQBs, Col_Rush_Yds/Col_Rush_Att, Col_Rush_Avg)
  )

#Removed: Chris Greisen , Joe Flacco, Josh Johnson, Keith Null, Ryan Fitzpatrick, Spergon Wynn, Tarvaris Jackson-- No college stats found. Jonathan Quinn -- Only 1 of 4 years found
ExcludedQBs <- c('Chris Greisen','Joe Flacco','Josh Johnson','Keith Null','Ryan Fitzpatrick','Spergon Wynn',
                 'Tarvaris Jackson','Jonathan Quinn','JT OSullivan')

QBStats <- QBStats %>%
  filter(!Player %in% ExcludedQBs)

```

*Add Combine Info to PFRStats*

```{r}
urls <- c(
  'https://www.fantasypros.com/nfl/stats/combine/?year=1997',
  'https://www.fantasypros.com/nfl/stats/combine/?year=1998',
  'https://www.fantasypros.com/nfl/stats/combine/?year=1999',
  'https://www.fantasypros.com/nfl/stats/combine/?year=2000',
  'https://www.fantasypros.com/nfl/stats/combine/?year=2001',
  'https://www.fantasypros.com/nfl/stats/combine/?year=2002',
  'https://www.fantasypros.com/nfl/stats/combine/?year=2003',
  'https://www.fantasypros.com/nfl/stats/combine/?year=2004',
  'https://www.fantasypros.com/nfl/stats/combine/?year=2005',
  'https://www.fantasypros.com/nfl/stats/combine/?year=2006',
  'https://www.fantasypros.com/nfl/stats/combine/?year=2007',
  'https://www.fantasypros.com/nfl/stats/combine/?year=2008',
  'https://www.fantasypros.com/nfl/stats/combine/?year=2009',
  'https://www.fantasypros.com/nfl/stats/combine/?year=2010',
  'https://www.fantasypros.com/nfl/stats/combine/?year=2011',
  'https://www.fantasypros.com/nfl/stats/combine/?year=2012',
  'https://www.fantasypros.com/nfl/stats/combine/?year=2013',
  'https://www.fantasypros.com/nfl/stats/combine/?year=2014',
  'https://www.fantasypros.com/nfl/stats/combine/?year=2015',
  'https://www.fantasypros.com/nfl/stats/combine/?year=2016',
  'https://www.fantasypros.com/nfl/stats/combine/?year=2017',
  'https://www.fantasypros.com/nfl/stats/combine/?year=2018',
  'https://www.fantasypros.com/nfl/stats/combine/?year=2019',
  'https://www.fantasypros.com/nfl/stats/combine/?year=2020',
  'https://www.fantasypros.com/nfl/stats/combine/?year=2021',
  'https://www.fantasypros.com/nfl/stats/combine/?year=2022'
)

# Initialize an empty list to store data frames
dataframes <- list()

# Loop through each URL
for (url in urls) {
  page <- read_html(url)
  table_selector <- "#main-container > div > div.main-content > div > div.mobile-table"
  table_node <- page %>% html_nodes(css = table_selector)
  table_data <- table_node %>% html_table()
  CombineData <- as.data.frame(table_data[[1]])
  
  # Add a column "Year" that contains the draft year extracted from the URL
  year <- sub(".*year=(\\d+)", "\\1", url)
  CombineData$Year <- year
  
  # Append the dataframe to the list
  dataframes <- append(dataframes, list(CombineData))
}

# Combine all dataframes into one
CombineData <- do.call(rbind, dataframes)

# Remove non-QBs
CombineData <- subset(CombineData, Position == "QB")

#Merge the Combine Data to QBStats (main dataframe)
QBStats <- merge(QBStats, CombineData, by="Player", all.x=TRUE)

#THERE ARE 48 QB'S WHO WEREN'T REGISTERED IN COMBINE. Seek out their combine-related stats?
sum(is.na(QBStats$Year))

# Remove rows with duplicate "Player" values
QBStats <- QBStats %>%
  distinct(Player, .keep_all = TRUE)


QBStats <- QBStats[-nrow(QBStats), ]
```
234 QBs

*Manually input final data collection things*
```{r}
# To start finishing touches of data collection, remove columns with a lot of missing vales (pretty much all combine data)

# Count the number of NA values in each column
na_counts <- colSums(is.na(QBStats))

QBStats <- QBStats[, !(colnames(QBStats) %in% c("40-Yard Dash", "Bench Press", "Vertical Jump", "Broad Jump","20-Yard Shuttle"))]

#Removed all Combine info, many quarterbacks didn't complete the exercises and it was also found inconclusive in original study too

# Create a blank column called "Overall_#"
QBStats <- QBStats %>%
  mutate(Overall_Pick = NA)

# Create a blank column called "Height"
QBStats <- QBStats %>%
  mutate(Height = NA)

# Create a blank column called Weight"
QBStats <- QBStats %>%
  mutate(Weight = NA)

#Manually Add Missing Years and Overall Pick #, Height (cm), Weight
# TO REMOVE UNDRAFTED : Anthony Brown, Ryan Griffin
QBStats[QBStats$Player == "Aaron Brooks", c("Overall_Pick","Height","Weight")] <- c(131,193,205)
QBStats[QBStats$Player == "Aaron Rodgers", c("Overall_Pick","Height","Weight")] <- c(24,188,223)
QBStats[QBStats$Player == "Akili Smith", c("Overall_Pick","Height","Weight")] <- c(3,190,220)
QBStats[QBStats$Player == "Alex Smith", c("Overall_Pick","Height","Weight")] <- c(1,193,213)
QBStats[QBStats$Player == "Andrew Luck", c("Overall_Pick","Height","Weight")] <- c(1,193,240)
QBStats[QBStats$Player == "Andy Dalton", c("Overall_Pick","Height","Weight")] <- c(35,188,220)
QBStats[QBStats$Player == "Armanti Edwards", c("Overall_Pick","Height","Weight")] <- c(89,180,191)
QBStats[QBStats$Player == "Bailey Zappe", c("Overall_Pick","Height","Weight")] <- c(137,185,215)
QBStats[QBStats$Player == "Baker Mayfield", c("Overall_Pick","Height","Weight")] <- c(1,185,215)
QBStats[QBStats$Player == "Ben DiNucci", c("Overall_Pick","Height","Weight")] <- c(231,188,215)
QBStats[QBStats$Player == "Ben Roethlisberger", c("Overall_Pick","Height","Weight")] <- c(11,196,240)
QBStats[QBStats$Player == "Blaine Gabbert", c("Overall_Pick","Height","Weight")] <- c(10,193,233)
QBStats[QBStats$Player == "Blake Bortles", c("Overall_Pick","Height","Weight")] <- c(3,196,236)
QBStats[QBStats$Player == "Bradlee Van Pelt", c("Overall_Pick","Height","Weight")] <- c(250,188,225)
QBStats[QBStats$Player == "Brady Quinn", c("Overall_Pick","Height","Weight")] <- c(22,193,232)
QBStats[QBStats$Player == "Brandon Allen", c("Overall_Pick","Height","Weight")] <- c(201,188,209)
QBStats[QBStats$Player == "Brandon Weeden", c("Overall_Pick","Height","Weight")] <- c(22,190,227)
QBStats[QBStats$Player == "Brett Hundley", c("Overall_Pick","Height","Weight")] <- c(147,190,226)
QBStats[QBStats$Player == "Brian Brohm", c("Overall_Pick","Height","Weight")] <- c(56,190,227)
QBStats[QBStats$Player == "Brian Griese", c("Overall_Pick","Height","Weight")] <- c(91,190,214)
QBStats[QBStats$Player == "Brock Huard", c("Overall_Pick","Height","Weight")] <- c(77,193,232)
QBStats[QBStats$Player == "Brock Osweiler", c("Overall_Pick","Height","Weight")] <- c(57,201,240)
QBStats[QBStats$Player == "Brock Purdy", c("Overall_Pick","Height","Weight")] <- c(262,185,220)
QBStats[QBStats$Player == "Brodie Croyle", c("Overall_Pick","Height","Weight")] <- c(85,188,206)
QBStats[QBStats$Player == "Brooks Bollinger", c("Overall_Pick","Height","Weight")] <- c(200,183,205)
QBStats[QBStats$Player == "Bruce Gradkowski", c("Overall_Pick","Height","Weight")] <- c(194,185,217)
QBStats[QBStats$Player == "Bryce Petty", c("Overall_Pick","Height","Weight")] <- c(103,190,226)
QBStats[QBStats$Player == "Byron Leftwich", c("Overall_Pick","Height","Weight")] <- c(7,196,250)
QBStats[QBStats$Player == "Cade McNown", c("Overall_Pick","Height","Weight")] <- c(12,185,208)
QBStats[QBStats$Player == "Cam Newton", c("Overall_Pick","Height","Weight")] <- c(1,196,245)
QBStats[QBStats$Player == "Cardale Jones", c("Overall_Pick","Height","Weight")] <- c(139,196,250)
QBStats[QBStats$Player == "Carson Palmer", c("Overall_Pick","Height","Weight")] <- c(1,196,235)
QBStats[QBStats$Player == "Carson Wentz", c("Overall_Pick","Height","Weight")] <- c(2,196,237)
QBStats[QBStats$Player == "Chad Henne", c("Overall_Pick","Height","Weight")] <- c(57,190,215)
QBStats[QBStats$Player == "Chad Pennington", c("Overall_Pick","Height","Weight")] <- c(18,190,230)
QBStats[QBStats$Player == "Charlie Batch", c("Overall_Pick","Height","Weight")] <- c(60,188,216)
QBStats[QBStats$Player == "Charlie Frye", c("Overall_Pick","Height","Weight")] <- c(67,193,220)
QBStats[QBStats$Player == "Charlie Whitehurst", c("Overall_Pick","Height","Weight")] <- c(81,193,226)
QBStats[QBStats$Player == "Chris Miller", c("Overall_Pick","Height","Weight")] <- c(13,188,212)
QBStats[QBStats$Player == "Chris Redman", c("Overall_Pick","Height","Weight")] <- c(75,190,223)
QBStats[QBStats$Player == "Chris Simms", c("Overall_Pick","Height","Weight")] <- c(97,193,230)
QBStats[QBStats$Player == "Chris Weinke", c("Overall_Pick","Height","Weight")] <- c(106,193,232)
QBStats[QBStats$Player == "Christian Ponder", c("Overall_Pick","Height","Weight")] <- c(12,188,222)
QBStats[QBStats$Player == "Cody Kessler", c("Overall_Pick","Height","Weight")] <- c(93,185,215)
QBStats[QBStats$Player == "Cody Pickett", c("Overall_Pick","Height","Weight")] <- c(217,190,227)
QBStats[QBStats$Player == "Colin Kaepernick", c("Overall_Pick","Height","Weight")] <- c(36,193,225)
QBStats[QBStats$Player == "Colt McCoy", c("Overall_Pick","Height","Weight")] <- c(85,185,212)
QBStats[QBStats$Player == "Connor Cook", c("Overall_Pick","Height","Weight")] <- c(100,193,215)
QBStats[QBStats$Player == "Craig Krenzel", c("Overall_Pick","Height","Weight")] <- c(148,193,225)
QBStats[QBStats$Player == "Craig Nall", c("Overall_Pick","Height","Weight")] <- c(164,190,230)
QBStats[QBStats$Player == "Curtis Painter", c("Overall_Pick","Height","Weight")] <- c(201,193,230)
QBStats[QBStats$Player == "Dak Prescott", c("Overall_Pick","Height","Weight")] <- c(135,188,238)
QBStats[QBStats$Player == "Dan Orlovsky", c("Overall_Pick","Height","Weight")] <- c(145,196,215)
QBStats[QBStats$Player == "Daniel Jones", c("Overall_Pick","Height","Weight")] <- c(6,196,230)
QBStats[QBStats$Player == "Danny Wuerffel", c("Overall_Pick","Height","Weight")] <- c(99,185,212)
QBStats[QBStats$Player == "Daunte Culpepper", c("Overall_Pick","Height","Weight")] <- c(11,193,260)
QBStats[QBStats$Player == "Dave Ragone", c("Overall_Pick","Height","Weight")] <- c(88,193,245)
QBStats[QBStats$Player == "David Carr", c("Overall_Pick","Height","Weight")] <- c(1,190,212)
QBStats[QBStats$Player == "David Fales", c("Overall_Pick","Height","Weight")] <- c(183,188,210)
QBStats[QBStats$Player == "David Garrard", c("Overall_Pick","Height","Weight")] <- c(108,185,235)
QBStats[QBStats$Player == "Davis Mills", c("Overall_Pick","Height","Weight")] <- c(67,193,225)
QBStats[QBStats$Player == "Davis Webb", c("Overall_Pick","Height","Weight")] <- c(87,196,225)
QBStats[QBStats$Player == "Dennis Dixon", c("Overall_Pick","Height","Weight")] <- c(156,190,195)
QBStats[QBStats$Player == "Derek Anderson", c("Overall_Pick","Height","Weight")] <- c(213,198,235)
QBStats[QBStats$Player == "Derek Carr", c("Overall_Pick","Height","Weight")] <- c(36,190,215)
QBStats[QBStats$Player == "Deshaun Watson", c("Overall_Pick","Height","Weight")] <- c(12,190,223)
QBStats[QBStats$Player == "DeShone Kizer", c("Overall_Pick","Height","Weight")] <- c(52,193,235)
QBStats[QBStats$Player == "Desmond Ridder", c("Overall_Pick","Height","Weight")] <- c(74,190,207)
QBStats[QBStats$Player == "Donovan McNabb", c("Overall_Pick","Height","Weight")] <- c(2,188,240)
QBStats[QBStats$Player == "Drew Brees", c("Overall_Pick","Height","Weight")] <- c(32,183,209)
QBStats[QBStats$Player == "Drew Henson", c("Overall_Pick","Height","Weight")] <- c(192,193,220)
QBStats[QBStats$Player == "Drew Lock", c("Overall_Pick","Height","Weight")] <- c(42,193,228)
QBStats[QBStats$Player == "Drew Stanton", c("Overall_Pick","Height","Weight")] <- c(43,190,226)
QBStats[QBStats$Player == "Dwayne Haskins", c("Overall_Pick","Height","Weight")] <- c(15,193,230)
QBStats[QBStats$Player == "Easton Stick", c("Overall_Pick","Height","Weight")] <- c(166,185,224)
QBStats[QBStats$Player == "Eli Manning", c("Overall_Pick","Height","Weight")] <- c(1,196,220)
QBStats[QBStats$Player == "Gardner Minshew II", c("Overall_Pick","Height","Weight")] <- c(178,185,225)
QBStats[QBStats$Player == "Garrett Gilbert", c("Overall_Pick","Height","Weight")] <- c(214,193,230)
QBStats[QBStats$Player == "Geno Smith", c("Overall_Pick","Height","Weight")] <- c(39,190,221)
QBStats[QBStats$Player == "Gibran Hamdan", c("Overall_Pick","Height","Weight")] <- c(232,198,240)
QBStats[QBStats$Player == "Greg McElroy", c("Overall_Pick","Height","Weight")] <- c(208,188,222)
QBStats[QBStats$Player == "Ian Book", c("Overall_Pick","Height","Weight")] <- c(133,183,206)
QBStats[QBStats$Player == "Jacob Eason", c("Overall_Pick","Height","Weight")] <- c(122,198,231)
QBStats[QBStats$Player == "Jacoby Brissett", c("Overall_Pick","Height","Weight")] <- c(91,193,235)
QBStats[QBStats$Player == "Jake Fromm", c("Overall_Pick","Height","Weight")] <- c(167,188,215)
QBStats[QBStats$Player == "Jake Locker", c("Overall_Pick","Height","Weight")] <- c(8,188,228)
QBStats[QBStats$Player == "Jake Luton", c("Overall_Pick","Height","Weight")] <- c(189,198,224)
QBStats[QBStats$Player == "Jake Plummer", c("Overall_Pick","Height","Weight")] <- c(42,188,212)
QBStats[QBStats$Player == "Jake Rudock", c("Overall_Pick","Height","Weight")] <- c(191,190,212)
QBStats[QBStats$Player == "Jalen Hurts", c("Overall_Pick","Height","Weight")] <- c(53,185,223)
QBStats[QBStats$Player == "Jameis Winston", c("Overall_Pick","Height","Weight")] <- c(1,193,231)
QBStats[QBStats$Player == "Jared Goff", c("Overall_Pick","Height","Weight")] <- c(1,193,217)
QBStats[QBStats$Player == "Jarious Jackson", c("Overall_Pick","Height","Weight")] <- c(214,183,228)
QBStats[QBStats$Player == "Jarrett Stidham", c("Overall_Pick","Height","Weight")] <- c(133,190,215)
QBStats[QBStats$Player == "Jason Campbell", c("Overall_Pick","Height","Weight")] <- c(25,196,235)
QBStats[QBStats$Player == "Jay Cutler", c("Overall_Pick","Height","Weight")] <- c(11,190,231)
QBStats[QBStats$Player == "Jeff Driskel", c("Overall_Pick","Height","Weight")] <- c(207,193,235)
QBStats[QBStats$Player == "Jesse Palmer", c("Overall_Pick","Height","Weight")] <- c(125,188,225)
QBStats[QBStats$Player == "Jim Druckenmiller", c("Overall_Pick","Height","Weight")] <- c(26,193,241)
QBStats[QBStats$Player == "Jim Sorgi", c("Overall_Pick","Height","Weight")] <- c(193,196,196)
QBStats[QBStats$Player == "Jimmy Clausen", c("Overall_Pick","Height","Weight")] <- c(48,190,217)
QBStats[QBStats$Player == "Jimmy Garoppolo", c("Overall_Pick","Height","Weight")] <- c(62,188,225)
QBStats[QBStats$Player == "Joe Burrow", c("Overall_Pick","Height","Weight")] <- c(1,193,215)
QBStats[QBStats$Player == "Joe Germaine", c("Overall_Pick","Height","Weight")] <- c(101,183,202)
QBStats[QBStats$Player == "Joe Webb", c("Overall_Pick","Height","Weight")] <- c(199,193,231)
QBStats[QBStats$Player == "Joey Harrington", c("Overall_Pick","Height","Weight")] <- c(3,193,220)
QBStats[QBStats$Player == "John Beck", c("Overall_Pick","Height","Weight")] <- c(40,188,215)
QBStats[QBStats$Player == "John Navarre", c("Overall_Pick","Height","Weight")] <- c(202,198,250)
QBStats[QBStats$Player == "John Skelton", c("Overall_Pick","Height","Weight")] <- c(155,196,244)
QBStats[QBStats$Player == "Johnny Manziel", c("Overall_Pick","Height","Weight")] <- c(22,183,207)
QBStats[QBStats$Player == "Jordan Love", c("Overall_Pick","Height","Weight")] <- c(26,193,219)
QBStats[QBStats$Player == "Jordan Palmer", c("Overall_Pick","Height","Weight")] <- c(205,196,232)
QBStats[QBStats$Player == "Josh Allen", c("Overall_Pick","Height","Weight")] <- c(7,196,237)
QBStats[QBStats$Player == "Josh Freeman", c("Overall_Pick","Height","Weight")] <- c(17,198,240)
QBStats[QBStats$Player == "Josh McCown", c("Overall_Pick","Height","Weight")] <- c(81,193,218)
QBStats[QBStats$Player == "Josh Rosen", c("Overall_Pick","Height","Weight")] <- c(10,193,226)
QBStats[QBStats$Player == "Joshua Dobbs", c("Overall_Pick","Height","Weight")] <- c(135,190,216)
QBStats[QBStats$Player == "Justin Fields", c("Overall_Pick","Height","Weight")] <- c(11,190,228)
QBStats[QBStats$Player == "Justin Herbert", c("Overall_Pick","Height","Weight")] <- c(6,198,236)
QBStats[QBStats$Player == "Kellen Clemens", c("Overall_Pick","Height","Weight")] <- c(49,188,220)
QBStats[QBStats$Player == "Kellen Mond", c("Overall_Pick","Height","Weight")] <- c(66,190,212)
QBStats[QBStats$Player == "Ken Dorsey", c("Overall_Pick","Height","Weight")] <- c(241,193,220)
QBStats[QBStats$Player == "Kenny Pickett", c("Overall_Pick","Height","Weight")] <- c(20,190,220)
QBStats[QBStats$Player == "Kevin Hogan", c("Overall_Pick","Height","Weight")] <- c(162,190,218)
QBStats[QBStats$Player == "Kevin Kolb", c("Overall_Pick","Height","Weight")] <- c(36,190,218)
QBStats[QBStats$Player == "Kirk Cousins", c("Overall_Pick","Height","Weight")] <- c(102,190,205)
QBStats[QBStats$Player == "Kliff Kingsbury", c("Overall_Pick","Height","Weight")] <- c(201,190,220)
QBStats[QBStats$Player == "Koy Detmer", c("Overall_Pick","Height","Weight")] <- c(207,185,195)
QBStats[QBStats$Player == "Kurt Kittner", c("Overall_Pick","Height","Weight")] <- c(158,188,221)
QBStats[QBStats$Player == "Kyle Boller", c("Overall_Pick","Height","Weight")] <- c(19,190,220)
QBStats[QBStats$Player == "Kyle Lauletta", c("Overall_Pick","Height","Weight")] <- c(108,188,222)
QBStats[QBStats$Player == "Kyle Orton", c("Overall_Pick","Height","Weight")] <- c(106,193,228)
QBStats[QBStats$Player == "Kyle Trask", c("Overall_Pick","Height","Weight")] <- c(64,196,236)
QBStats[QBStats$Player == "Kyler Murray", c("Overall_Pick","Height","Weight")] <- c(1,178,207)
QBStats[QBStats$Player == "Lamar Jackson", c("Overall_Pick","Height","Weight")] <- c(32,188,215)
QBStats[QBStats$Player == "Landry Jones", c("Overall_Pick","Height","Weight")] <- c(115,193,225)
QBStats[QBStats$Player == "Levi Brown", c("Overall_Pick","Height","Weight")] <- c(209,190,229)
QBStats[QBStats$Player == "Logan Woodside", c("Overall_Pick","Height","Weight")] <- c(249,188,201)
QBStats[QBStats$Player == "Luke Falk", c("Overall_Pick","Height","Weight")] <- c(199,193,215)
QBStats[QBStats$Player == "Luke McCown", c("Overall_Pick","Height","Weight")] <- c(106,193,217)
QBStats[QBStats$Player == "Mac Jones", c("Overall_Pick","Height","Weight")] <- c(15,190,220)
QBStats[QBStats$Player == "Malik Willis", c("Overall_Pick","Height","Weight")] <- c(86,185,219)
QBStats[QBStats$Player == "Marc Bulger", c("Overall_Pick","Height","Weight")] <- c(168,190,208)
QBStats[QBStats$Player == "Marcus Mariota", c("Overall_Pick","Height","Weight")] <- c(2,193,222)
QBStats[QBStats$Player == "Mark Sanchez", c("Overall_Pick","Height","Weight")] <- c(5,188,232)
QBStats[QBStats$Player == "Marques Tuiasosopo", c("Overall_Pick","Height","Weight")] <- c(59,185,220)
QBStats[QBStats$Player == "Mason Rudolph", c("Overall_Pick","Height","Weight")] <- c(76,196,235)
QBStats[QBStats$Player == "Matt Barkley", c("Overall_Pick","Height","Weight")] <- c(98,188,234)
QBStats[QBStats$Player == "Matt Cassel", c("Overall_Pick","Height","Weight")] <- c(230,193,225)
QBStats[QBStats$Player == "Matt Flynn", c("Overall_Pick","Height","Weight")] <- c(209,188,228)
QBStats[QBStats$Player == "Matt Hasselbeck", c("Overall_Pick","Height","Weight")] <- c(187,193,235)
QBStats[QBStats$Player == "Matt Leinart", c("Overall_Pick","Height","Weight")] <- c(10,196,225)
QBStats[QBStats$Player == "Matt Mauck", c("Overall_Pick","Height","Weight")] <- c(225,185,213)
QBStats[QBStats$Player == "Matt Ryan", c("Overall_Pick","Height","Weight")] <- c(3,193,217)
QBStats[QBStats$Player == "Matt Schaub", c("Overall_Pick","Height","Weight")] <- c(90,198,245)
QBStats[QBStats$Player == "Matthew Stafford", c("Overall_Pick","Height","Weight")] <- c(1,190,220)
QBStats[QBStats$Player == "Michael Bishop", c("Overall_Pick","Height","Weight")] <- c(227,188,215)
QBStats[QBStats$Player == "Michael Vick", c("Overall_Pick","Height","Weight")] <- c(1,183,210)
QBStats[QBStats$Player == "Mike Cherry", c("Overall_Pick","Height","Weight")] <- c(171,190,226)
QBStats[QBStats$Player == "Mike Glennon", c("Overall_Pick","Height","Weight")] <- c(73,201,225)
QBStats[QBStats$Player == "Mike Kafka", c("Overall_Pick","Height","Weight")] <- c(122,190,216)
QBStats[QBStats$Player == "Mike McMahon", c("Overall_Pick","Height","Weight")] <- c(149,188,208)
QBStats[QBStats$Player == "Mike White", c("Overall_Pick","Height","Weight")] <- c(171,196,216)
QBStats[QBStats$Player == "Mitchell Trubisky", c("Overall_Pick","Height","Weight")] <- c(2,188,220)
QBStats[QBStats$Player == "Moses Moreno", c("Overall_Pick","Height","Weight")] <- c(232,185,205)
QBStats[QBStats$Player == "Nate Sudfeld", c("Overall_Pick","Height","Weight")] <- c(187,198,230)
QBStats[QBStats$Player == "Nathan Peterman", c("Overall_Pick","Height","Weight")] <- c(171,188,225)
QBStats[QBStats$Player == "Nick Foles", c("Overall_Pick","Height","Weight")] <- c(88,198,262)
QBStats[QBStats$Player == "Patrick Mahomes", c("Overall_Pick","Height","Weight")] <- c(10,188,225)
QBStats[QBStats$Player == "Patrick Ramsey", c("Overall_Pick","Height","Weight")] <- c(32,188,225)
QBStats[QBStats$Player == "Paxton Lynch", c("Overall_Pick","Height","Weight")] <- c(26,201,244)
QBStats[QBStats$Player == "Peyton Manning", c("Overall_Pick","Height","Weight")] <- c(1,196,230)
QBStats[QBStats$Player == "Philip Rivers", c("Overall_Pick","Height","Weight")] <- c(4,196,228)
QBStats[QBStats$Player == "Quincy Carter", c("Overall_Pick","Height","Weight")] <- c(53,188,213)
QBStats[QBStats$Player == "Randy Fasani", c("Overall_Pick","Height","Weight")] <- c(137,190,234)
QBStats[QBStats$Player == "Rex Grossman", c("Overall_Pick","Height","Weight")] <- c(22,185,225)
QBStats[QBStats$Player == "Robert Griffin III", c("Overall_Pick","Height","Weight")] <- c(2,188,213)
QBStats[QBStats$Player == "Rohan Davey", c("Overall_Pick","Height","Weight")] <- c(117,188,245)
QBStats[QBStats$Player == "Russell Wilson", c("Overall_Pick","Height","Weight")] <- c(75,180,215)
QBStats[QBStats$Player == "Rusty Smith", c("Overall_Pick","Height","Weight")] <- c(176,196,212)
QBStats[QBStats$Player == "Ryan Finley", c("Overall_Pick","Height","Weight")] <- c(104,193,207)
QBStats[QBStats$Player == "Ryan Leaf", c("Overall_Pick","Height","Weight")] <- c(2,196,245)
QBStats[QBStats$Player == "Ryan Lindley", c("Overall_Pick","Height","Weight")] <- c(185,190,229)
QBStats[QBStats$Player == "Ryan Mallett", c("Overall_Pick","Height","Weight")] <- c(74,198,240)
QBStats[QBStats$Player == "Ryan Nassib", c("Overall_Pick","Height","Weight")] <- c(110,188,227)
QBStats[QBStats$Player == "Ryan Tannehill", c("Overall_Pick","Height","Weight")] <- c(8,193,217)
QBStats[QBStats$Player == "Sage Rosenfels", c("Overall_Pick","Height","Weight")] <- c(109,193,222)
QBStats[QBStats$Player == "Sam Bradford", c("Overall_Pick","Height","Weight")] <- c(1,193,224)
QBStats[QBStats$Player == "Sam Darnold", c("Overall_Pick","Height","Weight")] <- c(3,190,225)
QBStats[QBStats$Player == "Sam Ehlinger", c("Overall_Pick","Height","Weight")] <- c(218,188,225)
QBStats[QBStats$Player == "Sam Howell", c("Overall_Pick","Height","Weight")] <- c(144,185,220)
QBStats[QBStats$Player == "Scott Covington", c("Overall_Pick","Height","Weight")] <- c(245,188,217)
QBStats[QBStats$Player == "Sean Mannion", c("Overall_Pick","Height","Weight")] <- c(89,198,230)
QBStats[QBStats$Player == "Sean Renfree", c("Overall_Pick","Height","Weight")] <- c(249,190,219)
QBStats[QBStats$Player == "Seneca Wallace", c("Overall_Pick","Height","Weight")] <- c(110,180,205)
QBStats[QBStats$Player == "Shaun King", c("Overall_Pick","Height","Weight")] <- c(50,185,228)
QBStats[QBStats$Player == "Skylar Thompson", c("Overall_Pick","Height","Weight")] <- c(247,188,219)
QBStats[QBStats$Player == "Stephen McGee", c("Overall_Pick","Height","Weight")] <- c(101,188,223)
QBStats[QBStats$Player == "Teddy Bridgewater", c("Overall_Pick","Height","Weight")] <- c(32,188,212)
QBStats[QBStats$Player == "Tee Martin", c("Overall_Pick","Height","Weight")] <- c(163,188,225)
QBStats[QBStats$Player == "Tim Couch", c("Overall_Pick","Height","Weight")] <- c(1,193,220)
QBStats[QBStats$Player == "Tim Rattay", c("Overall_Pick","Height","Weight")] <- c(212,183,200)
QBStats[QBStats$Player == "Tim Tebow", c("Overall_Pick","Height","Weight")] <- c(25,188,236)
QBStats[QBStats$Player == "Todd Husak", c("Overall_Pick","Height","Weight")] <- c(202,190,216)
QBStats[QBStats$Player == "Tom Brady", c("Overall_Pick","Height","Weight")] <- c(199,193,225)
QBStats[QBStats$Player == "Tom Brandstater", c("Overall_Pick","Height","Weight")] <- c(174,196,215)
QBStats[QBStats$Player == "Tom Savage", c("Overall_Pick","Height","Weight")] <- c(135,193,230)
QBStats[QBStats$Player == "Tony Graziani", c("Overall_Pick","Height","Weight")] <- c(204,188,210)
QBStats[QBStats$Player == "Tony Pike", c("Overall_Pick","Height","Weight")] <- c(204,196,212)
QBStats[QBStats$Player == "Trace McSorley", c("Overall_Pick","Height","Weight")] <- c(197,183,202)
QBStats[QBStats$Player == "Trent Edwards", c("Overall_Pick","Height","Weight")] <- c(92,193,231)
QBStats[QBStats$Player == "Trevor Lawrence", c("Overall_Pick","Height","Weight")] <- c(1,198,220)
QBStats[QBStats$Player == "Trevor Siemian", c("Overall_Pick","Height","Weight")] <- c(250,190,220)
QBStats[QBStats$Player == "Trey Lance", c("Overall_Pick","Height","Weight")] <- c(3,193,226)
QBStats[QBStats$Player == "Troy Smith", c("Overall_Pick","Height","Weight")] <- c(174,183,225)
QBStats[QBStats$Player == "Tua Tagovailoa", c("Overall_Pick","Height","Weight")] <- c(5,185,227)
QBStats[QBStats$Player == "Tyler Thigpen", c("Overall_Pick","Height","Weight")] <- c(217,190,235)
QBStats[QBStats$Player == "Tyrod Taylor", c("Overall_Pick","Height","Weight")] <- c(180,185,217)
QBStats[QBStats$Player == "Vince Young", c("Overall_Pick","Height","Weight")] <- c(3,196,232)
QBStats[QBStats$Player == "Wally Richardson", c("Overall_Pick","Height","Weight")] <- c(234,193,225)
QBStats[QBStats$Player == "Will Grier", c("Overall_Pick","Height","Weight")] <- c(100,185,220)
QBStats[QBStats$Player == "Zach Mettenberger", c("Overall_Pick","Height","Weight")] <- c(178,196,224)
QBStats[QBStats$Player == "Zach Wilson", c("Overall_Pick","Height","Weight")] <- c(2,188,214)
QBStats[QBStats$Player == "Andrew Walter", c("Overall_Pick","Height","Weight")] <- c(69,198,230)
QBStats[QBStats$Player == "AJ Feeley", c("Overall_Pick","Height","Weight")] <- c(155,190,220)
QBStats[QBStats$Player == "AJ McCarron", c("Overall_Pick","Height","Weight")] <- c(164,190,220)
QBStats[QBStats$Player == "BJ Daniels", c("Overall_Pick","Height","Weight")] <- c(237,180,217)
QBStats[QBStats$Player == "Brian St Pierre", c("Overall_Pick","Height","Weight")] <- c(163,190,224)
QBStats[QBStats$Player == "CJ Beathard", c("Overall_Pick","Height","Weight")] <- c(104,188,215)
QBStats[QBStats$Player == "EJ Manuel", c("Overall_Pick","Height","Weight")] <- c(16,193,237)
QBStats[QBStats$Player == "JaMarcus Russell", c("Overall_Pick","Height","Weight")] <- c(1,198,265)
QBStats[QBStats$Player == "JP Losman", c("Overall_Pick","Height","Weight")] <- c(22,188,217)
QBStats[QBStats$Player == "Kevin OConnell", c("Overall_Pick","Height","Weight")] <- c(94,196,225)
QBStats[QBStats$Player == "TJ Yates", c("Overall_Pick","Height","Weight")] <- c(152,193,215)


#Removed undrafted ##224 QBS Now
QBStats <- QBStats[!(QBStats$Player %in% c("Ryan Griffin", "Anthony Brown")), ]

#NET POINTS #Missing Years #Fill position with qb
QBStats <- QBStats %>%
  mutate(Net_Points = 0.08 * (Rush_Yds + Yds) - 0.21 * (Att + Rush_Att + Sk) - 2.7*Int - 2.9*Rush_Fumbles)

#Round to Net_Points to nearest integer 
QBStats$Net_Points <- round(QBStats$Net_Points)
QBStats$Net_Points <- as.integer(QBStats$Net_Points)



QBStats <- QBStats %>%
  mutate(Position = "QB")

#Manually enter the NA'ed Years Drafted
QBStats[QBStats$Player == "Andrew Walter", "Year"] <- 2005
QBStats[QBStats$Player == "Ben DiNucci", "Year"] <- 2020
QBStats[QBStats$Player == "Brian Griese", "Year"] <- 1998
QBStats[QBStats$Player == "Brooks Bollinger", "Year"] <- 2003
QBStats <- subset(QBStats, Player != "Chris Miller")
QBStats[QBStats$Player == "Chris Weinke", "Year"] <- 2001
QBStats[QBStats$Player == "Craig Nall", "Year"] <- 2002
QBStats[QBStats$Player == "Davis Mills", "Year"] <- 2021
QBStats[QBStats$Player == "Dennis Dixon", "Year"] <- 2008
QBStats[QBStats$Player == "Drew Henson", "Year"] <- 2003
QBStats[QBStats$Player == "Gardner Minshew II", "Year"] <- 2019
QBStats[QBStats$Player == "Garrett Gilbert", "Year"] <- 2014
QBStats[QBStats$Player == "Gibran Hamdan", "Year"] <- 2003
QBStats[QBStats$Player == "Jake Luton", "Year"] <- 2020
QBStats[QBStats$Player == "Jake Rudock", "Year"] <- 2016
QBStats[QBStats$Player == "Jim Druckenmiller", "Year"] <- 1997
QBStats[QBStats$Player == "Jim Sorgi", "Year"] <- 2004
QBStats[QBStats$Player == "Joe Burrow", "Year"] <- 2020
QBStats[QBStats$Player == "Joe Webb", "Year"] <- 2010
QBStats[QBStats$Player == "Ken Dorsey", "Year"] <- 2003
QBStats[QBStats$Player == "Kyler Murray", "Year"] <- 2019
QBStats[QBStats$Player == "Lamar Jackson", "Year"] <- 2018
QBStats[QBStats$Player == "Luke Falk", "Year"] <- 2018
QBStats[QBStats$Player == "Mac Jones", "Year"] <- 2021
QBStats[QBStats$Player == "Malik Willis", "Year"] <- 2022
QBStats[QBStats$Player == "Matt Cassel", "Year"] <- 2005
QBStats[QBStats$Player == "Matt Hasselbeck", "Year"] <- 1998
QBStats[QBStats$Player == "Matt Mauck", "Year"] <- 2004
QBStats[QBStats$Player == "Moses Moreno", "Year"] <- 1998
QBStats[QBStats$Player == "Nate Sudfeld", "Year"] <- 2016
QBStats[QBStats$Player == "Peyton Manning", "Year"] <- 1998
QBStats[QBStats$Player == "Robert Griffin III", "Year"] <- 2012
QBStats[QBStats$Player == "Rusty Smith", "Year"] <- 2010
QBStats[QBStats$Player == "Ryan Leaf", "Year"] <- 1998
QBStats[QBStats$Player == "Sam Howell", "Year"] <- 2022
QBStats[QBStats$Player == "Sean Renfree", "Year"] <- 2013
QBStats[QBStats$Player == "Teddy Bridgewater", "Year"] <- 2014
QBStats[QBStats$Player == "Tony Graziani", "Year"] <- 1997
QBStats[QBStats$Player == "Trevor Lawrence", "Year"] <- 2021
QBStats[QBStats$Player == "Trey Lance", "Year"] <- 2021
QBStats[QBStats$Player == "Troy Smith", "Year"] <- 2007
QBStats[QBStats$Player == "Tua Tagovailoa", "Year"] <- 2020
QBStats[QBStats$Player == "Tyler Thigpen", "Year"] <- 2007
QBStats[QBStats$Player == "Zach Mettenberger", "Year"] <- 2014
QBStats[QBStats$Player == "Zach Wilson", "Year"] <- 2021
QBStats[QBStats$Player == "Armanti Edwards", "Year"] <- 2010
QBStats[QBStats$Player == "AJ Feeley", "Year"] <- 2001
QBStats[QBStats$Player == "AJ McCarron", "Year"] <- 2014
QBStats[QBStats$Player == "BJ Daniels", "Year"] <- 2013
QBStats[QBStats$Player == "Brian St Pierre", "Year"] <- 2003
QBStats[QBStats$Player == "CJ Beathard", "Year"] <- 2017
QBStats[QBStats$Player == "EJ Manuel", "Year"] <- 2013
QBStats[QBStats$Player == "JP Losman", "Year"] <- 2004
QBStats[QBStats$Player == "Kevin OConnell", "Year"] <- 2008
QBStats[QBStats$Player == "TJ Yates", "Year"] <- 2011


#Create indicator variable of whether or not the player was drafted in first round
#1=NOT first round (drafted rounds 2-7), 0=FIRST round. Then subset. 

library(dplyr)

QBStats <- QBStats %>%
  mutate(First_Round = case_when(
    (Year == 1997 & Overall_Pick <= 30) |
    (Year == 1998 & Overall_Pick <= 30) |
    (Year == 1999 & Overall_Pick <= 31) |
    (Year == 2000 & Overall_Pick <= 31) |
    (Year == 2001 & Overall_Pick <= 31) |
    (Year == 2001 & Overall_Pick <= 31) |
    (Year == 2002 & Overall_Pick <= 32) |
    (Year == 2003 & Overall_Pick <= 32) |
    (Year == 2004 & Overall_Pick <= 32) |
    (Year == 2005 & Overall_Pick <= 32) |
    (Year == 2006 & Overall_Pick <= 32) |
    (Year == 2007 & Overall_Pick <= 32) |
    (Year == 2008 & Overall_Pick <= 31) |
    (Year == 2009 & Overall_Pick <= 32) |
    (Year == 2010 & Overall_Pick <= 32) |
    (Year == 2011 & Overall_Pick <= 32) |
    (Year == 2012 & Overall_Pick <= 32) |
    (Year == 2013 & Overall_Pick <= 32) |
    (Year == 2014 & Overall_Pick <= 32) |
    (Year == 2015 & Overall_Pick <= 32) |
    (Year == 2016 & Overall_Pick <= 31) |
    (Year == 2017 & Overall_Pick <= 32) |
    (Year == 2018 & Overall_Pick <= 32) |
    (Year == 2019 & Overall_Pick <= 32) |
    (Year == 2020 & Overall_Pick <= 32) |
    (Year == 2021 & Overall_Pick <= 32) |
    (Year == 2022 & Overall_Pick <= 32) ~ 0,
    TRUE ~ 1  # Indicates not selected in the first round for other cases
  ))



```

**EDA**

```{r}

#Making Games Played Binary Variables (K>_1, K >_16, K>_48)
QBStats$G1 <- ifelse(QBStats$G >= 1, 1, 0)
QBStats$G16 <- ifelse(QBStats$G >= 16, 1, 0)
QBStats$G48 <- ifelse(QBStats$G >= 48, 1, 0)

#In the study, they set net points with less than absolute value of 10 to 0
hist(QBStats$Net_Points, xlab='Net Points', ylab='Number of Players',main='Histogram of Net Points')
QBStats <- QBStats %>%
  mutate(Net_Points = ifelse(Net_Points < 10, 0, Net_Points))
hist(QBStats$Net_Points)

summary(QBStats)
QBStats$Year <- as.numeric(QBStats$Year)

hist(QBStats$Overall_Pick)
hist(log(QBStats$Overall_Pick))

#hist(QBStats$G1)
hist(QBStats$G16)
hist(QBStats$G48)


# Create a plot of games played by whether or not first round pick
ggplot(QBStats, aes(x = Year, y = G)) +
  geom_point() +  # Use box plots for visualization
  labs(
    title = "Games Played by Draft Round",
    x = "First Round?",
    y = "Games Played"
  )

hist(QBStats$G)

# Calculate Pearson Chi2 dispersion statistic
chisq_result <- chisq.test(QBStats$G)
dispersion_statistic <- chisq_result$statistic

##Overdispersion Check for Games Played
#Deviance/Residual Deviance

install.packages("lmtest")  # Install the lmtest package
library(lmtest)             # Load the lmtest package

nb_model <- glm.nb(G ~ Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD + Height + Weight+ Year +log(Overall_Pick) , data = QBStats)
#summary(nb_model)  # Get the residual deviance
#Residual deviance of 260.86 on 222 degrees freedom
260.86/222 #Greater than 1.10, suggests overdispersion, thus negative binomial is needed

#Pearson Residuals
pearson_residuals <- residuals(nb_model, type = "pearson")
pearson_residuals #Appear fine? 

#Plotting Methods
plot(nb_model, which = 1)  # Pearson residuals vs. fitted values
plot(nb_model, which = 3)  # Deviance residuals vs. fitted values


#Overdispersion test
poisson_model <- glm(G ~ Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD + Height + Weight+ Year +log(Overall_Pick) , data = QBStats, family = poisson)
lr_test <- lrtest(poisson_model, nb_model) #Confirms the negative binomial is better p-value: 2.2e-16



```

*Modelling*

```{r}
#AICc model evaluator function
AICc <- function(model){
k <- length(coef(model))
n <- nobs(model)
return(AIC(model) + 2 * (k + 1) * (k + 2) / (n - k - 2))
}


###With Pick###
##All Games Played Model  *Negative Binomial*
gamesplayed_model_withpick <- glm.nb(G ~ Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD + Height + Weight+ Year +log(Overall_Pick) , data = QBStats)
# Get the summary of the regression model
summary_model <- summary(gamesplayed_model_withpick)

# Extract the coefficients (estimates) and standard errors
coefficients <- coef(summary_model)

# Calculate the percent increase in the mean for each predictor
percent_increase <- exp(coefficients[, "Estimate"]) - 1  # Use exp to transform from log scale
standard_errors <- coefficients[, "Std. Error"]

# Calculate the confidence intervals
confidence_intervals <- data.frame(
  Lower_CI = exp(coefficients[, "Estimate"] - 1.96 * coefficients[, "Std. Error"]) - 1,
  Upper_CI = exp(coefficients[, "Estimate"] + 1.96 * coefficients[, "Std. Error"]) - 1
)

# Combine the results into a data frame
result <- data.frame(
  Predictor = rownames(coefficients),
  Percent_Increase = percent_increase,
  Lower_CI = confidence_intervals$Lower_CI,
  Upper_CI = confidence_intervals$Upper_CI
)

print(result)

QBStats_Rounds2TO7 <- QBStats[QBStats$First_Round == 1, ]


#All Games Played Model, Excluding First Round Picks  *Negative Binomial*
gamesplayed_model_withpick_nofirst <- glm.nb(G ~ Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD + Height + Weight+ Year +log(Overall_Pick) , data = QBStats_Rounds2TO7)
##Summary indicates Year, log(Overall_Pick) with respective p-values [1.61e-08 and 2.76e-05] , close is Col_G with 0.0837 and Col_Y/A with 0.0813



##At least 16 game played model *Logistic Regression*
G16_model_withpick <- glm(G16 ~ Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD + Height + Weight+ Year +log(Overall_Pick) , family='binomial',data = QBStats)
##Summary indicates Year and Overall_Pick with p-values 0.00100 and 2.42e-09
#Also wanted to ensure family='binomial' was needed, so I ran the above model with it and without it. For with it, AICc was 219 while without was 249, indicating it is indeed needed. 

#At least 16 game played model *Logistic Regression*, EXCLUDING FIRST ROUND
G16_model_withpick_nofirst <- glm(G16 ~ Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD + Height + Weight+ Year +log(Overall_Pick) , family='binomial',data = QBStats_Rounds2TO7)
##Summary indicates Year and Overall_Pick with p-values 0.00284 and 1.73e-05




##At least 48 game played model
G48_model_withpick <- glm(G48 ~ Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD + Height + Weight+ Year +log(Overall_Pick) , family='binomial' ,data = QBStats)
##Summary indicates Year and Overall_Pick with p-values 0.00539 and 4.04e-11.  Also slightly is Col_Y/A with 0.04194

#At least 48 game played model, EXCLUDING FIRST ROUND
G48_model_withpick_nofirst <- glm(G48 ~ Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD + Height + Weight+ Year +log(Overall_Pick) , family='binomial' ,data = QBStats_Rounds2TO7)
##Summary indicates Year and Overall_Pick with p-values 0.00437 and 0.00196  






######Without Pick######
##Games Played
gamesplayed_model <- glm.nb(G ~ Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD + Height + Weight+ Year , data = QBStats)
##Summary indicates only Year is significant, with p-value 1.40e-08 

##Games Played
gamesplayed_model_nofirst <- glm.nb(G ~ Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD + Height + Weight+ Year , data = QBStats_Rounds2TO7)
##Summary indicates Col_Y/A and Year is significant, with p-values 0.0172 and 1.27e-07. 




##At least 1 game played model
G1_model <- glm(G1 ~ Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD + Height + Weight+ Year , data = QBStats)
##Summary indicates none are significant. Closest is Height with 0.0612

#At least 1 game played model,EXCLUDING FIRST ROUND
G1_model_nofirst <- glm(G1 ~ Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD + Height + Weight+ Year , data = QBStats_Rounds2TO7)
##Summary indicates none are significant. 





##At least 16 game played model
G16_model <- glm(G16 ~ Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD + Height + Weight+ Year ,family='binomial' ,data = QBStats)
##Summary indicates Year with p-value 0.00184, close is Col_TD with 0.05465

#At least 16 game played model, EXCLUDING FIRST ROUND
G16_model_nofirst <- glm(G16 ~ Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD + Height + Weight+ Year ,family='binomial' ,data = QBStats_Rounds2TO7)
##Summary indicates Year with p-value 0.00188




##At least 48 game played model
G48_model <- glm(G48 ~ Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD + Height + Weight+ Year ,family='binomial', data = QBStats)
##Summary indicates Year with p-value 0.00253 

#At least 48 game played model,EXCLUDING FIRST ROUND
G48_model_nofirst <- glm(G48 ~ Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD + Height + Weight+ Year ,family='binomial', data = QBStats_Rounds2TO7)
##Summary indicates Col_G and Year with 0.04770 and 0.00168 Close is Col_Int with 0.05622  

```


**Model Validation**


```{r}
install.packages('Metrics')
library(Metrics)  # for misclassification rate


# Set the seed for reproducibility
set.seed(7152)

# Rename the column "G" to "Games_Played"
colnames(QBStats)[colnames(QBStats) == "G"] <- "Games_Played"

# Create a list to store APE values for each run and model
APE_values <- list()

# Number of runs
num_runs <- 100

# Define a list of model formulas (as formula objects)
model_formulas <- list(
  "Model 1" = as.formula("Games_Played ~ Year"),
  "Model 2" = as.formula("Games_Played ~ Year + log(Overall_Pick)"),
  "Model 3" = as.formula("Games_Played ~ Year + Col_G + Col_Pct + `Col_Y/A` + Col_Int + Col_TD"),
  "Model 4" = as.formula("Games_Played ~ Year + Height + Weight"),
  "Model 5" = as.formula("Games_Played ~ Year + Col_G + Col_Pct + `Col_Y/A` + Col_Int + Col_TD + Height + Weight"),
  "Model 6" = as.formula("Games_Played ~ Year + log(Overall_Pick) + Col_G + Col_Pct + `Col_Y/A` + Col_Int + Col_TD"),
  "Model 7" = as.formula("Games_Played ~ Year + log(Overall_Pick) + Height + Weight"),
  "Model 8" = as.formula("Games_Played ~ Year + log(Overall_Pick) + Col_G + Col_Pct + `Col_Y/A` + Col_Int + Col_TD + Height + Weight")
)

# Perform 100 runs of 5-fold cross-validation for each model
for (model_name in names(model_formulas)) {
  APE_values[[model_name]] <- vector("list", num_runs)
  
  for (i in 1:num_runs) {
    set.seed(i)  # Change the seed for each run

    # Create a new data partition for each run
    index <- createDataPartition(QBStats$Games_Played, p = 0.8, list = FALSE, times = 1)
    train_df <- QBStats[index, ]
    test_df <- QBStats[-index, ]

    # Specify the type of training method used and the number of folds (5-fold)
    ctrl_specs <- trainControl(method = "cv", number = 5, savePredictions = TRUE, classProbs = TRUE)

    # Use tryCatch to handle errors
    tryCatch({
      # Train the negative binomial regression model
      model <- train(
        model_formulas[[model_name]], data = train_df, method = "glm.nb", trControl = ctrl_specs
      )

      # Predict outcomes on the test dataset
      predictions <- predict(model, newdata = test_df, type = "raw")

      # Calculate the Absolute Prediction Error (APE)
      APE <- mae(predictions, test_df$Games_Played)

      # Store the APE value for this run and model
      APE_values[[model_name]][[i]] <- APE

      #cat("Run", i, model_name, "APE:", APE, "\n")
    }, error = function(e) {
      cat("Error in Run", i, "Model", model_name, ":", conditionMessage(e), "\n")
      # Continue to the next run
    })
  }
}

# Calculate the mean APE for each model across all runs
mean_APE <- sapply(APE_values, function(model_APE) mean(unlist(model_APE), na.rm = TRUE))

# Print the mean APE values for each model
print(mean_APE)

#Skipped runs (due to error):
#Model 1 : 0
#Model 2 : 0
#Model 3 : 1 (Run 55)
#Model 4 : 0
#Model 5 : 1 (Run 82)
#Model 6 : 16 (Runs: 9, 11, 17, 18, 20, 22, 42, 43, 47, 53, 65, 66, 69, 71, 78, 99)
#Model 7 : 0
#Model 8 : 7 (Runs : 9, 43, 65, 78, 89, 93, 97, 99)

#Model APEs
# Model 1  | Model 2  | Model 3  | Model 4  | Model 5  | Model 6  | Model 7  | Model 8 
# 43.35623 | 34.12029 | 42.28491 | 43.43646 | 42.51130 | 33.84386 | 35.22432 | 34.04143 
#Best/lowest APE is Model 6




###16 Games
library(caret)

# Create a list to store misclassification rates for each run and model
misclassification_rates <- list()

# Number of runs
num_runs <- 100

# List of models to train (add or modify models as needed)
models <- list(
  "Year" = "Year",
  "Year + log(Overall_Pick)" = "Year + log(Overall_Pick)",
  "Year +Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD" = "Year +Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD",
  "Year + Height + Weight" = "Year + Height + Weight",
  "Year +Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD + Height + Weight" = "Year +Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD + Height + Weight",
  "Year +log(Overall_Pick) + Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD" = "Year +log(Overall_Pick) + Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD",
  "Year +log(Overall_Pick) +Height+Weight" = "Year +log(Overall_Pick) +Height+Weight",
  "Year +log(Overall_Pick) + Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD+Height+Weight" = "Year +log(Overall_Pick) + Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD+Height+Weight"
)

# For each run
for (i in 1:num_runs) {
  set.seed(i)  # Change the seed for each run

  # Create new data partitions for each run
  index <- createDataPartition(QBStats$G16, p=.8, list=FALSE, times=1)
  train_df <- QBStats[index,]
  test_df <- QBStats[-index,]

  # Re-label outcome variable
  train_df$G16[train_df$G16 == 1] <- "play"
  train_df$G16[train_df$G16 == 0] <- "nope"
  test_df$G16[test_df$G16 == 1] <- "play"
  test_df$G16[test_df$G16 == 0] <- "nope"

  train_df$G16 <- as.factor(train_df$G16)
  test_df$G16 <- as.factor(test_df$G16)

  # Specify the type of training method used and the number of folds [5]
  ctrlspecs <- trainControl(method="cv", number=5, savePredictions=TRUE, classProbs=TRUE)

  # For each model, train the model and collect misclassification rates
  model_misclassification_rates <- list()
  for (model_name in names(models)) {
    # Train the model
    model <- train(as.formula(paste("G16 ~", models[[model_name]])), data=train_df, method="glm", family=binomial, trControl=ctrlspecs)
    
    # Print the model results for each run
   # cat("Run", i, "Model:", model_name, "\n")
   # print(model)

    # Predict outcomes on the test dataset
    predictions <- predict(model, newdata=test_df, type="raw")

    # Create a confusion matrix
    confusion_matrix <- confusionMatrix(predictions, reference=test_df$G16)

    # Get the misclassification rate and store it in the list
    misclassification_rate <- 1 - confusion_matrix$overall["Accuracy"]
    model_misclassification_rates[[model_name]] <- misclassification_rate

    #cat("Misclassification Rate for Run", i, "Model:", model_name, ":", misclassification_rate, "\n")
  }

  misclassification_rates[[i]] <- model_misclassification_rates
}

# Calculate and print the average misclassification rates over all runs for each model
average_misclassification_rates <- sapply(models, function(model_name) {
  mean(sapply(misclassification_rates, function(run) run[[model_name]]))
})

cat("Average Misclassification Rates:\n")
print(average_misclassification_rates)

 #                                                                                  Year 
 #                                                                             0.3684783 
 #                                                              Year + log(Overall_Pick) *
 #                                                                             0.2389130 
 #                                   Year +Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD 
 #                                                                             0.3908696 
 #                                                                Year + Height + Weight 
 #                                                                             0.3500000 
 #                 Year +Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD + Height + Weight 
 #                                                                             0.3778261 
 #               Year +log(Overall_Pick) + Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD 
 #                                                                             0.2626087 
 #                                                Year +log(Overall_Pick) +Height+Weight 
 #                                                                             0.2534783 
 # Year +log(Overall_Pick) + Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD+Height+Weight 
 #                                                                             0.2739130

#G16_model2 <- glm(G16 ~ Year + log(Overall_Pick),family='binomial',data = QBStats)
#summary(G16_model2)
# # Extract the coefficients and their standard errors
# coef_summary <- summary(G16_model2)$coef
# 
# # Extract the coefficients for Year and log(Overall_Pick)
# coef_Year <- coef_summary["Year", "Estimate"]
# coef_logOverallPick <- coef_summary["log(Overall_Pick)", "Estimate"]
# 
# # Calculate percent change in odds for one-unit change in Year and log(Overall_Pick)
# percent_change_Year <- (exp(coef_Year) - 1) * 100
# percent_change_logOverallPick <- (exp(coef_logOverallPick) - 1) * 100
# 
# # Calculate 95% confidence intervals for the percent change
# confint_Year <- exp(confint(G16_model2)["Year", ]) * 100 - 100
# confint_logOverallPick <- exp(confint(G16_model2)["log(Overall_Pick)", ]) * 100 - 100
# 
# # Display the results
# cat("Percent change in odds for one-unit change in Year:", percent_change_Year, "%\n")
# cat("95% Confidence Intervals for Year:", confint_Year[1], "% to", confint_Year[2], "%\n")
# 
# cat("\nPercent change in odds for one-unit change in log(Overall_Pick):", percent_change_logOverallPick, "%\n")
# cat("95% Confidence Intervals for log(Overall_Pick):", confint_logOverallPick[1], "% to", confint_logOverallPick[2], "%\n")






#48 Games Played 
library(caret)

# Create a list to store misclassification rates for each run and model
misclassification_rates <- list()

# Number of runs
num_runs <- 100

# List of models to train (add or modify models as needed)
models <- list(
  "Year" = "Year",
  "Year + log(Overall_Pick)" = "Year + log(Overall_Pick)",
  "Year +Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD" = "Year +Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD",
  "Year + Height + Weight" = "Year + Height + Weight",
  "Year +Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD + Height + Weight" = "Year +Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD + Height + Weight",
  "Year +log(Overall_Pick) + Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD" = "Year +log(Overall_Pick) + Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD",
  "Year +log(Overall_Pick) +Height+Weight" = "Year +log(Overall_Pick) +Height+Weight",
  "Year +log(Overall_Pick) + Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD+Height+Weight" = "Year +log(Overall_Pick) + Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD+Height+Weight"
)

# For each run
for (i in 1:num_runs) {
  set.seed(i)  # Change the seed for each run

  # Create new data partitions for each run
  index <- createDataPartition(QBStats$G48, p=.8, list=FALSE, times=1)
  train_df <- QBStats[index,]
  test_df <- QBStats[-index,]

  # Re-label outcome variable
  train_df$G48[train_df$G48 == 1] <- "play"
  train_df$G48[train_df$G48 == 0] <- "nope"
  test_df$G48[test_df$G48 == 1] <- "play"
  test_df$G48[test_df$G48 == 0] <- "nope"

  train_df$G48 <- as.factor(train_df$G48)
  test_df$G48 <- as.factor(test_df$G48)

  # Specify the type of training method used and the number of folds [5]
  ctrlspecs <- trainControl(method="cv", number=5, savePredictions=TRUE, classProbs=TRUE)

  # For each model, train the model and collect misclassification rates
  model_misclassification_rates <- list()
  for (model_name in names(models)) {
    # Train the model
    model <- train(as.formula(paste("G48 ~", models[[model_name]])), data=train_df, method="glm", family=binomial, trControl=ctrlspecs)
    
    # Print the model results for each run
    #cat("Run", i, "Model:", model_name, "\n")
   # print(model)

    # Predict outcomes on the test dataset
    predictions <- predict(model, newdata=test_df, type="raw")

    # Create a confusion matrix
    confusion_matrix <- confusionMatrix(predictions, reference=test_df$G48)

    # Get the misclassification rate and store it in the list
    misclassification_rate <- 1 - confusion_matrix$overall["Accuracy"]
    model_misclassification_rates[[model_name]] <- misclassification_rate

    #cat("Misclassification Rate for Run", i, "Model:", model_name, ":", misclassification_rate, "\n")
  }

  misclassification_rates[[i]] <- model_misclassification_rates
}

# Calculate and print the average misclassification rates over all runs for each model
average_misclassification_rates <- sapply(models, function(model_name) {
  mean(sapply(misclassification_rates, function(run) run[[model_name]]))
})

cat("Average Misclassification Rates:\n")
print(average_misclassification_rates)

#                                                                                  Year 
#                                                                             0.3434783 
#                                                              Year + log(Overall_Pick) *
#                                                                             0.2300000 
#                                   Year +Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD 
#                                                                             0.3482609 
#                                                                Year + Height + Weight 
#                                                                             0.3523913 
#                 Year +Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD + Height + Weight 
#                                                                             0.3645652 
#               Year +log(Overall_Pick) + Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD 
#                                                                             0.2317391 
#                                                Year +log(Overall_Pick) +Height+Weight 
#                                                                             0.2341304 
# Year +log(Overall_Pick) + Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD+Height+Weight 
#                                                                             0.2347826
# Fit the logistic regression model
# G48_model2 <- glm(G48 ~ Year + log(Overall_Pick), family = 'binomial', data = QBStats)
# 
# # Extract the coefficients and their standard errors
# coef_summary <- summary(G48_model2)$coef
# 
# # Extract the coefficients for Year and log(Overall_Pick)
# coef_Year <- coef_summary["Year", "Estimate"]
# coef_logOverallPick <- coef_summary["log(Overall_Pick)", "Estimate"]
# 
# # Calculate percent change in odds for one-unit change in Year and log(Overall_Pick)
# percent_change_Year <- (exp(coef_Year) - 1) * 100
# percent_change_logOverallPick <- (exp(coef_logOverallPick) - 1) * 100
# 
# # Calculate 95% confidence intervals for the percent change
# confint_Year <- exp(confint(G48_model2)["Year", ]) * 100 - 100
# confint_logOverallPick <- exp(confint(G48_model2)["log(Overall_Pick)", ]) * 100 - 100
# 
# # Display the results
# cat("Percent change in odds for one-unit change in Year:", percent_change_Year, "%\n")
# cat("95% Confidence Intervals for Year:", confint_Year[1], "% to", confint_Year[2], "%\n")
# 
# cat("\nPercent change in odds for one-unit change in log(Overall_Pick):", percent_change_logOverallPick, "%\n")
# cat("95% Confidence Intervals for log(Overall_Pick):", confint_logOverallPick[1], "% to", confint_logOverallPick[2], "%\n")





#Net Points
library(Metrics)  # For Absolute Prediction Error
library(pscl)     # For zero-inflated negative binomial regression

# Set the seed for reproducibility
set.seed(7152)

# Create a list to store APE values for each run and model
APE_values <- list()

# Number of runs
num_runs <- 100

# Define a list of model formulas (as formula objects)
model_formulas <- list(
  "Model 1" = as.formula("Net_Points ~ Year"),
  "Model 2" = as.formula("Net_Points ~ Year + log(Overall_Pick)"),
  "Model 3" = as.formula("Net_Points ~ Year + Col_G + Col_Pct + `Col_Y/A` + Col_Int + Col_TD"),
  "Model 4" = as.formula("Net_Points ~ Year + Height + Weight"),
  "Model 5" = as.formula("Net_Points ~ Year + Col_G + Col_Pct + `Col_Y/A` + Col_Int + Col_TD + Height + Weight"),
  "Model 6" = as.formula("Net_Points ~ Year + log(Overall_Pick) + Col_G + Col_Pct + `Col_Y/A` + Col_Int + Col_TD"),
  "Model 7" = as.formula("Net_Points ~ Year + log(Overall_Pick) + Height + Weight"),
  "Model 8" = as.formula("Net_Points ~ Year + log(Overall_Pick) + Col_G + Col_Pct + `Col_Y/A` + Col_Int + Col_TD + Height + Weight")
)

# Perform 100 runs of 5-fold cross-validation for each model
for (model_name in names(model_formulas)) {
  APE_values[[model_name]] <- vector("list", num_runs)
  
  for (i in 1:num_runs) {
    set.seed(i)  # Change the seed for each run

    # Create a new data partition for each run
    index <- createDataPartition(QBStats$Net_Points, p = 0.8, list = FALSE, times = 1)
    train_df <- QBStats[index, ]
    test_df <- QBStats[-index, ]

    # Initialize a variable to store APE values for this run
    APE_values_run <- vector("list", 5)

    # Create 5-fold cross-validation partitions
    folds <- createFolds(train_df$Net_Points, k = 5)

    for (fold in 1:5) {
      # Extract the training and validation sets for this fold
      train_fold <- train_df[-folds[[fold]], ]
      validation_fold <- train_df[folds[[fold]], ]

      # Fit the zero-inflated negative binomial regression model
      zeroinfl_model <- zeroinfl(model_formulas[[model_name]], data = train_fold, dist = "negbin")

      # Predict outcomes on the validation dataset
      predictions <- predict(zeroinfl_model, newdata = validation_fold, type = "response")

      # Calculate the Absolute Prediction Error (APE) for this fold
      APE <- mae(predictions, validation_fold$Net_Points)
      APE_values_run[fold] <- APE
    }

    # Store the mean APE value for this run and model
    APE_values[[model_name]][[i]] <- mean(unlist(APE_values_run))

    #cat("Run", i, model_name, "APE:", mean(unlist(APE_values_run)), "\n")
  }
}

# Calculate the mean APE for each model across all runs
mean_APE <- sapply(APE_values, function(model_APE) mean(unlist(model_APE)))

# Print the mean APE values for each model
print(mean_APE)

# Model 1  Model 2  Model 3  Model 4  Model 5  Model 6  Model 7  Model 8 
# 420.2694 331.5789 402.7904 419.6413 403.8961 331.8412 354.0803 350.6996 
# Model 2
```

##The Study's Sensitivity Analysis(exclude first round qbs)##


```{r}
QBStats_Rounds2TO7 <- QBStats %>%
  filter(First_Round == 1)



# Set the seed for reproducibility
set.seed(7152)

# Rename the column "G" to "Games_Played"
colnames(QBStats_Rounds2TO7)[colnames(QBStats_Rounds2TO7) == "G"] <- "Games_Played"

# Create a list to store APE values for each run and model
APE_values <- list()

# Number of runs
num_runs <- 100

# Define a list of model formulas (as formula objects)
model_formulas <- list(
  "Model 1" = as.formula("Games_Played ~ Year"),
  "Model 2" = as.formula("Games_Played ~ Year + log(Overall_Pick)"),
  "Model 3" = as.formula("Games_Played ~ Year + Col_G + Col_Pct + `Col_Y/A` + Col_Int + Col_TD"),
  "Model 4" = as.formula("Games_Played ~ Year + Height + Weight"),
  "Model 5" = as.formula("Games_Played ~ Year + Col_G + Col_Pct + `Col_Y/A` + Col_Int + Col_TD + Height + Weight"),
  "Model 6" = as.formula("Games_Played ~ Year + log(Overall_Pick) + Col_G + Col_Pct + `Col_Y/A` + Col_Int + Col_TD"),
  "Model 7" = as.formula("Games_Played ~ Year + log(Overall_Pick) + Height + Weight"),
  "Model 8" = as.formula("Games_Played ~ Year + log(Overall_Pick) + Col_G + Col_Pct + `Col_Y/A` + Col_Int + Col_TD + Height + Weight")
)

# Perform 100 runs of 5-fold cross-validation for each model
for (model_name in names(model_formulas)) {
  APE_values[[model_name]] <- vector("list", num_runs)
  
  for (i in 1:num_runs) {
    set.seed(i)  # Change the seed for each run

    # Create a new data partition for each run
    index <- createDataPartition(QBStats_Rounds2TO7$Games_Played, p = 0.8, list = FALSE, times = 1)
    train_df <- QBStats_Rounds2TO7[index, ]
    test_df <- QBStats_Rounds2TO7[-index, ]

    # Specify the type of training method used and the number of folds (5-fold)
    ctrl_specs <- trainControl(method = "cv", number = 5, savePredictions = TRUE, classProbs = TRUE)

    # Use tryCatch to handle errors
    tryCatch({
      # Train the negative binomial regression model
      model <- train(
        model_formulas[[model_name]], data = train_df, method = "glm.nb", trControl = ctrl_specs
      )

      # Predict outcomes on the test dataset
      predictions <- predict(model, newdata = test_df, type = "raw")

      # Calculate the Absolute Prediction Error (APE)
      APE <- mae(predictions, test_df$Games_Played)

      # Store the APE value for this run and model
      APE_values[[model_name]][[i]] <- APE

     # cat("Run", i, model_name, "APE:", APE, "\n")
    }, error = function(e) {
      cat("Error in Run", i, "Model", model_name, ":", conditionMessage(e), "\n")
      # Continue to the next run
    })
  }
}

# Calculate the mean APE for each model across all runs
mean_APE <- sapply(APE_values, function(model_APE) mean(unlist(model_APE), na.rm = TRUE))

# Print the mean APE values for each model
print(mean_APE)

#Skipped runs (due to error):
#Model 1 : 0
#Model 2 : 18 (Runs: 2, 4, 7, 10, 11, 13, 23, 24, 28, 33, 43, 47, 50, 55, 72, 76, 79, 82)
#Model 3 : 45 (Runs: 3, 4, 5, 6. 7, 8, 11, 12, 14, 16, 17, 18, 23, 25, 27, 28, 29, 31, 35, 36, 42, 43, 44, 45, 47, 
#51, 53, 57, 59, 61, 65, 68, 71, 72, 74, 77, 78, 81, 85, 86, 94, 95, 96, 97, 100)
#Model 4 : 0
#Model 5 : 39 (Runs: 4, 5, 8, 9, 11, 12, 14, 17, 18, 21, 23, 24, 28, 31, 35, 36, 42, 47, 50, 51, 53, 57, 61, 65, 
# 68, 71, 72, 74, 75, 77, 78, 79, 82, 85, 86, 94, 96, 97, 100)
#Model 6 : 13 (Runs: 2, 15, 23, 34, 35, 49, 57, 62, 74, 79, 81, 89, 95)
#Model 7 : 19 (Runs: 2, 3, 4, 7, 9, 10, 13, 19, 20, 33, 36, 38, 43, 48, 50, 52, 60, 61, 69, 76, 77, 82, 83, 88, 
# 92, 93, 99)
#Model 8 : 9 (Runs : 15, 19, 30, 35, 50, 61, 62, 70, 97)

#Model APEs
# Model 1  Model 2  Model 3  Model 4  Model 5  Model 6  Model 7  Model 8 
# 31.39003 28.89530 32.04708 31.35297 32.81109 28.37618 29.37415 28.85620 
#Best/lowest APE is Model 6 **Above it is model 6**




###16 Games
library(caret)

# Create a list to store misclassification rates for each run and model
misclassification_rates <- list()

# Number of runs
num_runs <- 100

# List of models to train (add or modify models as needed)
models <- list(
  "Year" = "Year",
  "Year + log(Overall_Pick)" = "Year + log(Overall_Pick)",
  "Year +Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD" = "Year +Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD",
  "Year + Height + Weight" = "Year + Height + Weight",
  "Year +Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD + Height + Weight" = "Year +Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD + Height + Weight",
  "Year +log(Overall_Pick) + Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD" = "Year +log(Overall_Pick) + Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD",
  "Year +log(Overall_Pick) +Height+Weight" = "Year +log(Overall_Pick) +Height+Weight",
  "Year +log(Overall_Pick) + Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD+Height+Weight" = "Year +log(Overall_Pick) + Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD+Height+Weight"
)

# For each run
for (i in 1:num_runs) {
  set.seed(i)  # Change the seed for each run

  # Create new data partitions for each run
  index <- createDataPartition(QBStats_Rounds2TO7$G16, p=.8, list=FALSE, times=1)
  train_df <- QBStats_Rounds2TO7[index,]
  test_df <- QBStats_Rounds2TO7[-index,]

  # Re-label outcome variable
  train_df$G16[train_df$G16 == 1] <- "play"
  train_df$G16[train_df$G16 == 0] <- "nope"
  test_df$G16[test_df$G16 == 1] <- "play"
  test_df$G16[test_df$G16 == 0] <- "nope"

  train_df$G16 <- as.factor(train_df$G16)
  test_df$G16 <- as.factor(test_df$G16)

  # Specify the type of training method used and the number of folds [5]
  ctrlspecs <- trainControl(method="cv", number=5, savePredictions=TRUE, classProbs=TRUE)

  # For each model, train the model and collect misclassification rates
  model_misclassification_rates <- list()
  for (model_name in names(models)) {
    # Train the model
    model <- train(as.formula(paste("G16 ~", models[[model_name]])), data=train_df, method="glm", family=binomial, trControl=ctrlspecs)
    
    # Print the model results for each run
   # cat("Run", i, "Model:", model_name, "\n")
   # print(model)

    # Predict outcomes on the test dataset
    predictions <- predict(model, newdata=test_df, type="raw")

    # Create a confusion matrix
    confusion_matrix <- confusionMatrix(predictions, reference=test_df$G16)

    # Get the misclassification rate and store it in the list
    misclassification_rate <- 1 - confusion_matrix$overall["Accuracy"]
    model_misclassification_rates[[model_name]] <- misclassification_rate

    #cat("Misclassification Rate for Run", i, "Model:", model_name, ":", misclassification_rate, "\n")
  }

  misclassification_rates[[i]] <- model_misclassification_rates
}

# Calculate and print the average misclassification rates over all runs for each model
average_misclassification_rates <- sapply(models, function(model_name) {
  mean(sapply(misclassification_rates, function(run) run[[model_name]]))
})

cat("Average Misclassification Rates:\n")
print(average_misclassification_rates)

#                                                                                 Year 
#                                                                             0.4377419 
#                                                              Year + log(Overall_Pick) * **SAME AS ABOVE**
#                                                                             0.3112903 
#                                   Year +Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD 
#                                                                             0.3996774 
#                                                                Year + Height + Weight 
#                                                                             0.4409677 
#                 Year +Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD + Height + Weight 
#                                                                             0.4087097 
#               Year +log(Overall_Pick) + Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD 
#                                                                             0.3325806 
#                                                Year +log(Overall_Pick) +Height+Weight 
#                                                                             0.3187097 
# Year +log(Overall_Pick) + Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD+Height+Weight 
#                                                                             0.3441935






#48 Games Played 
library(caret)

# Create a list to store misclassification rates for each run and model
misclassification_rates <- list()

# Number of runs
num_runs <- 100

# List of models to train (add or modify models as needed)
models <- list(
  "Year" = "Year",
  "Year + log(Overall_Pick)" = "Year + log(Overall_Pick)",
  "Year +Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD" = "Year +Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD",
  "Year + Height + Weight" = "Year + Height + Weight",
  "Year +Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD + Height + Weight" = "Year +Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD + Height + Weight",
  "Year +log(Overall_Pick) + Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD" = "Year +log(Overall_Pick) + Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD",
  "Year +log(Overall_Pick) +Height+Weight" = "Year +log(Overall_Pick) +Height+Weight",
  "Year +log(Overall_Pick) + Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD+Height+Weight" = "Year +log(Overall_Pick) + Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD+Height+Weight"
)

# For each run
for (i in 1:num_runs) {
  set.seed(i)  # Change the seed for each run

  # Create new data partitions for each run
  index <- createDataPartition(QBStats_Rounds2TO7$G48, p=.8, list=FALSE, times=1)
  train_df <- QBStats_Rounds2TO7[index,]
  test_df <- QBStats_Rounds2TO7[-index,]

  # Re-label outcome variable
  train_df$G48[train_df$G48 == 1] <- "play"
  train_df$G48[train_df$G48 == 0] <- "nope"
  test_df$G48[test_df$G48 == 1] <- "play"
  test_df$G48[test_df$G48 == 0] <- "nope"

  train_df$G48 <- as.factor(train_df$G48)
  test_df$G48 <- as.factor(test_df$G48)

  # Specify the type of training method used and the number of folds [5]
  ctrlspecs <- trainControl(method="cv", number=5, savePredictions=TRUE, classProbs=TRUE)

  # For each model, train the model and collect misclassification rates
  model_misclassification_rates <- list()
  for (model_name in names(models)) {
    # Train the model
    model <- train(as.formula(paste("G48 ~", models[[model_name]])), data=train_df, method="glm", family=binomial, trControl=ctrlspecs)
    
    # Print the model results for each run
    #cat("Run", i, "Model:", model_name, "\n")
    #print(model)

    # Predict outcomes on the test dataset
    predictions <- predict(model, newdata=test_df, type="raw")

    # Create a confusion matrix
    confusion_matrix <- confusionMatrix(predictions, reference=test_df$G48)

    # Get the misclassification rate and store it in the list
    misclassification_rate <- 1 - confusion_matrix$overall["Accuracy"]
    model_misclassification_rates[[model_name]] <- misclassification_rate

   # cat("Misclassification Rate for Run", i, "Model:", model_name, ":", misclassification_rate, "\n")
  }

  misclassification_rates[[i]] <- model_misclassification_rates
}

# Calculate and print the average misclassification rates over all runs for each model
average_misclassification_rates <- sapply(models, function(model_name) {
  mean(sapply(misclassification_rates, function(run) run[[model_name]]))
})

cat("Average Misclassification Rates:\n")
print(average_misclassification_rates)

#                                                                                 Year * **ABOVE IS year+pick**
#                                                                             0.1977419 
#                                                              Year + log(Overall_Pick) 
#                                                                             0.2125806 
#                                   Year +Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD 
#                                                                             0.2177419 
#                                                                Year + Height + Weight 
#                                                                             0.2003226 
#                 Year +Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD + Height + Weight 
#                                                                             0.2203226 
#               Year +log(Overall_Pick) + Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD 
#                                                                             0.2009677 
#                                                Year +log(Overall_Pick) +Height+Weight 
#                                                                             0.2132258 
# Year +log(Overall_Pick) + Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD+Height+Weight 
#                                                                             0.2096774 





#Net Points
library(Metrics)  # For Absolute Prediction Error
library(pscl)     # For zero-inflated negative binomial regression

# Set the seed for reproducibility
set.seed(7152)

# Create a list to store APE values for each run and model
APE_values <- list()

# Number of runs
num_runs <- 100

# Define a list of model formulas (as formula objects)
model_formulas <- list(
  "Model 1" = as.formula("Net_Points ~ Year"),
  "Model 2" = as.formula("Net_Points ~ Year + log(Overall_Pick)"),
  "Model 3" = as.formula("Net_Points ~ Year + Col_G + Col_Pct + `Col_Y/A` + Col_Int + Col_TD"),
  "Model 4" = as.formula("Net_Points ~ Year + Height + Weight"),
  "Model 5" = as.formula("Net_Points ~ Year + Col_G + Col_Pct + `Col_Y/A` + Col_Int + Col_TD + Height + Weight"),
  "Model 6" = as.formula("Net_Points ~ Year + log(Overall_Pick) + Col_G + Col_Pct + `Col_Y/A` + Col_Int + Col_TD"),
  "Model 7" = as.formula("Net_Points ~ Year + log(Overall_Pick) + Height + Weight"),
  "Model 8" = as.formula("Net_Points ~ Year + log(Overall_Pick) + Col_G + Col_Pct + `Col_Y/A` + Col_Int + Col_TD + Height + Weight")
)

# Perform 100 runs of 5-fold cross-validation for each model
for (model_name in names(model_formulas)) {
  APE_values[[model_name]] <- vector("list", num_runs)
  
  for (i in 1:num_runs) {
    set.seed(i)  # Change the seed for each run

    # Create a new data partition for each run
    index <- createDataPartition(QBStats_Rounds2TO7$Net_Points, p = 0.8, list = FALSE, times = 1)
    train_df <- QBStats_Rounds2TO7[index, ]
    test_df <- QBStats_Rounds2TO7[-index, ]

    # Initialize a variable to store APE values for this run
    APE_values_run <- vector("list", 5)

    # Create 5-fold cross-validation partitions
    folds <- createFolds(train_df$Net_Points, k = 5)

    for (fold in 1:5) {
      # Extract the training and validation sets for this fold
      train_fold <- train_df[-folds[[fold]], ]
      validation_fold <- train_df[folds[[fold]], ]

      # Fit the zero-inflated negative binomial regression model
      zeroinfl_model <- zeroinfl(model_formulas[[model_name]], data = train_fold, dist = "negbin")

      # Predict outcomes on the validation dataset
      predictions <- predict(zeroinfl_model, newdata = validation_fold, type = "response")

      # Calculate the Absolute Prediction Error (APE) for this fold
      APE <- mae(predictions, validation_fold$Net_Points)
      APE_values_run[fold] <- APE
    }

    # Store the mean APE value for this run and model
    APE_values[[model_name]][[i]] <- mean(unlist(APE_values_run))

    #cat("Run", i, model_name, "APE:", mean(unlist(APE_values_run)), "\n")
  }
}

# Calculate the mean APE for each model across all runs
mean_APE <- sapply(APE_values, function(model_APE) mean(unlist(model_APE)))

# Print the mean APE values for each model
print(mean_APE)

# Model 1  Model 2  Model 3  Model 4  Model 5  Model 6  Model 7  Model 8 
# 265.8902 242.6085 259.4993 277.0320 265.0736 245.3283 255.3039 253.7207 
 #Model 2 * **SAME AS ABOVE**
```

##My Sensitivity Analysis (Drafted Years 1998 - 2022) ##

```{r}
QBStats_Years1998ON <- QBStats %>%
  filter(Year >=1998)



# Set the seed for reproducibility
set.seed(7152)


# Create a list to store APE values for each run and model
APE_values <- list()

# Number of runs
num_runs <- 100

# Define a list of model formulas (as formula objects)
model_formulas <- list(
  "Model 1" = as.formula("Games_Played ~ Year"),
  "Model 2" = as.formula("Games_Played ~ Year + log(Overall_Pick)"),
  "Model 3" = as.formula("Games_Played ~ Year + Col_G + Col_Pct + `Col_Y/A` + Col_Int + Col_TD"),
  "Model 4" = as.formula("Games_Played ~ Year + Height + Weight"),
  "Model 5" = as.formula("Games_Played ~ Year + Col_G + Col_Pct + `Col_Y/A` + Col_Int + Col_TD + Height + Weight"),
  "Model 6" = as.formula("Games_Played ~ Year + log(Overall_Pick) + Col_G + Col_Pct + `Col_Y/A` + Col_Int + Col_TD"),
  "Model 7" = as.formula("Games_Played ~ Year + log(Overall_Pick) + Height + Weight"),
  "Model 8" = as.formula("Games_Played ~ Year + log(Overall_Pick) + Col_G + Col_Pct + `Col_Y/A` + Col_Int + Col_TD + Height + Weight")
)

# Perform 100 runs of 5-fold cross-validation for each model
for (model_name in names(model_formulas)) {
  APE_values[[model_name]] <- vector("list", num_runs)
  
  for (i in 1:num_runs) {
    set.seed(i)  # Change the seed for each run

    # Create a new data partition for each run
    index <- createDataPartition(QBStats_Years1998ON$Games_Played, p = 0.8, list = FALSE, times = 1)
    train_df <- QBStats_Years1998ON[index, ]
    test_df <- QBStats_Years1998ON[-index, ]

    # Specify the type of training method used and the number of folds (5-fold)
    ctrl_specs <- trainControl(method = "cv", number = 5, savePredictions = TRUE, classProbs = TRUE)

    # Use tryCatch to handle errors
    tryCatch({
      # Train the negative binomial regression model
      model <- train(
        model_formulas[[model_name]], data = train_df, method = "glm.nb", trControl = ctrl_specs
      )

      # Predict outcomes on the test dataset
      predictions <- predict(model, newdata = test_df, type = "raw")

      # Calculate the Absolute Prediction Error (APE)
      APE <- mae(predictions, test_df$Games_Played)

      # Store the APE value for this run and model
      APE_values[[model_name]][[i]] <- APE

      #cat("Run", i, model_name, "APE:", APE, "\n")
    }, error = function(e) {
      cat("Error in Run", i, "Model", model_name, ":", conditionMessage(e), "\n")
      # Continue to the next run
    })
  }
}

# Calculate the mean APE for each model across all runs
mean_APE <- sapply(APE_values, function(model_APE) mean(unlist(model_APE), na.rm = TRUE))

# Print the mean APE values for each model
print(mean_APE)


#Model APEs
# Model 1  Model 2  Model 3  Model 4  Model 5  Model 6  Model 7  Model 8 
# 42.61787 33.19983 41.48904 42.46663 41.62361 33.06917 34.34810 33.20460 
#Best/lowest APE is Model 6 **Above it is model 6**





###16 Games
library(caret)

# Create a list to store misclassification rates for each run and model
misclassification_rates <- list()

# Number of runs
num_runs <- 100

# List of models to train (add or modify models as needed)
models <- list(
  "Year" = "Year",
  "Year + log(Overall_Pick)" = "Year + log(Overall_Pick)",
  "Year +Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD" = "Year +Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD",
  "Year + Height + Weight" = "Year + Height + Weight",
  "Year +Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD + Height + Weight" = "Year +Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD + Height + Weight",
  "Year +log(Overall_Pick) + Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD" = "Year +log(Overall_Pick) + Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD",
  "Year +log(Overall_Pick) +Height+Weight" = "Year +log(Overall_Pick) +Height+Weight",
  "Year +log(Overall_Pick) + Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD+Height+Weight" = "Year +log(Overall_Pick) + Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD+Height+Weight"
)

# For each run
for (i in 1:num_runs) {
  set.seed(i)  # Change the seed for each run

  # Create new data partitions for each run
  index <- createDataPartition(QBStats_Years1998ON$G16, p=.8, list=FALSE, times=1)
  train_df <- QBStats_Years1998ON[index,]
  test_df <- QBStats_Years1998ON[-index,]

  # Re-label outcome variable
  train_df$G16[train_df$G16 == 1] <- "play"
  train_df$G16[train_df$G16 == 0] <- "nope"
  test_df$G16[test_df$G16 == 1] <- "play"
  test_df$G16[test_df$G16 == 0] <- "nope"

  train_df$G16 <- as.factor(train_df$G16)
  test_df$G16 <- as.factor(test_df$G16)

  # Specify the type of training method used and the number of folds [5]
  ctrlspecs <- trainControl(method="cv", number=5, savePredictions=TRUE, classProbs=TRUE)

  # For each model, train the model and collect misclassification rates
  model_misclassification_rates <- list()
  for (model_name in names(models)) {
    # Train the model
    model <- train(as.formula(paste("G16 ~", models[[model_name]])), data=train_df, method="glm", family=binomial, trControl=ctrlspecs)
    
    # Print the model results for each run
   # cat("Run", i, "Model:", model_name, "\n")
    #print(model)

    # Predict outcomes on the test dataset
    predictions <- predict(model, newdata=test_df, type="raw")

    # Create a confusion matrix
    confusion_matrix <- confusionMatrix(predictions, reference=test_df$G16)

    # Get the misclassification rate and store it in the list
    misclassification_rate <- 1 - confusion_matrix$overall["Accuracy"]
    model_misclassification_rates[[model_name]] <- misclassification_rate

   # cat("Misclassification Rate for Run", i, "Model:", model_name, ":", misclassification_rate, "\n")
  }

  misclassification_rates[[i]] <- model_misclassification_rates
}

# Calculate and print the average misclassification rates over all runs for each model
average_misclassification_rates <- sapply(models, function(model_name) {
  mean(sapply(misclassification_rates, function(run) run[[model_name]]))
})

cat("Average Misclassification Rates:\n")
print(average_misclassification_rates)

#                                                                                 Year 
#                                                                             0.3633333 
#                                                              Year + log(Overall_Pick) **Original select.*
#                                                                             0.2295556 
#                                   Year +Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD 
#                                                                             0.3933333 
#                                                                Year + Height + Weight 
#                                                                             0.3295556 
#                 Year +Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD + Height + Weight 
#                                                                             0.3708889 
#               Year +log(Overall_Pick) + Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD * 
#                                                                             0.2351111 
#                                                Year +log(Overall_Pick) +Height+Weight 
#                                                                             0.2417778 
# Year +log(Overall_Pick) + Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD+Height+Weight 
#                                                                             0.2540000 





#48 Games Played 
library(caret)

# Create a list to store misclassification rates for each run and model
misclassification_rates <- list()

# Number of runs
num_runs <- 100

# List of models to train (add or modify models as needed)
models <- list(
  "Year" = "Year",
  "Year + log(Overall_Pick)" = "Year + log(Overall_Pick)",
  "Year +Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD" = "Year +Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD",
  "Year + Height + Weight" = "Year + Height + Weight",
  "Year +Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD + Height + Weight" = "Year +Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD + Height + Weight",
  "Year +log(Overall_Pick) + Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD" = "Year +log(Overall_Pick) + Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD",
  "Year +log(Overall_Pick) +Height+Weight" = "Year +log(Overall_Pick) +Height+Weight",
  "Year +log(Overall_Pick) + Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD+Height+Weight" = "Year +log(Overall_Pick) + Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD+Height+Weight"
)

# For each run
for (i in 1:num_runs) {
  set.seed(i)  # Change the seed for each run

  # Create new data partitions for each run
  index <- createDataPartition(QBStats_Years1998ON$G48, p=.8, list=FALSE, times=1)
  train_df <- QBStats_Years1998ON[index,]
  test_df <- QBStats_Years1998ON[-index,]

  # Re-label outcome variable
  train_df$G48[train_df$G48 == 1] <- "play"
  train_df$G48[train_df$G48 == 0] <- "nope"
  test_df$G48[test_df$G48 == 1] <- "play"
  test_df$G48[test_df$G48 == 0] <- "nope"

  train_df$G48 <- as.factor(train_df$G48)
  test_df$G48 <- as.factor(test_df$G48)

  # Specify the type of training method used and the number of folds [5]
  ctrlspecs <- trainControl(method="cv", number=5, savePredictions=TRUE, classProbs=TRUE)

  # For each model, train the model and collect misclassification rates
  model_misclassification_rates <- list()
  for (model_name in names(models)) {
    # Train the model
    model <- train(as.formula(paste("G48 ~", models[[model_name]])), data=train_df, method="glm", family=binomial, trControl=ctrlspecs)
    
    # Print the model results for each run
    #cat("Run", i, "Model:", model_name, "\n")
    #print(model)

    # Predict outcomes on the test dataset
    predictions <- predict(model, newdata=test_df, type="raw")

    # Create a confusion matrix
    confusion_matrix <- confusionMatrix(predictions, reference=test_df$G48)

    # Get the misclassification rate and store it in the list
    misclassification_rate <- 1 - confusion_matrix$overall["Accuracy"]
    model_misclassification_rates[[model_name]] <- misclassification_rate

   #cat("Misclassification Rate for Run", i, "Model:", model_name, ":", misclassification_rate, "\n")
  }

  misclassification_rates[[i]] <- model_misclassification_rates
}

# Calculate and print the average misclassification rates over all runs for each model
average_misclassification_rates <- sapply(models, function(model_name) {
  mean(sapply(misclassification_rates, function(run) run[[model_name]]))
})

cat("Average Misclassification Rates:\n")
print(average_misclassification_rates)

#                                                                                 Year 
#                                                                             0.3431111 
#                                                              Year + log(Overall_Pick) * **Same as Original**
#                                                                             0.2311111 
#                                   Year +Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD 
#                                                                             0.3531111 
#                                                                Year + Height + Weight 
#                                                                             0.3448889 
#                 Year +Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD + Height + Weight 
#                                                                             0.3617778 
#               Year +log(Overall_Pick) + Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD 
#                                                                             0.2328889 
#                                                Year +log(Overall_Pick) +Height+Weight 
#                                                                             0.2380000 
# Year +log(Overall_Pick) + Col_G + Col_Pct + `Col_Y/A` + Col_Int +Col_TD+Height+Weight 
#                                                                             0.2377778 





#Net Points
library(Metrics)  # For Absolute Prediction Error
library(pscl)     # For zero-inflated negative binomial regression

# Set the seed for reproducibility
set.seed(7152)

# Create a list to store APE values for each run and model
APE_values <- list()

# Number of runs
num_runs <- 100

# Define a list of model formulas (as formula objects)
model_formulas <- list(
  "Model 1" = as.formula("Net_Points ~ Year"),
  "Model 2" = as.formula("Net_Points ~ Year + log(Overall_Pick)"),
  "Model 3" = as.formula("Net_Points ~ Year + Col_G + Col_Pct + `Col_Y/A` + Col_Int + Col_TD"),
  "Model 4" = as.formula("Net_Points ~ Year + Height + Weight"),
  "Model 5" = as.formula("Net_Points ~ Year + Col_G + Col_Pct + `Col_Y/A` + Col_Int + Col_TD + Height + Weight"),
  "Model 6" = as.formula("Net_Points ~ Year + log(Overall_Pick) + Col_G + Col_Pct + `Col_Y/A` + Col_Int + Col_TD"),
  "Model 7" = as.formula("Net_Points ~ Year + log(Overall_Pick) + Height + Weight"),
  "Model 8" = as.formula("Net_Points ~ Year + log(Overall_Pick) + Col_G + Col_Pct + `Col_Y/A` + Col_Int + Col_TD + Height + Weight")
)

# Perform 100 runs of 5-fold cross-validation for each model
for (model_name in names(model_formulas)) {
  APE_values[[model_name]] <- vector("list", num_runs)
  
  for (i in 1:num_runs) {
    set.seed(i)  # Change the seed for each run

    # Create a new data partition for each run
    index <- createDataPartition(QBStats_Years1998ON$Net_Points, p = 0.8, list = FALSE, times = 1)
    train_df <- QBStats_Years1998ON[index, ]
    test_df <- QBStats_Years1998ON[-index, ]

    # Initialize a variable to store APE values for this run
    APE_values_run <- vector("list", 5)

    # Create 5-fold cross-validation partitions
    folds <- createFolds(train_df$Net_Points, k = 5)

    for (fold in 1:5) {
      # Extract the training and validation sets for this fold
      train_fold <- train_df[-folds[[fold]], ]
      validation_fold <- train_df[folds[[fold]], ]

      # Fit the zero-inflated negative binomial regression model
      zeroinfl_model <- zeroinfl(model_formulas[[model_name]], data = train_fold, dist = "negbin")

      # Predict outcomes on the validation dataset
      predictions <- predict(zeroinfl_model, newdata = validation_fold, type = "response")

      # Calculate the Absolute Prediction Error (APE) for this fold
      APE <- mae(predictions, validation_fold$Net_Points)
      APE_values_run[fold] <- APE
    }

    # Store the mean APE value for this run and model
    APE_values[[model_name]][[i]] <- mean(unlist(APE_values_run))

    #cat("Run", i, model_name, "APE:", mean(unlist(APE_values_run)), "\n")
  }
}

# Calculate the mean APE for each model across all runs
mean_APE <- sapply(APE_values, function(model_APE) mean(unlist(model_APE)))

# Print the mean APE values for each model
print(mean_APE)

# Model 1  Model 2  Model 3  Model 4  Model 5  Model 6  Model 7  Model 8 
# 417.7253 330.9747 405.3301 417.5621 406.7151 335.4317 353.7269 351.8783 
# Model 2 **Same as Original** 
```

